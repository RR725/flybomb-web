webpackJsonp([2],{821:function(e,a,t){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},r=t(600),o=l(r),s=t(783),i=t(776),c=l(i),m=t(785),d=l(m),u=s.Form.Item,p={labelCol:{span:5},wrapperCol:{span:19}},f=o.default.createClass({displayName:"App",getInitialState:function(){return{loading:!1}},componentWillUnmount:function(){document.querySelector("#home").className=""},componentDidMount:function(){document.querySelector("#home").className="active"},cantNull:function(e){var a=this.props.form.getFieldProps;return a(e,{validate:[{rules:[{required:!0,message:"请填写应用名称"},{min:2,message:"应用名称不能少于2个字"},{max:10,message:"应用名称不能超过10个字"},{validator:function(e,a,t){a&&a.length>=2&&a.length<=10&&a.match(/^\s/)&&t(new Error("行首不能输入空格")),t()}}],trigger:["onBlur","onChange"]}]})},handleSubmit:function(){this.props.form.validateFields(function(e,a){if(e)return void console.log("Errors in form!!!");var t={appName:a.appName.trim(),packageName:a.packageName.trim(),appIconUrl:a.appIconUrl};d.default.post(c.default.addApp,t,function(){s.message.success("新建成功"),window.location.hash="/home?refresh=true"})})},validatePackageName:function(e){var a=this.props.form.getFieldProps;return a(e,{validate:[{rules:[{required:!0,message:"请填写包名"},{max:100,message:"包名不能超过100个字"},{validator:function(e,a,t){console.log(a),a=a&&a.trim(),a&&""===a||a&&!a.match(/^[a-zA-Z][\w_]*(\.[a-zA-Z][\w_]*)+$/)?t(new Error("请输入包名的正确格式，比如：com.flyme.sms")):t()}}],trigger:["onBlur","onChange"]}]})},render:function(){var e=this.props.form.getFieldProps,a=this,t={name:"iconFile",accept:".jpg,.jpeg,.png,.bmp",action:c.default.uploadIcon,headers:{authorization:"authorization-text"},showUploadList:!1,beforeUpload:function(e){a.setState({loading:!0});var t=e.type,l=t.indexOf("image")>=0;return l||(s.message.error("请上传图片格式的文件"),a.setState({loading:!1})),l},onChange:function(e){"uploading"!==e.file.status&&console.log(e.file,e.fileList),e.file.response&&("200"===e.file.response.code?(s.message.success(e.file.name+" 上传成功。"),a.props.form.setFieldsValue({appIconUrl:e.file.response.value})):s.message.error(e.file.response.message),a.setState({loading:!1}))}},l="可以包含大写字母(A到Z)、小写字母(a到z)、数字和下划线，可以用点(英文句号)分隔，隔开的每一段都必须以字母开头。",r=o.default.createElement("span",null,o.default.createElement(s.Tooltip,{title:l},o.default.createElement("i",{className:"fs14 color999 fw_n cursor_p anticon anticon-info-circle-o"})),"应用包名");return o.default.createElement("div",null,o.default.createElement("div",{className:"home_toolbar"},o.default.createElement(s.Row,null,o.default.createElement(s.Col,{span:"4"},o.default.createElement("div",{className:"title"},o.default.createElement("span",{className:"border"}),"新建应用")))),o.default.createElement(s.Form,{style:{paddingTop:20},horizontal:!0},o.default.createElement(s.Row,{className:"add_app"},o.default.createElement(s.Col,{span:"18"},o.default.createElement(u,n({},p,{label:"应用名称"}),o.default.createElement(s.Input,n({style:{width:300},placeholder:"2-10个字符"},this.cantNull("appName")))),o.default.createElement(u,n({},p,{label:r}),o.default.createElement(s.Input,n({style:{width:300},disabled:this.state.disabled},this.validatePackageName("packageName")))),o.default.createElement(u,n({},p,{label:"应用图标"}),o.default.createElement(u,{className:"add_app_icon"},o.default.createElement(s.Upload,n({},e("appIconUrl",{validate:[{rules:[{required:!0,message:"请上传应用图标"}]}]}),{style:{width:200}},t),this.props.form.getFieldValue("appIconUrl")?o.default.createElement(s.Button,{type:"ghost",className:"btn_normal_show ",size:"large"},"更换图片",this.state.loading?o.default.createElement(s.Icon,{type:"loading"}):o.default.createElement("span",null)):o.default.createElement(s.Button,{type:"primary",className:"btn_normal_show color_bg",size:"large"},"选择图片",this.state.loading?o.default.createElement(s.Icon,{type:"loading"}):o.default.createElement("span",null)))),o.default.createElement("span",{className:"upload_tips"},"尺寸为480*480，500KB以内"),this.props.form.getFieldValue("appIconUrl")?o.default.createElement("div",{className:"img_review"},o.default.createElement("img",{width:"160",height:"160",src:this.props.form.getFieldValue("appIconUrl")})):o.default.createElement("div",{className:"img_review"},o.default.createElement("div",null,"图片预览"))),o.default.createElement(u,n({className:"create_app"},p,{label:" "}),o.default.createElement(s.Button,{disabled:this.state.hidden,type:"primary",className:"btn_normal_show color_bg",onClick:this.handleSubmit,size:"large"},"创建"))))))}});f=s.Form.create()(f),e.exports=f}});