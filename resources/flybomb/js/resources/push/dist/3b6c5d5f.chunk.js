webpackJsonp([6],{897:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=a(600),l=i(s),r=a(898),n=i(r),o=a(913),u=i(o),p=a(914),d=i(p),c=a(916),m=i(c),h=a(777),f=i(h),g=l.default.createClass({displayName:"App",getInitialState:function(){return{refresh:!1}},componentWillUnmount:function(){document.querySelector("#createPush")&&(document.querySelector("#createPush").className="")},componentDidMount:function(){document.querySelector("#createPush")&&(document.querySelector("#createPush").className="active")},render:function(){var e=this.props.location.search,t=f.default.queryString("pushType",e);return l.default.createElement("div",null,"message"===t?l.default.createElement(u.default,{pushType:t}):null,"notice"===t?l.default.createElement(n.default,{pushType:t}):null,"group"===t?l.default.createElement(d.default,{pushType:t}):null,"timing"===t?l.default.createElement(m.default,null):null)}});e.exports=g},898:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=a(600),o=i(n),u=a(783),p=a(800),d=i(p),c=a(776),m=i(c),h=a(785),f=i(h),g=a(777),y=i(g),v=a(899),T=i(v),I=a(900),b=i(I),E=a(901),S=i(E),w=a(903),k=i(w),P=a(904),N=i(P),x=a(905),F=i(x),D=a(906),C=i(D),V=a(907),R=i(V),B=a(910),U=i(B),_=a(911),A=i(_),G=a(912),q=i(G),O=a(909),L=i(O),j=a(801),M=i(j),W=u.Radio.Group,J=u.Form.Item,z=null,K=null;window.vedioFilePathJson={},window.smallImageFilePathJson={},window.bigImageFilePathJson={};var H=M.default.createActions(["notice"]),$=M.default.createStore({listenables:[H],jsonData:null}),Q={labelCol:{span:4},wrapperCol:{span:20}},Z=o.default.createClass({displayName:"AddAppTask",getInitialState:function(){return{offLine:1,cronWeek:[1],onlyWifi:1,vibrate:1,lights:1,sound:1,distinctId:[],displayDistinct:"none",displayBlackList:"none",smallImageDisplay:"none",vedioDisplay:"none",bigImageDisplay:"none",noticeBarType:2,noticeExpandType:0,clickType:0,scope:0,userType:2,distinct:0,fixSpeed:0,msgCache:0,blackList:[],netType:0,fixDisplay:0,suspend:1,startTimeStatus:"success",endTimeStatus:"success",pushTimeStatus:"success",popoverVisible:!1,clearNoticeBar:1,smalllayerDisplay:"none",biglayerDisplay:"none",visible:!1,pushReviewNumber:"...",toggleStatus:!1,showAdvanceStatus:!1,pushTimeType:0,distinctTitle:[]}},delParams:function(e,t){for(var a in t)delete e[a]},clickTypeParams:function(e,t){this.setState(s({},"clickTypeParams"+t,e))},handleOk:function(){var e=this,t=window.location.href,a=t.split("#"),i=y.default.queryString("pushType",a[1]),s=y.default.queryString("appId",window.location.href),l={appId:s,json:JSON.stringify(this.state.requestData)},r=this.state.pushReviewNumber;if("0"===r)return void u.message.error("预计推送人数为0，不可以创建推送任务");if(!this.state.submiting){this.setState({submiting:!0});var n=m.default.addNotice,o="/data/push/record?appId="+s;"timing"===i&&(n=m.default.cronTaskAddNotice,o="/data/push/timing?appId="+s),f.default.post(n,l,function(){u.message.success("提交成功"),window.location.hash=o},function(){e.setState({submiting:!1})})}},showAdvance:function(){this.setState({showAdvanceStatus:!this.state.showAdvanceStatus})},selectCronWeek:function(e){this.setState({cronWeek:e})},handleSubmit:function(e,a,i){var s=this,l=this;"deal"===a&&this.setState({jumpUserGroup:!0});var n=window.location.href,o=n.split("#"),p=y.default.queryString("pushType",o[1]);return this.state.permission===!1&&"deal"!==a&&1===this.props.form.getFieldValue("userType")&&this.props.form.getFieldValue("userGroupId")?void u.message.error("用户群标签没权限"):void this.props.form.validateFields(function(e,n){var o=n.userType;if(!(+new Date(n.fixStartDisplayTime)>+new Date(n.fixEndDisplayTime))){if("deal"===a)return n.noticeBarImgUrl||(n.noticeBarImgUrl=l.state.noticeBarImgUrl),n.noticeExpandImgUrl||(n.noticeExpandImgUrl=l.state.noticeExpandImgUrl),n.showAdvanceStatus=l.state.showAdvanceStatus,$.jsonData=n,void(t.jsonData=n);var u=l.state.distinctId;if(n.distinct&&0===u.length)return void l.setState({displayDistinct:""});for(var d in n)d.indexOf("distinctId")>-1&&delete n[d];u&&(n.distinctId=u.join(","));var c=[];for(var h in n)if(h.indexOf("blackId")>-1&&n[h]){var g=h.split("blackId")[1];c.push(g),delete n[h]}if(n.blackId=c.join(","),(5!==o||n.tagIds)&&(1!==o||n.userGroupId&&"null"!==n.userGroupId)){if(1!==n.noticeBarType||window.smallImageFilePathJson.noticeBarImgUrl||n.noticeBarImgUrl||l.state.noticeBarImgUrl||l.props.form.getFieldValue("noticeBarImgUrl")||(s.setState({smallImageDisplay:""}),e={}),2!==n.noticeExpandType||window.bigImageFilePathJson.noticeExpandImgUrl||n.noticeExpandImgUrl||l.state.noticeExpandImgUrl||l.props.form.getFieldValue("noticeExpandImgUrl")||(s.setState({bigImageDisplay:""}),e={}),3!==n.noticeExpandType||window.vedioFilePathJson.vedioUrl||l.props.form.getFieldValue("vedioUrl")||(s.setState({vedioDisplay:""}),e={}),n.target=n["target"+o],n.userFilePath=n["userFilePath"+o],delete n["userFilePath"+o],""===n.target&&delete n.target,n.userFilePath&&delete n.target,e)return console.log(e),void console.log("Errors in form!!!");if(n.noticeBarInfo={noticeBarType:n.noticeBarType,title:n.title.trim(),content:n.content.trim(),noticeBarImgUrl:1===n.noticeBarType?window.smallImageFilePathJson.noticeBarImgUrl||n.noticeBarImgUrl||l.state.noticeBarImgUrl||l.props.form.getFieldValue("noticeBarImgUrl"):void 0},l.delParams(n,n.noticeBarInfo),n.noticeExpandInfo={noticeExpandType:n.noticeExpandType,noticeExpandContent:1===n.noticeExpandType?n.noticeExpandContent:void 0,noticeExpandImgUrl:2===n.noticeExpandType?window.bigImageFilePathJson.noticeExpandImgUrl||n.noticeExpandImgUrl||l.state.noticeExpandImgUrl||l.props.form.getFieldValue("noticeExpandImgUrl"):void 0,actSetting:{noticeExpandVedioUrl:window.vedioFilePathJson.vedioUrl||l.props.form.getFieldValue("vedioUrl"),onlyWifi:l.props.form.getFieldValue("onlyWifi")},vedioUrl:void 0,onlyWifi:void 0},l.delParams(n,n.noticeExpandInfo),"timing"===p){var v=n.cronTime;"object"===("undefined"==typeof v?"undefined":r(v))&&(v=y.default.dateFormat("hh:mm:ss",v));var T=s.state.cronWeek;n.cronTimeInfo={time:v,week:T.join(",")},delete n.cronTime,l.delParams(n,n.cronTimeInfo)}var I="App";1===n.clickType&&(I="AppPage");var b=[];for(var E in n)if(E.indexOf("key"+I)>-1){var S=E.split("key"+I)[1];b.push(S)}for(var w=b.length>0?b:l.state["clickTypeParams"+I],k={},P=0;P<w.length;P++){var N="key"+I+w[P],x="value"+I+w[P];n[N]&&(k[n[N].trim()]=n[x].trim(),delete n[N],delete n[x])}n.clickTypeInfo={clickType:n.clickType,url:n.url,parameters:k,clickPackage:n.clickPackage,activity:n.activity,customAttribute:n.customAttribute},l.delParams(n,n.clickTypeInfo),n.pushTimeInfo={pushTimeType:n.pushTimeType,startTime:n.startTime&&y.default.dateFormat("yyyy-MM-dd hh:mm:ss",n.startTime),offLine:n.offLine,validTime:n.validTime},l.delParams(n,n.pushTimeInfo),n.groupPushScope=n.scope,n.userGroupName=l.state.userGroupName,n.userTypeInfo={userType:o,userGroupId:n.userGroupId,target:n.target,tagIds:n.tagIds,scope:n.scope,userFilePath:n.userFilePath},l.delParams(n,n.userTypeInfo);var F={vibrate:n.vibrate||0!==n.vibrate&&!n.vibrate?1:0,lights:n.lights||0!==n.lights&&!n.lights?1:0,sound:n.sound||0!==n.sound&&!n.sound?1:0};n.advanceInfo={distinct:n.distinct,msgCache:n.msgCache,distinctId:n.distinctId,fixSpeed:n.fixSpeed,blackId:n.blackId,black:n.black,fixSpeedRate:n.fixSpeedRate,fixDisplay:n.fixDisplay,fixDisplayTime:n.fixDisplayTime&&y.default.dateFormat("yyyy-MM-dd hh:mm:ss",n.fixDisplayTime),netType:n.netType,suspend:n.suspend,clearNoticeBar:n.clearNoticeBar||0!==n.clearNoticeBar&&!n.clearNoticeBar?1:0,fixStartDisplayTime:n.fixStartDisplayTime&&y.default.dateFormat("yyyy-MM-dd hh:mm:ss",n.fixStartDisplayTime),fixEndDisplayTime:n.fixEndDisplayTime&&y.default.dateFormat("yyyy-MM-dd hh:mm:ss",n.fixEndDisplayTime),notificationType:F,noticeImgUrl:void 0},l.delParams(n,n.advanceInfo.notificationType),l.delParams(n,n.advanceInfo);var D="notice"===l.props.pushType?0:1,C=y.default.queryString("appId",window.location.href);if(n.appId=C,n.advanceInfo.black&&""===n.advanceInfo.blackId)return void l.setState({showAdvanceStatus:!0});console.log(n),l.setState({requestData:n,visible:"group"!==a});var V={appId:C,userTypeInfo:n.userTypeInfo},R=m.default.getPushCount;R=y.default.makeUrl(R,{appId:C,pushType:D,json:JSON.stringify(V)}),l.setState({pushReviewNumber:"..."}),"group"!==a&&f.default.get(R,function(e){l.setState({pushReviewNumber:e.value})},null,{timeout:3e5}),i&&"function"==typeof i&&i(n)}}})},validateTitle:function(e){var t=this.props.form.getFieldProps;return t(e,{validate:[{rules:[{required:!0,whitespace:!0,message:"请输入标题"},{max:32,message:"标题不能超过32个字"}],trigger:["onBlur","onChange"]}]})},validateContent:function(e){var t=this.props.form.getFieldProps;return t(e,{validate:[{rules:[{required:!0,message:"请输入内容"},{max:100,message:"内容不能超过100个字"},{validator:function(e,t,a){t&&t.length<=100&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}]})},queryMobileValidImei:function(){var e=this.props.form.getFieldValue("checkImeiPath"),t=this.props.form.getFieldValue("versionNum"),a="?checkImeiPath="+e+"&versionNum="+t;f.default.get(m.default.queryMobileValidImei+a,function(e){var t=e.value;u.message.success("有效IMEI数"+t)})},componentWillMount:function(){var e=this,t=y.default.queryString("appId",window.location.href);t&&e.props.form.setFieldsValue({appId:t})},cantNull:function(e){var t=this.props.form.getFieldProps;return t(e,{rules:[{required:!0,message:"不能为空"}]})},restoreStatus:function(e,t){if("noticeBarType"===e&&1===t&&(1===this.props.form.getFieldValue("noticeExpandType")||3===this.props.form.getFieldValue("noticeExpandType"))){var a={noticeExpandType:0,smalllayerDisplay:"none"};this.setState(a),this.props.form.setFieldsValue(a)}},changeCheckbox:function(e,t){this.setState({distinctId:e,distinctTitle:t})},changeBlack:function(e){var t={blackList:e},a=e.filter(function(e){return e.choose});a.length?t.displayBlackList="none":t.displayBlackList="",this.setState(t)},clearUserGroup:function(e,t){if(e==t){var a={};a.userGroupName=null,a.userGroupDesc=null,K=null,z=null,this.setState(a),this.props.form.setFieldsValue({userGroupId:null})}},changeRadio:function(e,t){var a={};"userGroupAuth"===t&&(a.permission=e.target.permission),"black"===t&&(a.displayBlackList="");var i=e.target.name,s=e.target.value;if(a[i]=s,!("noticeBarType"===i&&this.props.form.getFieldValue("noticeBarType")===s||"noticeExpandType"===i&&this.props.form.getFieldValue("noticeExpandType")===s)){if("userGroupId"===i&&(a.userGroupName=e.target.label,a.userGroupDesc=e.target.expression,K=e.target.label,z=e.target.expression),"distinct"==i&&0==s&&(a.distinctTitle=[]),"vibrate"===s||"sound"===s||"lights"===s){var l=e.target.checked;a[s]=l?1:0}this.setState(a),this.props.form.setFieldsValue(a),this.restoreStatus(i,s),this.showButton(i,s)}},showButton:function(e,t){"noticeExpandType"===e&&1!==t&&this.setState({noticeExpandContent:!1}),"noticeExpandType"===e&&2===t&&this.setState({toggleStatus:!0,showBigImg:!0,biglayerDisplay:"none"}),"noticeExpandType"===e&&1===t&&this.setState({toggleStatus:!1,biglayerDisplay:"none"})},handleCancel:function(){this.setState({visible:!1,submiting:!1})},getAppName:function(e){var t="全部应用",a=d.default.allApp;if(a)for(var i=0;i<a.length;i++)a[i].appId==e&&(t=a[i].name);this.setState({appName:t})},componentWillReceiveProps:function(){var e=y.default.queryString("appId",window.location.href);this.state.appId&&e!==this.state.appId&&(this.getAppName(e),this.setState({pushReviewNumber:"...",appId:e}),this.getAppInfo(),this.getBlackList())},getAppInfo:function(e){var t=this,a=y.default.queryString("appId",window.location.href);f.default.get(m.default.getAppInfo+"?appId="+a,function(a){var i=a.value.appIconUrl;e&&e(i),e||(t.setState({noticeImgUrl:""===i?null:i}),t.props.form.setFieldsValue({noticeImgUrl:""===i?null:i})),t.setState({flymeAuth:a.value.flymeAuth,appName:a.value.appName,limitRate:a.value.limitRate,msgCacheStatus:a.value.msgCache,pushOtherPackage:a.value.pushOtherPackage})})},componentWillUnmount:function(){document.querySelector("#createPush")&&(document.querySelector("#createPush").className="")},setUserTypeGroup:function(e){e=e.items;for(var t=e.length,a=y.default.queryString("id",window.location.href),i=0;i<t;i++)a==e[i].id&&(this.setState({userGroupName:e[i].name}),K=e[i].name,z=e[i].userGroupDesc)},fillFormData:function(e){var t,a=this,i=y.default.queryString("copyTaskId",window.location.href),l=e.value,r=l.clickTypeInfo.clickType,n=r<2?l.clickTypeInfo.parameters:void 0,o="App";1===r&&(o="AppPage");var u=[],p=(t={noticeBarType:l.noticeBarInfo.noticeBarType,noticeBarImgUrl:l.noticeBarInfo.noticeBarImgUrl,title:l.noticeBarInfo.title,content:l.noticeBarInfo.content,noticeExpandContent:l.noticeExpandInfo.noticeExpandContent,noticeExpandImgUrl:l.noticeExpandInfo.noticeExpandImgUrl,noticeExpandType:l.noticeExpandInfo.noticeExpandType,vedioUrl:l.noticeExpandInfo.actSetting&&l.noticeExpandInfo.actSetting.noticeExpandVedioUrl,onlyWifi:l.noticeExpandInfo.actSetting&&(l.noticeExpandInfo.actSetting.onlyWifi?1:0),activity:l.clickTypeInfo.activity},s(t,"parameters"+o,n),s(t,"clickType",l.clickTypeInfo.clickType),s(t,"url",l.clickTypeInfo.url),s(t,"clickPackage",l.clickTypeInfo.clickPackage),s(t,"customAttribute",l.clickTypeInfo.customAttribute),s(t,"msgCache",l.advanceInfo.msgCache?1:0),s(t,"suspend",l.advanceInfo.suspend?1:0),s(t,"clearNoticeBar",l.advanceInfo.clearNoticeBar?1:0),s(t,"fixSpeed",l.advanceInfo.fixSpeed?1:0),s(t,"fixSpeedRate",l.advanceInfo.fixSpeedRate),s(t,"distinct",i?1:l.advanceInfo.distinct?1:0),s(t,"noticeImgUrl",l.advanceInfo.noticeImgUrl),s(t,"vibrate",l.advanceInfo.notificationType.vibrate?1:0),s(t,"lights",l.advanceInfo.notificationType.lights?1:0),s(t,"sound",l.advanceInfo.notificationType.sound?1:0),s(t,"black",l.advanceInfo.black?1:0),s(t,"offLine",l.pushTimeInfo&&l.pushTimeInfo.offLine?1:0),s(t,"validTime",l.pushTimeInfo&&l.pushTimeInfo.validTime),t),d=this.props.tableDataIndex;if(d){if(l.userTypeInfo){var c=l.userTypeInfo.userType;p.userType=c,p.userGroupId=l.userTypeInfo.userGroupId,p["target"+c]=l.userTypeInfo.target||l.userFileName,p.tagIds=l.userTypeInfo.tagIds,p.scope=l.userTypeInfo.scope,p["userFilePath"+c]=l.userTypeInfo.userFilePath}p.fixDisplay=l.advanceInfo.fixDisplay}window.vedioFilePathJson.vedioUrl=l.noticeExpandInfo.actSetting&&l.noticeExpandInfo.actSetting.noticeExpandVedioUrl;for(var m in n)u.push({key:m,value:n[m]});for(var h=0;h<u.length;h++)p["key"+o+(h+1)]=u[h].key,p["value"+o+(h+1)]=u[h].value,window.parametersJson["key"+o+(h+1)]=u[h].key,window.parametersJson["value"+o+(h+1)]=u[h].value;a.props.form.setFieldsValue(p),a.setState({fixDisplay:l.advanceInfo.fixDisplay,noticeBarType:l.noticeBarInfo.noticeBarType,msgCacheStatus:l.advanceInfo.msgCacheStatus,offLine:l.pushTimeInfo&&l.pushTimeInfo.offLine?1:0}),a.showAdvance()},getBlackList:function(){var e=this,t=y.default.queryString("appId",window.location.href),a=y.default.queryString("taskId",window.location.href),i=m.default.pushTaskListBlack,s={appId:t};a&&(s.copyTaskId=a),f.default.post(i,s,function(t){var a=t.value,i={blackList:a};a.length?i.black=1:i.black=0,e.setState(i)})},componentDidMount:function(){var e=this;document.querySelector("#createPush")&&(document.querySelector("#createPush").className="active");var t=y.default.queryString("appId",window.location.href);this.setState({appId:t});var a=y.default.queryString("deal",window.location.href),i=y.default.queryString("groupId",window.location.href),s=y.default.queryString("id",window.location.href);if(this.getBlackList(),a&&$.jsonData&&!this.props.addPush?(this.setState({userType:1,userGroupId:s}),$.jsonData.userType=1,$.jsonData.userGroupId=s,e.setState($.jsonData),e.props.form.setFieldsValue($.jsonData)):(z=null,K=null,window.vedioFilePathJson={},window.smallImageFilePathJson={},window.bigImageFilePathJson={},e.props.form.setFieldsValue(this.state)),i){var l={userType:1,userGroupId:i};this.setState(l),e.props.form.setFieldsValue(l)}this.getAppInfo(function(a){e.props.form.setFieldsValue({noticeImgUrl:a});var i=y.default.queryString("taskId",window.location.href);if(i){var s=m.default.pushTaskCopy;s=y.default.makeUrl(s,{taskId:i,appId:t}),f.default.get(s,function(t){e.fillFormData(t)})}});var r=this.props.tableDataIndex;r&&this.fillFormData({value:r})},clickHide:function(e){1===e&&this.setState({noticeExpandContent:!1,toggleStatus:!1}),2===e&&this.setState({noticeExpandImgUrl:!1,showBigImg:!1,toggleStatus:!1})},clickShow:function(e){if(1===e){var t=this.props.form.getFieldValue("noticeExpandContent");if(!t)return void u.message.error("请输入展开文本");this.setState({noticeExpandContent:!0,toggleStatus:!0})}if(2===e){var a=this.props.form.getFieldValue("noticeExpandImgUrl");this.setState({noticeExpandImgUrl:a,showBigImg:!0,toggleStatus:!0})}},changeIcon:function(e){this.setState({noticeImgUrl:null}),this.props.form.setFieldsValue({noticeImgUrl:e})},onChangePushTime:function(e){var t=this.props.form.getFieldValue("fixEndDisplayTime"),a=this.props.form.getFieldValue("fixStartDisplayTime"),i=e>a?e:a,s=e>t?e:t;this.props.form.setFieldsValue({startTime:e,fixEndDisplayTime:s||e,fixStartDisplayTime:i||e})},render:function(){var e=this.props.form.getFieldProps,t=y.default.queryString("copyTaskId",window.location.href);return o.default.createElement(u.Form,{horizontal:!0,id:"detailTable"},o.default.createElement(u.Row,null,o.default.createElement(u.Col,{span:"15",className:"col_left"},o.default.createElement(J,l({},Q,{label:"通知栏样式    "}),o.default.createElement(W,e("noticeBarType",{initialValue:this.props.form.getFieldValue("noticeBarType"),onChange:this.changeRadio}),o.default.createElement(u.Radio,{name:"noticeBarType",value:2},"安卓原生"),o.default.createElement(u.Radio,{name:"noticeBarType",value:1},"图片")),o.default.createElement(q.default,{type:"noticeBarType",form:this.props.form,smallImageDisplay:this.state.smallImageDisplay,url:"noticeBarImgUrl",value:1})),o.default.createElement("div",null,o.default.createElement(J,l({},Q,{label:"标题    "}),o.default.createElement(u.Input,l({placeholder:"请输入标题",style:{width:400}},this.validateTitle("title")))),o.default.createElement(J,l({},Q,{label:"内容    "}),o.default.createElement(u.Input,l({rows:"9",placeholder:"请输入内容",style:{width:400},type:"textarea"},this.validateContent("content"))))),o.default.createElement(A.default,{changeRadio:this.changeRadio,noticeBarType:this.state.noticeBarType,flymeAuth:this.state.flymeAuth,bigImageDisplay:this.state.bigImageDisplay,vedioDisplay:this.state.vedioDisplay,form:this.props.form,addPush:this.props.addPush,formItemLayout:Q}),o.default.createElement(S.default.render,{form:this.props.form,formItemLayout:Q,pushOtherPackage:this.state.pushOtherPackage,getFieldProps:e,addPush:this.props.addPush,clickTypeParams:this.clickTypeParams,clickType:this.props.form.getFieldValue("clickType"),changeRadio:this.changeRadio}),this.props.groupPush?null:o.default.createElement("div",null,o.default.createElement(b.default,{formItemLayout:Q,getFieldProps:e,jumpUserGroup:this.state.jumpUserGroup,selectCronWeek:this.selectCronWeek,form:this.props.form,onChangePushTime:this.onChangePushTime,pushTimeStatus:this.state.endTimeStatus,pushTimeType:this.props.form.getFieldValue("pushTimeType"),changeRadio:this.changeRadio}),o.default.createElement(T.default,{form:this.props.form,offLine:this.state.offLine,formItemLayout:Q,getFieldProps:e})),this.props.groupType||!this.props.groupPush?o.default.createElement(k.default,{form:this.props.form,formItemLayout:Q,getFieldProps:e,clearUserGroup:this.clearUserGroup,scope:this.state.scope,tableDataIndex:this.props.tableDataIndex,groupPush:!!this.props.groupType,userType:this.props.form.getFieldValue("userType"),handleSubmit:this.handleSubmit,userGroupId:this.state.userGroupId,type:this.props.pushType,setUserTypeGroup:this.setUserTypeGroup,flymeAuth:this.state.flymeAuth,appId:y.default.queryString("appId",window.location.href),changeRadio:this.changeRadio}):null,this.props.groupPush?null:o.default.createElement(U.default,{form:this.props.form,formItemLayout:Q,copyTaskId:t,appId:y.default.queryString("appId",window.location.href),getFieldProps:e,displayDistinct:this.state.displayDistinct,changeCheckbox:this.changeCheckbox,distinct:this.props.form.getFieldValue("distinct"),pushType:this.props.pushType,changeRadio:this.changeRadio}),o.default.createElement(N.default,{form:this.props.form,formItemLayout:Q,getFieldProps:e,appId:y.default.queryString("appId",window.location.href),fixSpeed:this.state.fixSpeed,blackList:this.state.blackList,black:this.state.black,msgCache:this.state.msgCache,changeBlack:this.changeBlack,displayBlackList:this.state.displayBlackList,msgCacheStatus:this.state.msgCacheStatus,startTimeStatus:this.state.startTimeStatus,tableDataIndex:this.props.tableDataIndex,endTimeStatus:this.state.endTimeStatus,limitRate:this.state.limitRate,fixDisplay:this.state.fixDisplay,netType:this.state.netType,suspend:this.state.suspend,showAdvanceStatus:this.state.showAdvanceStatus,showAdvance:this.showAdvance,clearNoticeBar:this.state.clearNoticeBar,vibrate:this.props.form.getFieldValue("vibrate"),lights:this.props.form.getFieldValue("lights"),changeIcon:this.changeIcon,sound:this.props.form.getFieldValue("sound"),noticeImgUrl:this.state.noticeImgUrl||this.props.form.getFieldValue("noticeImgUrl"),changeRadio:this.changeRadio,type:this.props.pushType})),o.default.createElement(u.Col,{span:"9",style:{position:"relative"}},o.default.createElement("div",{className:"example_push"},0===this.state.noticeBarType||2===this.state.noticeBarType?o.default.createElement("div",{className:"con bdr_bottom"},o.default.createElement("div",{className:"pt10 bdr_top "},o.default.createElement(u.Row,{style:{zIndex:2}},o.default.createElement(u.Col,{className:"ta_r",span:"4"},o.default.createElement("img",{width:"26",height:"26",src:this.state.noticeImgUrl||this.props.form.getFieldValue("noticeImgUrl")||y.default.cdn+"/resources/push/images/default_icon.png"})),o.default.createElement(u.Col,{span:"20",className:"notice_text pl10"},o.default.createElement("div",{className:"notice_title"},this.props.form.getFieldValue("title")||"此处显示标题文字"),this.state.noticeExpandContent?o.default.createElement("div",{className:"notice_content notice_expand_content"},this.props.form.getFieldValue("noticeExpandContent")||window._noticeExpandContent||"此处为内容说明文字显示一行文字说明"):o.default.createElement("div",{className:"notice_content"},this.props.form.getFieldValue("content")||"此处为内容说明文字显示一行文字说明"))),2===this.state.noticeExpandType?o.default.createElement("div",{style:{position:"relative",top:-43,zIndex:1}},this.state.showBigImg?o.default.createElement("div",{style:{background:"#000",opacity:.5,position:"absolute",top:0,height:40,zIndex:11,width:"100%"}}):null,o.default.createElement(F.default,{noticeExpandImgUrl:this.state.noticeExpandImgUrl,showBigImg:this.state.showBigImg,form:this.props.form})):null)):null,1===this.state.noticeBarType?o.default.createElement("div",{className:"con bdr_bottom"},o.default.createElement("div",{className:"pt10 bdr_top "},2===this.state.noticeExpandType?o.default.createElement("div",null,this.state.toggleStatus?o.default.createElement(F.default,{noticeExpandImgUrl:this.state.noticeExpandImgUrl,showBigImg:this.state.showBigImg,form:this.props.form}):o.default.createElement(C.default,{form:this.props.form})):o.default.createElement(u.Row,null,o.default.createElement(u.Col,{span:"24"},o.default.createElement(C.default,{form:this.props.form}))))):null),1!==this.state.noticeExpandType&&2!==this.state.noticeExpandType||this.state.toggleStatus?null:o.default.createElement("div",{onClick:this.clickShow.bind(this,this.state.noticeExpandType),className:"click_show"},"点击展开"),1!==this.state.noticeExpandType&&2!==this.state.noticeExpandType||!this.state.toggleStatus?null:o.default.createElement("div",{onClick:this.clickHide.bind(this,this.state.noticeExpandType),className:"click_show"},"点击收起"))),o.default.createElement(u.Row,{className:"push_btn"},o.default.createElement(u.Col,{span:"14"},this.props.groupPush?null:o.default.createElement(J,{label:""},o.default.createElement(u.Button,{type:"primary",onClick:this.handleSubmit,size:"large"},"推送")))),this.props.groupPush?o.default.createElement(u.Row,null,o.default.createElement(u.Col,null,o.default.createElement(L.default,{submiting:this.props.submiting,handleOk:this.props.handleOk,type:this.props.pushType,groupPush:this.props.groupPush,groupType:this.props.groupType,form:this.props.form,setTableData:this.props.setTableData,handleSubmit:this.handleSubmit,addPushData:this.props.addPushData,requestData:this.state.requestData,handleCancel:this.props.handleCancel,visible:this.props.visible,pushReviewNumber:this.state.pushReviewNumber,popoverVisible:this.state.popoverVisible}))):null,o.default.createElement(R.default,{form:this.props.form,requestData:this.state.requestData,noticeImgUrl:this.state.noticeImgUrl||this.props.form.getFieldValue("noticeImgUrl"),visible:this.state.visible,userGroupName:K||this.state.userGroupName,userGroupDesc:z||this.state.userGroupDesc,handleOk:this.handleOk,cronWeek:this.state.cronWeek,blackList:this.state.blackList,noticeExpandContent:window._noticeExpandContent,appName:this.state.appName,submiting:this.state.submiting,msgCache:this.state.msgCache,msgCacheStatus:this.state.msgCacheStatus,type:this.props.pushType,handleCancel:this.handleCancel,distinctTitle:this.state.distinctTitle,pushReviewNumber:this.state.pushReviewNumber}))}});Z=u.Form.create()(Z),e.exports=Z},899:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},r=a(600),n=i(r),o=a(783),u=o.Radio.Group,p=o.Form.Item,d=n.default.createClass({displayName:"ValidateTime",getInitialState:function(){return{show:!0}},validateTime:function(e){var t=this;return this.props.getFieldProps(e,{initialValue:t.props.form.getFieldValue("validTime")||"24",rules:[{validator:function(a,i,l){return(i=String(i))?i&&i.match(/^\s/)?void l(new Error("行首不能输入空格")):(i&&(!i.match(/^\d+$/)||i>72)&&t.props.form.setFieldsValue(s({},e,72)),void(i&&(!i.match(/^\d+$/)||i<1)?t.props.form.setFieldsValue(s({},e,1)):l())):void l(new Error("请输入有效时长"))}}]})},render:function(){return n.default.createElement("div",null,n.default.createElement(p,l({},this.props.formItemLayout,{label:"是否离线    "}),n.default.createElement(u,this.props.getFieldProps("offLine",{initialValue:this.props.form.getFieldValue("offLine")}),n.default.createElement(o.Radio,{name:"offLine",value:1},"是"),n.default.createElement(o.Radio,{name:"offLine",value:0},"否"))),this.props.form.getFieldValue("offLine")?n.default.createElement(p,l({className:"valid_time",extra:"  小时"},this.props.formItemLayout,{label:"有效时长    "}),n.default.createElement(o.Input,l({type:"number",min:1,max:72,style:{width:200}},this.validateTime("validTime")))):null)}});e.exports=d},900:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},r=a(600),n=i(r),o=a(783),u=a(777),p=i(u),d=o.Button.Group,c=o.Radio.Group,m=o.Form.Item,h=new Date,f={labelCol:{span:4},wrapperCol:{span:17}};window._cronWeeks=[1];var g=n.default.createClass({displayName:"ValidateTime",getInitialState:function(){return{cronWeek:[1],cronWeek1:!0}},onChange:function(e){this.props.onChangePushTime(e)},selectCronWeek:function(e){var t=this.state.cronWeek,a=t.filter(function(t){return t!==e});a.length===t.length?t.push(e):t=a,t.sort(),window._cronWeeks=t,this.setState(s({cronWeek:t},"cronWeek"+e,!this.state["cronWeek"+e])),this.props.selectCronWeek(t)},componentWillUnmount:function(){this.props.jumpUserGroup||(window._cronWeeks=[1])},selectCronTime:function(){},componentDidMount:function(){var e=p.default.queryString("pushType",window.location.href);if("timing"===e){var t=window._cronWeeks;this.props.selectCronWeek&&this.props.selectCronWeek(t);var a=new Date,i={dateNow:a,cronWeek:t};t.map(function(e){i["cronWeek"+e]=!0}),this.setState(i)}},onSelect:function(){},render:function(){var e=this,t=window.location.href,a=t.split("#"),i=p.default.queryString("pushType",a[1]),s=function(e){return e&&e.getTime()+864e5<=Date.now()},r=["一","二","三","四","五","六","日"],u=r.map(function(t,a){var i=a+1;return n.default.createElement(o.Button,{key:a,onClick:function(){return e.selectCronWeek(i)},type:e.state["cronWeek"+i]?"primary":""},t)}),g=this.state.dateNow,y="timing"===i?n.default.createElement(m,l({},f,{label:"任务定制    "}),n.default.createElement(m,l({className:"timing_push radio_btn time_push_checkbox"},this.props.formItemLayout,{label:"推送周期    "}),n.default.createElement(d,null,u)),n.default.createElement(m,l({style:{paddingTop:10},className:"timing_push"},this.props.formItemLayout,{label:"推送时间    "}),n.default.createElement(o.TimePicker,l({},this.props.getFieldProps("cronTime",{initialValue:g,onChange:this.selectCronTime,validate:[{rules:[{required:!0,type:"date",message:"请选择时间"}],trigger:["onBlur","onChange"]}]}),{placeholder:"选择时间",size:"large"})))):n.default.createElement(m,l({},this.props.formItemLayout,{label:"推送时间    "}),n.default.createElement(c,l({onChange:this.onChange},this.props.getFieldProps("pushTimeType",{initialValue:this.props.pushTimeType,onChange:this.props.changeRadio})),n.default.createElement(o.Radio,{name:"pushTimeType",value:0},"即时"),n.default.createElement(o.Radio,{name:"pushTimeType",value:1},"定时")),1===this.props.pushTimeType?n.default.createElement(m,{className:"display_ib mg0"},n.default.createElement(o.DatePicker,l({disabledDate:s},this.props.getFieldProps("startTime",{initialValue:h,onChange:this.onChange,validate:[{rules:[{required:!0,type:"date",message:"请输入推送时间"},{validator:function(e,t,a){var i=+new Date,s=+new Date(t);t&&i-s>0?a("推送时间不能早于当前时间"):a()}}],trigger:["onBlur","onChange"]}]}),{showTime:!0,format:"yyyy-MM-dd HH:mm:ss"}))):null);return y}});g=o.Form.create()(g),e.exports=g},901:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},r=a(600),n=i(r),o=a(783),u=a(777),p=i(u),d=a(776),c=i(d),m=a(785),h=i(m),f=a(902),g=i(f),y=a(801),v=i(y),T=o.Radio.Group,I=o.Form.Item,b=v.default.createActions(["clickType"]),E={labelCol:{span:4},wrapperCol:{span:20}},S=v.default.createStore({listenables:[b],clickTypeParamsApp:[1],clickTypeParamsAppPage:[1]});window.parametersJson={};var w="",k="",P="",N=n.default.createClass({displayName:"ClickType",getInitialState:function(){return{keyTplValue:[],paramsApp:!1,paramsAppPage:!1}},mixins:[v.default.listenTo(S,"showAppPage")],addParams:function(e,t){var a;if(this.addremove=!0,this.state["clickTypeParams"+t]&&10===this.state["clickTypeParams"+t].length)return void o.message.error("最多允许设置10个参数和值");var i=this.state["clickTypeParams"+t]||[1],l=i[i.length-1]+1;
i.push(l),this.setState((a={},s(a,"clickTypeParams"+t,i),s(a,"params"+t,!0),a)),this.props.clickTypeParams(i,t)},removeParam:function(e,t){var a;if(this.addremove=!0,!this.state["clickTypeParams"+t]||this.state["clickTypeParams"+t]&&1===this.state["clickTypeParams"+t].length)return void o.message.error("最后一条不能删除");this.state["clickTypeParams"+t]&&2===this.state["clickTypeParams"+t].length&&this.setState(s({},"params"+t,!1));var i=this.state["clickTypeParams"+t]||[1];delete window.parametersJson["key"+t+i[e-1]],delete window.parametersJson["value"+t+i[e-1]],this.props.form.setFieldsValue((a={},s(a,"key"+t+i[e-1],""),s(a,"value"+t+i[e-1],""),a)),i.splice(e-1,1),this.setState(s({},"clickTypeParams"+t,i)),this.props.clickTypeParams(i,t)},validateTemplateName:function(e){var t=this,a=this.props.form.getFieldProps;return a(e,{validate:[{rules:[{required:!0,message:"请输入模板名称"},{max:20,message:"模板名称不能超过20个字符"},{validator:function(e,t,a){t&&t.length<=20&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){t.setState({templateName:e.target.value})}})},validateActivity:function(e){var t=this.props.form.getFieldProps;return t(e,{initialValue:w,validate:[{rules:[{required:!0,message:"请输入地址"},{max:1e3,message:"应用页面不能超过1000个字符"},{validator:function(e,t,a){t&&t.length<=1e3&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){w=e.target.value}})},showAppPage:function(){var e=this,t=this,a=this.props.clickType,i=this.props.form.getFieldProps,r="App";1===a&&(r="AppPage");var u=[],p=1,d=s({},r,[]);if(!this.addremove)for(var c in window.parametersJson)c.indexOf("AppPage")>-1?c.indexOf("key")>-1&&"AppPage"===r&&d.AppPage.push(p++):c.indexOf("key")>-1&&"App"===r&&d.App.push(p++);for(var m=d[r].length?d[r]:this.state["clickTypeParams"+r]||[1],h=m.length,f=this.state["params"+r],g=f?"":"disable",y=function(a){var p;u.push(n.default.createElement(o.Row,(p={className:"mt25"},s(p,"className","click_type_keyvalue"),s(p,"key",m[a]),p),n.default.createElement(o.Col,{span:"5"},n.default.createElement(I,null,n.default.createElement(o.Input,l({placeholder:"输入参数"},i("key"+r+m[a],{initialValue:window.parametersJson["key"+r+m[a]]||e.props.form.getFieldValue("key"+r+m[a]),validate:[{rules:[{validator:function(e,i,s){var l=t.props.form.validateFields;if(!i&&t.props.form.getFieldValue("value"+r+m[a])&&s("请输入参数"),i&&!t.props.form.getFieldValue("value"+r+m[a]))return void l(["value"+r+m[a]],{force:!0});if(i)for(var n=0;n<h;n++)if(i===t.props.form.getFieldValue("key"+r+m[n])&&a!==n)return void s("参数不能同名");s()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){var i=t.props.form.validateFields,l=e.target.value;window.parametersJson["key"+r+m[a]]=l.trim(),i(["value"+r+m[a]],{force:!0}),t.props.form.setFieldsValue(s({},"key"+r+m[a],l.trim()))}}))))),n.default.createElement(o.Col,{className:"ml20 col",span:"5"},n.default.createElement(I,null,n.default.createElement(o.Input,l({placeholder:"输入值"},i("value"+r+m[a],{initialValue:window.parametersJson["value"+r+m[a]]||e.props.form.getFieldValue("value"+r+m[a]),validate:[{rules:[{validator:function(e,i,s){var l=t.props.form.validateFields;if(0!==i&&!i&&t.props.form.getFieldValue("key"+r+m[a])&&s("请输入值"),i)for(var n=0;n<h;n++)t.props.form.getFieldValue("key"+r+m[a])===t.props.form.getFieldValue("key"+r+m[n])&&a!==n?l(["key"+r+m[a]],{force:!0}):s();i&&!t.props.form.getFieldValue("key"+r+m[a])&&l(["key"+r+m[a]],{force:!0}),s()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){var i=t.props.form.validateFields,l=e.target.value;window.parametersJson["value"+r+m[a]]=l.trim(),i(["key"+r+m[a]],{force:!0}),t.props.form.setFieldsValue(s({},"value"+r+m[a],l.trim()))}}))))),n.default.createElement(o.Col,{className:"ml20",span:"5"},n.default.createElement(o.Button,{id:"minus"+(a+1)+r,onClick:e.removeParam.bind(e,a+1,r),className:"minus_btn "+g},"—"))))},v=0;v<h;v++)y(v);var T=this.state["keyTplId"+a],b=T||0===T,S=b?"编辑参数模板":"存为参数模板";return 1===a||0===a?n.default.createElement("div",{className:"mt10"},1===a?n.default.createElement(I,null,n.default.createElement(o.Input,l({type:"textarea",style:{width:400},placeholder:"输入完整的应用页面地址，如com.meizu.pushdemo.TestActivity"},this.validateActivity("activity")))):null,u,n.default.createElement(o.Row,null,n.default.createElement(o.Col,{span:"5"},n.default.createElement(o.Button,{size:"large",className:"color_bdc",style:{width:"100%"},type:"ghost",onClick:this.addParams.bind(this,h,r)},"添加参数")),n.default.createElement(o.Col,{className:"ml20",span:"5"},n.default.createElement(o.Button,{size:"large",className:"color_bdc",style:{width:"100%"},type:"ghost",onClick:this.saveTpl.bind(this,b)},S),this.state.visible?n.default.createElement(o.Modal,{width:700,onCancel:this.handleCancel,onOk:this.handleOk,title:"保存模板",visible:this.state.visible},n.default.createElement(I,l({className:"key_template_modal"},E,{label:"模板名称"}),n.default.createElement(o.Input,l({style:{width:400},placeholder:"输入模板名称"},this.validateTemplateName("templateName"))),this.getTemplateInfo())):null)),n.default.createElement(o.Row,{className:"pt10 "},n.default.createElement(o.Col,{span:"6"},n.default.createElement("a",{onClick:this.getKeyTpl,href:"javascript:;"},"使用参数模板")),n.default.createElement(o.Col,{span:"18"},this.state["currentTemplateName"+a]&&n.default.createElement("span",null,this.state["currentTemplateName"+a],n.default.createElement("a",{className:"pl10",href:"javascript:;",onClick:this.clearTemplate},"清空 ")))),this.state.keyTplStatus?n.default.createElement(o.Row,null,n.default.createElement(o.Col,null,this.createTpl(this.state.keyTplValue))):null):null},clearTemplate:function(){var e,t=this.props.clickType,a="App";1===t&&(a="AppPage");var i=(e={},s(e,"keyTplId"+t,null),s(e,"currentTemplateName"+t,null),s(e,"clickTypeParams"+a,[1]),s(e,"parameters"+a,{}),s(e,"key"+a+1,""),s(e,"value"+a+1,""),s(e,"currentChecked"+t,null),e),l=/App\d/,r=/AppPage\d/;for(var n in window.parametersJson)("App"===a&&n.match(l)||"AppPage"===a&&n.match(r))&&delete window.parametersJson[n];this.setState(i),this.props.form.setFieldsValue(i)},getTemplateInfo:function(){var e=this.props.clickType,t=this.getParameters(),a=[];if(1==e){var i=this.props.form.getFieldValue("activity");a.push(n.default.createElement("div",{className:"break_word",key:"app_page_url_"+i},"应用页面地址：",i))}for(var s in t)"undefined"!=s&&""!=s&&a.push(n.default.createElement("div",{key:s},n.default.createElement("p",null,"参数：",s.trim()),n.default.createElement("p",{className:"break_word"},"值：",String(t[s]).trim())));return n.default.createElement(I,l({},E,{label:"模板参数    "}),n.default.createElement("div",{style:{marginTop:7}},a))},getParameters:function(){var e=this.props.clickType,t={};for(var a in window.parametersJson)if(a.indexOf("key")>-1&&(e&&a.length>10||!e&&a.length<10)){var i=a.replace("key","value");t[window.parametersJson[a]]=window.parametersJson[i]}return t},handleOk:function(){var e=p.default.queryString("appId",window.location.href),t=c.default.cptSaveOrUpdate,a=this.props.clickType,i=this.getParameters(),s=this,l={clickType:a,parameters:i};1===a&&(l.activity=this.props.form.getFieldValue("activity"));var r="模板新增成功",n=this.state["keyTplId"+a],u=this.state.templateName,d={appId:e,templateName:u,clickTypeInfoParam:JSON.stringify(l)};(n||0===n)&&(d.id=n,r="模板修改成功"),h.default.post(t,d,function(e){o.message.success(r),s.getKeyTpl("refresh");var t={visible:!1},i=e.value.id;t["currentChecked"+a]=i,t["currentTemplateName"+a]=u,t["keyTplId"+a]=i,s.setState(t),s.props.from.setFieldsValue(t),s.addremove=!1})},handleCancel:function(){this.setState({visible:!1})},saveTpl:function(e){var t=this,a=this.props.clickType;this.props.form.validateFields(function(i){for(var s in i)if("activity"===s||s.indexOf("keyApp")>-1)return;t.props.form.setFieldsValue({templateName:t.state["currentTemplateName"+a]}),t.setState({tplStatus:e,visible:!0})})},createTpl:function(e){var t=this,a=this.props.clickType,i=[{title:"推送时间",key:"0",className:"ta_l",dataIndex:"templateName",render:function(e,i){return n.default.createElement(o.Radio,{checked:i.id===t.state["currentChecked"+a]?!t.state.templateChecked:t.state.templateChecked,onChange:function(){t.setState(s({templateChecked:t.state.templateChecked},"currentChecked"+a,i.id));var e={target:{value:i.id,query:i.clickTypeInfoParam,templateName:i.templateName}};t.setKeyTpl(e)},name:"template"},i.templateName)}},{title:"推送时间",key:"1",className:"ta_c",dataIndex:"",render:function(e,a){return n.default.createElement(o.Tooltip,{title:"删除参数模板"},n.default.createElement("i",{onClick:function(){return t.delKeyTpl(a)},className:"i_del"}))}}],l=[];e.map(function(e){a===e.clickTypeInfoParam.clickType&&l.push(e)});var r=n.default.createElement("div",{className:"user_type"},l.length>0?n.default.createElement(I,null,n.default.createElement("div",{className:"key_tpl_table"},n.default.createElement(o.Table,{pagination:!1,columns:i,dataSource:l}))):this.state.loadTpl?n.default.createElement("div",null,"数据拉取中..."):n.default.createElement("div",{className:"color_error"},"无参数模板"));return r},setKeyTpl:function(e){var t,a=e.status;if(!a){var i=e.target.query,l="App",r=i.parameters,n=i.clickType,o=e.target.value,u=(t={},s(t,"keyTplId"+n,o),s(t,"currentChecked"+n,o),s(t,"clickType",n),s(t,"templateName",e.target.templateName),s(t,"currentTemplateName"+n,e.target.templateName),t);n&&(l="AppPage",u.activity=i.activity,w=i.activity);var p=/App\d/,d=/AppPage\d/;for(var c in window.parametersJson)("App"===l&&c.match(p)||"AppPage"===l&&c.match(d))&&delete window.parametersJson[c];var m=[],h=0;for(var f in r)h++,u["key"+l+h]=f,u["value"+l+h]=r[f],window.parametersJson["key"+l+h]=f,window.parametersJson["value"+l+h]=r[f],m.push(h);u["parameters"+l]=r,u["clickTypeParams"+l]=m,u["params"+l]=!0,h<2&&(u["params"+l]=!1),0===Object.keys(r).length&&(u["clickTypeParams"+l]=[1],u["key"+l+1]="",u["value"+l+1]=""),this.props.form.setFieldsValue(u),this.setState(u)}},delOk:function(){var e=this,t=this.state.delData,a=c.default.cptDel;a=p.default.makeUrl(a,{appId:t.appId,id:t.id});var i=this.props.clickType;h.default.get(a,function(){o.message.success("删除成功");var a={delVisible:!1};t.id===e.state["keyTplId"+i]&&(e.props.form.setFieldsValue(s({},"keyTplId"+i,null)),a["currentTemplateName"+i]="",a["keyTplId"+i]=null),e.setState(a),e.getKeyTpl("refresh")})},delCancel:function(){this.setState({delVisible:!1})},delKeyTpl:function(e){this.setState({delData:e,delVisible:!0})},componentWillUnmount:function(){},componentWillReceiveProps:function(){if(!this.addremove){var e="App";1===this.props.clickType&&(e="AppPage");var t=this.props.form.getFieldValue("parameters"+e),a=[],i=[],l=0;for(var r in t)a.push(l++ +1),i.push(r);this.setState(s({},"clickTypeParams"+e,0===a.length?[1]:a))}},componentWillMount:function(){var e=p.default.queryString("deal",window.location.href);e&&!this.props.addPush||(window.parametersJson={},w="",k="",P="")},componentDidMount:function(){},vidatePackageName:function(e){var t=this.props.form.getFieldProps;return t(e,{validate:[{rules:[{max:100,message:"包名不能超过100个字"},{validator:function(e,t,a){t=t&&t.trim(),t&&""===t||t&&!t.match(/^[a-zA-Z][\w_]*(\.[a-zA-Z][\w_]*)+$/)?a(new Error("请输入包名的正确格式，比如：com.flyme.sms")):a()}}],trigger:["onBlur","onChange"]}]})},changeRadio:function(e){this.props.changeRadio(e)},getKeyTpl:function(e){var t=this,a=p.default.queryString("appId",window.location.href);return"refresh"!==e&&this.state.keyTplStatus?void this.setState({keyTplStatus:!1}):(this.setState({loadTpl:!0}),void h.default.get(c.default.cptListByAppId+"?appId="+a,function(a){t.setState({loadTpl:!1,keyTplStatus:"refresh"===e||!t.state.keyTplStatus,keyTplValue:a.value})}))},render:function(){var e="点击动作　",t=this.props.pushOtherPackage?n.default.createElement(g.default,{text:e}):e;return n.default.createElement("div",null,n.default.createElement(I,l({},this.props.formItemLayout,{label:t}),this.props.pushOtherPackage?n.default.createElement(I,null,n.default.createElement(o.Input,l({placeholder:"请输入调起的应用包名",style:{width:200}},this.vidatePackageName("clickPackage")))):null,n.default.createElement(T,this.props.getFieldProps("clickType",{initialValue:this.props.clickType,onChange:this.changeRadio}),n.default.createElement(o.Radio,{name:"clickType",value:0},"打开应用"),n.default.createElement(o.Radio,{name:"clickType",value:1},"打开应用页面"),n.default.createElement(o.Radio,{name:"clickType",value:2},"打开URI页面"),n.default.createElement(o.Radio,{name:"clickType",value:3},"应用客户端自定义")),this.showAppPage(),2===this.props.clickType?n.default.createElement("div",{className:"mt10"},n.default.createElement(I,null,n.default.createElement(o.Input,l({type:"textarea",style:{width:400},placeholder:"输入URI"},this.props.getFieldProps("url",{initialValue:k,validate:[{rules:[{required:!0,message:"请输入URI"},{max:1e3,message:"URI不能超过1000个字符"}],trigger:["onBlur","onChange"]}],onBlur:function(e){k=e.target.value}}))))):null,3===this.props.clickType?n.default.createElement("div",{className:"mt10"},n.default.createElement(I,null,n.default.createElement(o.Input,l({type:"textarea",style:{width:400},placeholder:"自定义内容"},this.props.getFieldProps("customAttribute",{initialValue:P,validate:[{rules:[{required:!0,message:"请输入自定义内容"},{max:1e3,message:"内容不能超过1000个字符"},{validator:function(e,t,a){t&&t.length<=1e3&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){P=e.target.value}}))))):null),n.default.createElement(o.Modal,{title:"系统提示",visible:this.state.delVisible,onOk:this.delOk,onCancel:this.delCancel},n.default.createElement("p",null,"删除参数模板：",this.state.delData&&this.state.delData.templateName,"?")))}});t.render=N,t.clickTypeParamsApp=S.clickTypeParamsApp,t.clickTypeParamsAppPage=S.clickTypeParamsAppPage},902:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=a(600),l=i(s),r=a(783),n=l.default.createClass({displayName:"Info",getContainer:function(){return document.getElementById("detailTable")},render:function(){var e=this,t=[{text:"目标数",title:"计划推送的目标数"},{text:"日增用户数",title:"当天首次订阅应用的设备数"},{text:"在线峰值用户数",title:"订阅该应用的设备中，当天同时在线的数量峰值"},{text:"日联网用户数",title:"订阅该应用的设备中，当天有联网行为的设备数总和"},{text:"累计注册用户数",title:"历史累积订阅该应用的设备数，已卸载应用不计入累计用户数中"},{text:"联网数",title:"联网并且与通道形成长链接的设备数"},{text:"到达应用数",title:"PushSDK将消息发送给应用的数量（flyme6中，通知栏消息由pushSDK弹出，此埋点仍保留有上报数据）"},{text:"划掉数",title:"在通知栏中划掉消息的数量。透传消息不统计该项"},{text:"已卸载数",title:"本次推送任务中应用已被卸载的数量，数据上将出现接收数大于展示数。（flyme6固件此应用会被反订阅，在重新订阅前下次推送任务将不朝它推送；flyme6以下固件应用没有被反订阅）"},{text:"有效数",title:"从目标数中去除错误或无效的ID，实际有效的ID数量。筛选包括开关状态，订阅状态，pushid有效性以及其他可以推送状态"},{text:"推送数",title:"Push平台实际下发推送的数量"},{text:"接收数",title:"Push服务接收数，任务有效期内，联网并正常接收到推送消息的数量"},{text:"展示数",title:"客户端从Push服务收到消息，并在通知栏中展示的数量（3.0以下版本SDK，数据统计T+1，3.0以上实时统计。透传消息没有展示数统计）"},{text:"点击数",title:"用户点击消息的数量（3.0以下版本SDK，数据统计T+1，3.0以上实时统计。透传消息没有点击数统计）"},{text:"App ID",title:"应用的唯一标识，客户端订阅推送时使用"},{text:"App Key",title:"客户端身份标识，客户端订阅推送时使用"},{text:"App Secret",title:"服务端身份标识，服务端 SDK 初始化使用"},{text:"点击动作",title:"调起包名不是必填项，如不填，则参数传给本应用"},{text:"推送黑名单",title:"选择黑名单后，本次推送将不会朝这批用户推送"},{text:"定速推送",title:"开启定速推送后，此任务的推送速率将按设置的速率推送。速率不会超过应用最大推送速率"},{text:"定时展示",title:"开启定时展示后，目标用户的展示量将平摊到时间段内"},{text:"任务定制",title:"设置好循环推送的周期后，会在规定的时间点进行推送"}],a=t.map(function(t){var a=e.props.text;return a.indexOf(t.text)>-1?t.title:""});return l.default.createElement("span",null,l.default.createElement(r.Tooltip,{getTooltipContainer:this.getContainer,title:a},l.default.createElement("i",{className:"fs14 color999 fw_n cursor_p anticon anticon-info-circle-o"})),this.props.text)}});e.exports=n},903:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},r=a(600),n=i(r),o=a(783),u=a(776),p=i(u),d=a(777),c=i(d),m=a(785),h=i(m),f=o.Radio.Group,g=o.Form.Item,y={},v={},T=n.default.createClass({displayName:"UserType",getInitialState:function(){return{userTypeGroup:[],userTypeTags:[],tags:{},tagIds:{},visible:!1}},componentWillMount:function(){var e=location.href;e.indexOf("pushType=group")>-1&&(y={})},componentWillReceiveProps:function(){var e=this,t=c.default.queryString("appId",window.location.href);if(this.props.appId&&t!==this.props.appId){this.getTags(t),this.getUserGroup(t);var a=this.props.userType,i=this.props.flymeAuth;1!==a&&3!==a&&6!==a||!i||e.changeRadio({target:{name:"userType",value:2}})}},getTags:function(e){var t=this,a=p.default.appTag,i=this.props.tableDataIndex;a=c.default.makeUrl(a,{appId:e}),h.default.get(a,function(e){var a=e.value,s=a.length,l={},r={},n={};if(i){for(var o=i.userTypeInfo.tagIds||"",u=o.split(","),p=[],d=0;d<s;d++)for(var c=0;c<u.length;c++)a[d].tagId==u[c]&&(p.push(a[d].tagName),r[a[d].tagId]=!r[a[d].tagId],n[a[d].tagName]=!n[a[d].tagName]);p=p.join(","),l.tagIdsName=p,l.tagIdsValue=o}t.setState({userTypeTags:e.value,tags:n,tagIds:r,tagIdsName:l.tagIdsName||null,tagIdsValue:l.tagIdsValue||null}),t.props.form.setFieldsValue({tagIdsName:l.tagIdsName||null,tagIds:l.tagIdsValue||null})})},componentDidMount:function(){var e=c.default.queryString("appId",window.location.href),t=c.default.queryString("deal",window.location.href),a=c.default.queryString("groupId",window.location.href);this.setState({appId:e,pushType:c.default.queryString("pushType",window.location.href)}),(t||a||this.props.personalPush)&&this.getUserGroup(e),this.getTags(e),y={},v={},this.props.tableDataIndex&&this.getUserGroup(e)},getUserGroup:function(e){var t=this,a=p.default.listUserGroup;a=c.default.makeUrl(a,{appId:e}),h.default.get(a,function(e){t.setState({userTypeGroup:e.value.items,isDmp:e.value.isDmp,loadGroup:!0}),t.props.setUserTypeGroup(e.value)})},selectTags:function(e){var t=this.state.tags,a=this.state.tagIds,i=e.target.getAttribute("value"),s=e.target.getAttribute("title");t[s]=!t[s],a[i]=!a[i];var l=[],r=[];for(var n in t)t[n]&&l.push(n);for(var o in a)a[o]&&r.push(o);e.target.className=""===e.target.className?"current":"",this.setState({tags:t,tagIds:a,tagIdsName:l.join(","),tagIdsValue:r.join(",")}),this.props.form.setFieldsValue({tagIdsName:l.join(","),tagIds:r.join(",")}),this.props.changeRadio({target:{name:"tags"}})},delUserGroup:function(e,t){var a=this;this.setState({visible:!0,userGroupName:e,delIcon:!0,userGroupId:t});var i=a.props.form.getFieldValue("userGroupId");i!=t&&setTimeout(function(){a.props.form.setFieldsValue({userGroupId:i})},0)},delOk:function(){var e=this,t=c.default.queryString("appId",window.location.href),a=this,i=p.default.delUserGroup,s=this.state.userGroupId,l=this.props.form.getFieldValue("userGroupId");h.default.post(i,{id:this.state.userGroupId},function(){a.getUserGroup(t),o.message.success("用户群"+e.state.userGroupName+"删除成功"),a.props.clearUserGroup(l,s),a.setState({visible:!1,delIcon:!1})})},changeRadio:function(e){var t=c.default.queryString("appId",window.location.href),a=e.target.name,i=e.target.value;"userType"===a&&(this.setState(s({},"target"+i,this.props.form.getFieldValue("target"+i))),1===i&&this.getUserGroup(t)),this.props.changeRadio(e)},delCancel:function(){this.setState({visible:!1,delIcon:!1})},validate:function(e){var t=this,a=this.props.userType,i=this.props.tableDataIndex,s=null;return this.state.removed||this.props.userType!==(i&&i.userTypeInfo.userType)||(s=i.userFileName),this.props.getFieldProps(e,{onChange:function(){t.props.changeRadio({target:{name:"changeTarget"}})},initialValue:y["target"+a]||s,validate:[{rules:[{required:(a>1&&a<5||6===a)&&!this.state["targetRequired"+a],message:"不能为空"},{validator:function(e,t,a){t&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){y["target"+a]=e.target.value}})},getUserType:function(){var e=this,t=this.props.userType,a=p.default.uploadUserFile,i=c.default.queryString("appId",window.location.href);a=c.default.makeUrl(a,{pushType:"notice"===this.props.type?0:1,userType:t,appId:i});var r=10;e.props.flymeAuth&&(r=50);var u=[],d=this.props.tableDataIndex,m=y["target"+t];!m&&d&&t==d.userTypeInfo.userType&&(m=d.userFileName);var h=!1;!this.state.removed&&(!this.props.clearUserFile||this.state.clearUserFile)&&m&&m.indexOf(".txt")>-1&&m.indexOf(".txt")===m.length-4&&(u=[{uid:-1,name:m,status:"done",url:""}],h=!0);var f={name:"userFile",data:{},accept:".txt",action:a,defaultFileList:u,beforeUpload:function(t){e.setState({loading:!0});var a=t.type;if(t.size>1048576*r)return o.message.error("文件大小不能超过"+r+"M"),e.setState({loading:!1}),!1;var i="text/plain"===a;return i||(o.message.error("请上传txt格式的文件"),e.setState({loading:!1})),i},headers:{authorization:"authorization-text"},onChange:function(t){var a=e.props.userType;if("removed"===t.file.status){if(e.setState({loading:!1}),t.fileList.length<1){var i,l;e.setState((i={},s(i,"targetDisabled"+a,!1),s(i,"removed",!0),s(i,"targetRequired"+a,!1),i)),e.props.form.setFieldsValue((l={},s(l,"userFilePath"+a,void 0),s(l,"target"+a,void 0),l)),y["target"+a]=null}return void e.props.changeRadio({target:{name:"remove"}})}if("error"===t.file.status&&e.setState({loading:!1}),"done"===t.file.status)if(e.setState({loading:!1}),200==t.file.response.code){var r,n;t.fileList.length>1&&t.fileList.shift(),o.message.success(t.file.name+" 上传成功。"),e.props.form.setFieldsValue((r={},s(r,"userFilePath"+a,t.file.response.value.userFilePath),s(r,"target"+a,t.file.name),r)),v["userFilePath"+a]=t.file.response.value.userFilePath,y["target"+a]=t.file.name,e.setState((n={},s(n,"targetDisabled"+a,!0),s(n,"clearUserFile",!0),s(n,"targetRequired"+a,!0),n)),"group"===e.state.pushType&&e.props.changeRadio({target:{name:"upload"}})}else t.fileList.pop(),o.message.error(t.file.response.message),e.props.form.setFieldsValue({})}};return n.default.createElement("div",{className:"user_type"},n.default.createElement(g,null,n.default.createElement(o.Input,l({disabled:h||this.state["targetDisabled"+t],style:{width:300},placeholder:"多个以;分隔",className:"mb10"},this.validate("target"+t)))),n.default.createElement(o.Upload,l({},this.props.getFieldProps("userFilePath"+t,{initialValue:v["userFilePath"+t]}),{style:{width:200}},f),n.default.createElement(o.Button,{disabled:!!this.state.loading,size:"large",className:"btn_normal_show ",type:"ghost"},"TXT文档批量导入",this.state.loading?n.default.createElement(o.Icon,{type:"loading"}):n.default.createElement("span",null))),n.default.createElement("span",{className:"upload_tips"},"最多不超过",r,"M，UTF-8无BOM格式编码文件，内容以回车键进行分割"))},handleSubmit:function(e,t){this.props.handleSubmit(e,"deal"),window.location.hash=t},changeUserGroupRadio:function(e){this.state.delIcon||this.props.changeRadio(e,"userGroupAuth")},getContainer:function(){return document.getElementById("userGropuList")},render:function(){var e=this,t={display:"block",height:30,position:"relative",lineHeight:1.5},a=c.default.queryString("appId",window.location.href),i=c.default.queryString("timingPushType",window.location.href),s="/user/group/new",r=this.state.userTypeGroup.map(function(l,r){var u=l.permission,p=l.id,d=l.name,m={appId:a,id:p,pushType:e.state.pushType};i&&(m.timingPushType=i);var h=c.default.makeUrl(s,m),f={display:"inline-block"};return f.color=u?"#666":"#f00",n.default.createElement(o.Radio,{permission:u,expression:l.userGroupDesc,label:d,key:r,style:t,name:"userGroupId",value:String(p)},n.default.createElement("div",{style:f},!u&&n.default.createElement(o.Tooltip,{getTooltipContainer:e.getContainer,title:"该用户群有标签无权限"},n.default.createElement("i",{className:"fs14  fw_n cursor_p anticon anticon-info-circle-o permission_info"})),n.default.createElement("span",{className:"ellipsis",style:{width:450,display:"inline-block",verticalAlign:"top"},title:d},d)),n.default.createElement("div",{style:{textAlign:"right",position:"absolute",right:"-10px",display:"inline-block"}},n.default.createElement(o.Tooltip,{title:"编辑用户群"},n.default.createElement("i",{onClick:e.handleSubmit.bind(e,window.event,h),className:"i_edit"})),n.default.createElement(o.Tooltip,{title:"删除用户群"},n.default.createElement("i",{onClick:e.delUserGroup.bind(e,d,p),className:"i_del"}))))}),u=this.state.userTypeTags.map(function(t,a){return n.default.createElement("li",{title:t.tagName,className:e.state.tagIds[t.tagId]?"current":"",value:t.tagId,onClick:e.selectTags,key:a},c.default.getTextOverFlow(t.tagName,10,!0))}),p=e.state.pushType,d={appId:a,currentId:this.props.form.getFieldValue("userGroupId"),pushType:p},m=this.props.groupPush;m&&(d.groupPush=m),i&&(d.timingPushType=i);var h=c.default.makeUrl(s,d),y=this.state.tagIdsName,v=this.state.tagIdsValue,T=this.props.userType,I=c.default.queryString("id",window.location.href)||c.default.queryString("groupId",window.location.href);return n.default.createElement(g,l({},this.props.formItemLayout,{label:"指定用户    "}),n.default.createElement(f,this.props.getFieldProps("userType",{initialValue:T,onChange:this.changeRadio}),"group"===p?null:n.default.createElement(o.Radio,{name:"userType",value:0},"全部用户"),n.default.createElement(o.Radio,{name:"userType",value:1},"用户群"),this.props.personalPush?null:n.default.createElement(o.Radio,{name:"userType",value:2},n.default.createElement("span",null,"PushId")),this.props.personalPush?null:this.props.flymeAuth?n.default.createElement(o.Radio,{name:"userType",value:6},"IMEI"):null,this.props.personalPush||"group"===p?null:this.props.flymeAuth?n.default.createElement(o.Radio,{name:"userType",value:3},"Flyme账户"):null,this.props.personalPush?null:n.default.createElement(o.Radio,{name:"userType",value:4},"别名"),this.props.personalPush?null:n.default.createElement(o.Radio,{name:"userType",value:5},"标签")),1===T?n.default.createElement("div",{className:"user_type",id:"userGropuList"},r.length>0?n.default.createElement(g,null,n.default.createElement(f,l({value:this.props.form.getFieldValue("userGroupId"),className:"mb10",style:{width:"100%"}},this.props.getFieldProps("userGroupId",{initialValue:I,onChange:this.changeUserGroupRadio,validate:[{rules:[{required:!0,message:"请选择用户群"},{validator:function(e,t,a){"null"!==t&&"undefined"!==t||a(new Error("请选择用户群")),a()}}]}]})),r)):this.state.loadGroup?n.default.createElement("div",{className:"color_error"},"无用户群"):n.default.createElement("div",null,"数据拉取中..."),n.default.createElement(o.Button,{onClick:this.handleSubmit.bind(this,window.event,h),className:"color_bdc  ",type:"ghost",size:"large"},"添加群组")):null,2===T||3===T||4===T||6===T?this.getUserType():null,5===T?n.default.createElement("div",{className:"user_type",style:{width:600}},u.length>0?n.default.createElement("div",null,n.default.createElement(f,l({style:{width:"100%"}},this.props.getFieldProps("scope",{initialValue:this.props.scope,onChange:this.props.changeRadio})),n.default.createElement(o.Radio,{name:"scope",value:0},"并集"),n.default.createElement(o.Radio,{name:"scope",value:1},"交集")),n.default.createElement(g,null,n.default.createElement(o.Input,l({style:{width:300},disabled:!0,title:this.props.form.getFieldValue("tagIdsName"),placeholder:"选择标签"},this.props.getFieldProps("tagIdsName",{initialValue:y,rules:[{required:!0,message:"请选择标签"}]})))),n.default.createElement("div",{style:{display:"none "}},n.default.createElement(g,null,n.default.createElement(o.Input,l({hidden:!0,style:{width:300},placeholder:"选择标签"},this.props.getFieldProps("tagIds",{initialValue:v}))))),n.default.createElement("ul",{className:"tag_list"},u)):n.default.createElement("div",{className:"color_error"},"无标签")):null,n.default.createElement(o.Modal,{title:"系统提示",visible:e.state.visible,onOk:e.delOk,onCancel:e.delCancel},n.default.createElement("p",null,"删除用户群：",e.state.userGroupName,"?")))}});e.exports=T},904:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},r=a(600),n=i(r),o=a(783),u=a(902),p=i(u),d=o.Radio.Group,c=o.Form.Item,m=n.default.createClass({displayName:"AdvanceSetting",getInitialState:function(){return{display:"none",selectBlack:[],errorTips:"",startTimeStatus:"success",endTimeStatus:"success",noticeImgUrl:this.props.noticeImgUrl}},showAdvance:function(){this.props.showAdvance()},checkBoxChange:function(e){var t=e.target.checked,a=e.target.value;this.props.form.setFieldsValue(s({},a,t?1:0)),this.props.changeRadio(e)},changeStart:function(e){this.props.form.setFieldsValue({fixStartDisplayTime:e})},changeEnd:function(e){this.props.form.setFieldsValue({fixEndDisplayTime:e})},validateStartTime:function(e){var t=this,a=this.props.tableDataIndex;return this.props.getFieldProps(e,{initialValue:a&&a.advanceInfo.fixStartDisplayTime?new Date(a.advanceInfo.fixStartDisplayTime):this.props.form.getFieldValue("startTime")||new Date,onChange:function(e){var a=+new Date(e),i=t.props.form.getFieldValue("fixEndDisplayTime"),s="none",l="",r="success",n="success";a&&i&&a>i&&(l="结束时间不能早于开始时间",r="error",n="error",s=""),a||(l="请选择开始时间",s="",r="error"),i||(l="请选择结束时间",s="",n="error"),t.setState({startTimeStatus:r,endTimeStatus:n,display:s,errorTips:l})}})},validateEndTime:function(e){var t=this,a=this.props.tableDataIndex;return this.props.getFieldProps(e,{initialValue:a&&a.advanceInfo.fixEndDisplayTime?new Date(a.advanceInfo.fixEndDisplayTime):this.props.form.getFieldValue("startTime")||new Date,onChange:function(e){var a=+new Date(e),i=t.props.form.getFieldValue("fixStartDisplayTime"),s="none",l="",r="success",n="success";i&&a&&a<i&&(l="结束时间不能早于开始时间",r="error",n="error",s=""),i||(l="请选择开始时间",s="",r="error"),a||(l="请选择结束时间",s="",n="error"),t.setState({startTimeStatus:r,endTimeStatus:n,display:s,errorTips:l})}})},validateFixSpeedRate:function(e){var t=this,a=t.props.limitRate;return this.props.getFieldProps(e,{validate:[{rules:[{validator:function(e,t,i){t?t&&!String(t).match(/^[1-9]+[0-9]*$/)?i(new Error("请输入正整数")):t&&t>a?i(new Error("推送速率被设置为不能大于"+a)):i():i(new Error("请输入推送速率"))}}],trigger:["onBlur","onChange"]}]})},componentDidMount:function(){var e=this.props.tableDataIndex,t=[];e&&(t=e.advanceInfo.blackId,t=t.split(","),this.setState({selectBlack:t}))},changeBlack:function(e,t){var a=e.target.checked,i=this.state.selectBlack;a?i.push(e.target.name):i=i.filter(function(t){return t!==e.target.name}),this.setState({selectBlack:i});var s=this.props.blackList;s.map(function(a,i){i===t&&(s[i].choose=e.target.checked)}),this.props.changeBlack(s,t)},changeRadioBlack:function(e){var t=this.state.selectBlack,a=void 0;1!==t.length||t[0]||(a="black"),this.props.changeRadio(e,a)},render:function(){var e=this,t=this.props.blackList,a=this.state.selectBlack,i=t.map(function(t,i){var s=t.choose;if(a.length){s=!1;for(var r=0;r<a.length;r++){var u=a[r];u===String(t.blackId)&&(s=!0)}}return n.default.createElement(c,{className:"mg0",key:i},n.default.createElement("label",null,n.default.createElement(o.Checkbox,l({data:t,name:String(t.blackId),title:t.blackName,checked:s},e.props.getFieldProps("blackId"+t.blackId,{initialValue:s,onChange:function(t){e.changeBlack(t,i)}}))),t.blackName,n.default.createElement("span",{title:t.title,className:"pl10"},"数量：",t.blackNum)))});t.length||(i=n.default.createElement("span",{className:"color_error "},"无黑名单"));var s=this.props.vibrate,r=this.props.sound,u=this.props.lights,m=function(t){var a=e.props.form.getFieldValue("startTime"),i=Date.now();return a&&(i=a),t&&t.getTime()+864e5<=i};return n.default.createElement("div",null,!this.props.personalPush&&n.default.createElement(c,l({className:"border_top advance_toggle"},this.props.formItemLayout,{label:"高级设置   "}),n.default.createElement(o.Icon,{onClick:this.showAdvance,style:{fontSize:12,paddingTop:13},type:this.props.showAdvanceStatus?"cross":"down"})),n.default.createElement("div",{
style:{display:this.props.showAdvanceStatus?"":"none"}},!this.props.personalPush&&n.default.createElement(c,l({className:"black_notice"},this.props.formItemLayout,{label:n.default.createElement(p.default,{text:"定速推送　"})}),n.default.createElement(d,this.props.getFieldProps("fixSpeed",{initialValue:this.props.fixSpeed,onChange:this.props.changeRadio}),n.default.createElement(o.Radio,{name:"fixSpeed",value:0},"关闭"),n.default.createElement(o.Radio,{name:"fixSpeed",value:1},"开启")),1===this.props.fixSpeed||this.props.form.getFieldValue("fixSpeed")?n.default.createElement(c,{className:"fix_speed_rate"},n.default.createElement(o.Input,l({style:{width:100}},this.validateFixSpeedRate("fixSpeedRate"))),n.default.createElement("span",{className:"pl10"},"条/秒")):null),this.props.personalPush||"notice"!==this.props.type?null:n.default.createElement("div",null,n.default.createElement(c,l({className:"black_notice"},this.props.formItemLayout,{label:n.default.createElement(p.default,{text:"定时展示　"})}),n.default.createElement(d,this.props.getFieldProps("fixDisplay",{initialValue:this.props.fixDisplay,onChange:this.props.changeRadio}),n.default.createElement(o.Radio,{name:"fixDisplay",value:0},"关闭"),n.default.createElement(o.Radio,{name:"fixDisplay",value:1},"开启")),1===this.props.fixDisplay?n.default.createElement("div",null,n.default.createElement(c,{validateStatus:this.state.startTimeStatus,className:"display_ib va_t mg0"},n.default.createElement(o.DatePicker,l({disabledDate:m,onOk:this.changeStart,showTime:!0},this.validateStartTime("fixStartDisplayTime"),{placeholder:"开始时间",format:"yyyy-MM-dd HH:mm:ss"}))),n.default.createElement("span",{className:"pl10 pr10"},"至"),n.default.createElement(c,{validateStatus:this.state.endTimeStatus,className:"display_ib va_t mg0"},n.default.createElement(o.DatePicker,l({disabledDate:m},this.validateEndTime("fixEndDisplayTime"),{placeholder:"结束时间",onOk:this.changeEnd,showTime:!0,format:"yyyy-MM-dd HH:mm:ss"}))),n.default.createElement("span",{style:{display:this.state.display},className:"color_error pl10"},this.state.errorTips)):null),this.props.msgCacheStatus?n.default.createElement(c,l({},this.props.formItemLayout,{label:"消息缓存    "}),n.default.createElement(d,this.props.getFieldProps("msgCache",{initialValue:this.props.msgCache,onChange:this.props.changeRadio}),n.default.createElement(o.Radio,{name:"msgCache",value:0},"关闭"),n.default.createElement(o.Radio,{name:"msgCache",value:1},"开启"))):null,n.default.createElement(c,l({},this.props.formItemLayout,{label:"通知栏悬浮窗    "}),n.default.createElement(d,this.props.getFieldProps("suspend",{initialValue:this.props.suspend,onChange:this.props.changeRadio}),n.default.createElement(o.Radio,{name:"suspend",value:1},"显示"),n.default.createElement(o.Radio,{name:"suspend",value:0},"不显示"))),n.default.createElement(c,l({},this.props.formItemLayout,{label:"清除通知栏    "}),n.default.createElement(d,this.props.getFieldProps("clearNoticeBar",{initialValue:this.props.clearNoticeBar,onChange:this.props.changeRadio}),n.default.createElement(o.Radio,{name:"clearNoticeBar",value:1},"可清除"),n.default.createElement(o.Radio,{name:"clearNoticeBar",value:0},"不可清除"))),n.default.createElement(c,l({},this.props.formItemLayout,{label:"通知提醒类型    "}),n.default.createElement("label",{className:"mr10"},n.default.createElement(o.Checkbox,l({className:"mr10"},this.props.getFieldProps("vibrate",{value:s}),{value:"vibrate",onChange:this.checkBoxChange,checked:!!s})),"震动"),n.default.createElement("label",{className:"mr10"},n.default.createElement(o.Checkbox,l({className:"mr10"},this.props.getFieldProps("lights",{value:u}),{value:"lights",onChange:this.checkBoxChange,checked:!!u})),"闪灯"),n.default.createElement("label",null,n.default.createElement(o.Checkbox,l({className:"mr10"},this.props.getFieldProps("sound",{value:r}),{value:"sound",onChange:this.checkBoxChange,checked:!!r})),"声音"))),n.default.createElement(c,l({className:"black_notice"},this.props.formItemLayout,{label:n.default.createElement(p.default,{text:"推送黑名单　　"})}),n.default.createElement(d,this.props.getFieldProps("black",{initialValue:this.props.black,onChange:this.changeRadioBlack}),n.default.createElement(o.Radio,{name:"black",value:1},"使用"),n.default.createElement(o.Radio,{name:"black",value:0},"禁用"))),1===this.props.form.getFieldValue("black")&&n.default.createElement("div",{className:"user_type user_type_black"},i,n.default.createElement("span",{className:"color_error",style:{display:this.props.displayBlackList}},"请选择黑名单"))))}});e.exports=m},905:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=a(600),l=i(s),r=a(783),n=l.default.createClass({displayName:"BigimgArea",render:function(){var e=this.props.form.getFieldValue("noticeExpandImgUrl");return l.default.createElement(r.Row,null,l.default.createElement(r.Col,null,this.props.showBigImg?l.default.createElement("div",null,e?l.default.createElement("div",{className:"example_default_image example_big_image"},l.default.createElement("img",{width:"225",height:"144",src:e})):l.default.createElement("div",{className:"example_default_image example_big_image"},l.default.createElement("div",{className:"bg"}),l.default.createElement("div",{className:"text"},"此处为图片展示区域"))):null))}});e.exports=n},906:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=a(600),l=i(s),r=a(783),n=l.default.createClass({displayName:"BigimgArea",render:function(){return l.default.createElement(r.Row,null,l.default.createElement(r.Col,null,l.default.createElement("div",null,this.props.form.getFieldValue("noticeBarImgUrl")?l.default.createElement("div",{className:"example_default_image"},l.default.createElement("img",{width:"225",height:"44",src:this.props.form.getFieldValue("noticeBarImgUrl")})):l.default.createElement("div",{className:"example_default_image"},l.default.createElement("div",{className:"bg"}),l.default.createElement("div",{className:"text"},"此处为图片展示区域")))))}});e.exports=n},907:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},l=a(600),r=i(l),n=a(783),o=a(777),u=i(o),p=a(908),d=i(p),c=a(909),m=i(c),h={labelCol:{span:6},wrapperCol:{span:18}},f=r.default.createClass({displayName:"PushModal",getInitialState:function(){return{popoverVisible:!1}},componentDidMount:function(){document.querySelector("#prepush")&&(document.querySelector("#prepush").classList="prepush_position")},render:function(){var e=this.props.form.getFieldValue("startTime"),t=this.props.form.getFieldValue("noticeExpandType"),a="　";0===t&&(a="标准"),1===t&&(a=r.default.createElement("div",null,"文本",r.default.createElement("div",{className:"break_word lh15 mt5 mb5 pr40"},this.props.noticeExpandContent))),2===t&&(a=r.default.createElement("div",null,"大图",r.default.createElement("div",{className:"break_word lh15 mt5 mb5 pr40"},r.default.createElement("img",{width:"225",height:"144",src:window.bigImageFilePathJson.noticeExpandImgUrl||this.props.form.getFieldValue("noticeExpandImgUrl")})))),3===t&&(a="ACT文件");var i=this.props.form.getFieldValue("clickType"),l="　";0===i&&(l="打开应用"),1===i&&(l="打开应用页面"),2===i&&(l="打开URI页面"),3===i&&(l="应用客户端自定义");var o=this.props.form.getFieldValue("clickPackage"),p=this.props.form.getFieldValue("userType");2===p&&this.props.personalPush&&(p=6);var c="　";if(0===p&&(c="全部用户"),1===p){c="用户群";var f=this.props.userGroupName;f&&(c+="("+f+")")}2===p&&(c="PushId"),3===p&&(c="Flyme账户"),4===p&&(c="别名"),5===p&&(c="标签"),6===p&&(c="IMEI");var g="　",y=[],v="";if(this.props.requestData){var T=this.props.requestData.advanceInfo.notificationType,I=this.props.requestData.clickTypeInfo,b={},E=[];for(var S in T)T[S]&&("vibrate"===S&&E.push("震动"),"lights"===S&&E.push("闪灯"),"sound"===S&&E.push("声音"));if(g=E.join("+"),0===E.length&&(g="无"),I){if(b=I.parameters,1==i||2==i||3==i){var w=I.activity||I.url||I.customAttribute||"";1===i&&(w="页面地址："+w),y.push(r.default.createElement("div",{className:"break_word",key:w},w))}if(2!=i&&3!=i)for(var k in b)"undefined"!=k&&""!=k&&y.push(r.default.createElement("div",{key:k},r.default.createElement("p",null,"参数：",k.trim()),r.default.createElement("p",{className:"break_word"},"值：",String(b[k]).trim())))}v=document.getElementById("userName").innerHTML}var P=[];this.props.distinctTitle&&(P=this.props.distinctTitle.map(function(e,t){return r.default.createElement("div",{key:t},e)}));var N=this.props.form.getFieldValue("fixStartDisplayTime"),x=this.props.form.getFieldValue("fixEndDisplayTime");N=N?u.default.dateFormat("yyyy-MM-dd hh:mm:ss",N):null,x=x?u.default.dateFormat("yyyy-MM-dd hh:mm:ss",x):null;var F=x&&N?N+" 至 "+x:"",D="notice"===this.props.type?"推送通知":"透传消息",C=this.props.listSceneTag,V=this.props.cronWeek,R=this.props.form.getFieldValue("cronTime");R&&"object"===("undefined"==typeof R?"undefined":s(R))&&(R=u.default.dateFormat("hh:mm:ss",R));var B={formItemLayout:h,appName:this.props.appName,noticeBarType:this.props.form.getFieldValue("noticeBarType"),noticeBarImgUrl:window.smallImageFilePathJson.noticeBarImgUrl||this.props.form.getFieldValue("noticeBarImgUrl"),title:this.props.form.getFieldValue("title"),content:this.props.form.getFieldValue("content"),noticeExpandTypeText:a,clickTypeText:l,clickPackage:o,startTime:e,offLine:this.props.form.getFieldValue("offLine"),validTime:this.props.form.getFieldValue("validTime"),userTypeText:c,listSceneTag:C,distinct:this.props.form.getFieldValue("distinct"),fixSpeed:this.props.form.getFieldValue("fixSpeed"),fixSpeedRate:this.props.form.getFieldValue("fixSpeedRate"),fixDisplay:this.props.form.getFieldValue("fixDisplay"),fixDisplayTime:F,msgCache:this.props.form.getFieldValue("msgCache"),msgCacheStatus:this.props.msgCacheStatus,suspend:this.props.form.getFieldValue("suspend"),clearNoticeBar:this.props.form.getFieldValue("clearNoticeBar"),notificationTypeText:g,noticeImgUrl:this.props.noticeImgUrl,pushType:"notice"===this.props.type?0:1,clickTypeInfoText:y,userName:v,articleLength:this.props.form.getFieldValue("articleLength"),freshnessNew:this.props.form.getFieldValue("freshnessNew"),distinctTitle:P,tagIdsName:this.props.form.getFieldValue("tagIdsName"),userGroupDesc:1===p?this.props.userGroupDesc:null,scopeDesc:0==this.props.form.getFieldValue("scope")?"并集":"交集",black:this.props.form.getFieldValue("black"),blackList:this.props.blackList,cronTime:R,cronWeek:V,listMaterial:this.props.listMaterial,pushPercent:this.props.pushPercent},U=r.default.createElement(m.default,{submiting:this.props.submiting,handleOk:this.props.handleOk,type:this.props.type,personalPush:this.props.personalPush,requestData:this.props.requestData,handleCancel:this.props.handleCancel,visible:this.props.visible,pushReviewNumber:this.props.pushReviewNumber,popoverVisible:this.state.popoverVisible});return r.default.createElement(n.Modal,{footer:U,width:700,onCancel:this.props.handleCancel,title:D,visible:this.props.visible},r.default.createElement(d.default,{pushDetailData:B,personalPush:this.props.personalPush}))}});e.exports=f},909:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=a(600),r=i(l),n=a(783),o=a(776),u=i(o),p=a(777),d=i(p),c=a(785),m=i(c),h=r.default.createClass({displayName:"Distinct",getInitialState:function(){var e=window.location.href,t=e.split("#"),a=d.default.queryString("pushType",t[1]);return{pushType:a,values:null,popoverVisible:!1}},handleSave:function(){var e=this.state.pushType,t=this;if(this.props.visible)return"timing"===e?void this.props.handleOk():void this.props.handleSubmit(null,"group",function(e){t.props.setTableData(e)})},handleVisibleChange:function(e){var t=this;this.props.groupPush?this.props.handleSubmit(null,"group",function(a){var i=t.props.addPushData;a.pushTimeInfo=i.pushTimeInfo,a.userTypeInfo=i.userTypeInfo,t.setState({values:a,popoverVisible:e})}):t.setState({popoverVisible:e})},pushReview:function(){var e=document.querySelector("#pushId"+this.props.type).value,t=this.props.requestData,a="notice"===this.props.type?0:1;if(t.pushId=e.replace(/^\s+/,"").replace(/\s+$/,""),!t.pushId)return n.message.error("请输入PushId");var i={};1===a&&(i={appId:t.appId,pushId:t.pushId,title:t.title,content:t.content,pushTimeInfo:{offLine:t.pushTimeInfo.offLine,validTime:t.pushTimeInfo.validTime}},t=i);var s={pushType:a,appId:t.appId,json:JSON.stringify(t)};m.default.post(u.default.pushReview,s,function(){n.message.success("预推成功")})},render:function(){var e,t,a,i=this.state.pushType,l=r.default.createElement("div",null,r.default.createElement(n.Row,{style:{height:36,lineHeight:"33px"}},r.default.createElement(n.Col,{className:"mr10 fs16",span:"5"},"预推测试"),r.default.createElement(n.Col,{className:"mr10",span:"11"},r.default.createElement(n.Input,{id:"pushId"+this.props.type,placeholder:"输入PushId"})),r.default.createElement(n.Col,{span:"6"},r.default.createElement(n.Button,{className:"w_80",type:"primary",onClick:this.pushReview,size:"large"},"预推"))));return r.default.createElement("div",{style:{textAlign:"center"}},this.props.groupPush||this.props.personalPush?null:r.default.createElement("p",{key:"p",className:"push_review_num"},"预计推送人数",r.default.createElement("span",{className:"num"},this.props.pushReviewNumber)),this.props.personalPush?null:r.default.createElement(n.Popover,(e={overlayClassName:"prepush_position",key:"popover",placement:"topLeft"},s(e,"key","test"),s(e,"content",l),s(e,"trigger","click"),s(e,"visible",this.state.popoverVisible),s(e,"onVisibleChange",this.handleVisibleChange),e),r.default.createElement(n.Button,{type:"ghost",className:"color_bdc",size:"large"},"预推测试")),this.props.groupPush||"timing"===i?r.default.createElement(n.Button,(t={key:"button"},s(t,"key","submit"),s(t,"type","primary"),s(t,"size","large"),s(t,"style",{marginLeft:8}),s(t,"onClick",this.handleSave),t),"保存",this.props.submiting?r.default.createElement(n.Icon,{type:"loading"}):r.default.createElement("span",null)):r.default.createElement(n.Button,(a={key:"button"},s(a,"key","submit"),s(a,"type","primary"),s(a,"size","large"),s(a,"style",{marginLeft:8}),s(a,"onClick",this.props.handleOk),a),"推送",this.props.submiting?r.default.createElement(n.Icon,{type:"loading"}):r.default.createElement("span",null)))}});e.exports=h},910:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},l=a(600),r=i(l),n=a(783),o=a(776),u=i(o),p=a(777),d=i(p),c=a(785),m=i(c),h=n.Radio.Group,f=n.Form.Item,g=r.default.createClass({displayName:"Distinct",getInitialState:function(){return{listData:[],distinctId:{}}},changeRadio:function(e){var t=e.target.value;1===t?this.listEffectivePushTask():this.setState({distinctId:{}}),this.props.changeRadio(e)},changeCheckbox:function(e){var t=this.state.distinctId,a=this.state.listData,i=e.target.checked,s=e.target.name;t[s]=!!i,this.setState({distinctId:t});var l=[],r=[];for(var n in t)if(t[n]){l.push(n);for(var o in a)n==a[o].id&&r.push(n+"  "+a[o].title)}this.setState({displayDistinct:l.length>0?"none":""}),this.props.changeCheckbox(l,r)},componentWillReceiveProps:function(){var e=d.default.queryString("deal",window.location.href),t=d.default.queryString("appId",window.location.href);(this.props.appId&&t!==this.props.appId||e&&1===this.props.distinct&&t!==this.props.appId)&&this.listEffectivePushTask()},componentDidMount:function(){var e=this,t=this.props.copyTaskId,a="";t&&this.listEffectivePushTask(t,function(t){for(var i={},s=[],l=0;l<t.length;l++)if(t[l].choose){var r=t[l].id;i["distinctId"+r]=r,i.displayDistinct="none",s.push(r)}e.props.form.setFieldsValue(i),e.props.changeCheckbox(s,a)})},listEffectivePushTask:function(e,t){var a=d.default.queryString("appId",window.location.href),i=this,s=u.default.listEffectivePushTask,l={appId:a,pushType:"notice"===this.props.pushType?0:1};e&&(l.copyTaskId=e),s=d.default.makeUrl(s,l),m.default.get(s,function(e){var a=e.value,s=[],l=[];a.map(function(e){e.choose?s.push(e):l.push(e)});var r=s.concat(l);i.setState({listData:r,loaded:!0}),t&&t(a)})},render:function(){var e=this,t=this.state.listData,a=t.map(function(t,a){var i=e.props.form.getFieldValue("distinctId"+t.id);return r.default.createElement(f,{className:"mg0",key:a},r.default.createElement("label",null,r.default.createElement(n.Checkbox,s({name:String(t.id),title:t.title,checked:!!i},e.props.getFieldProps("distinctId"+t.id,{onChange:e.changeCheckbox}))),t.id,r.default.createElement("span",{title:t.title,className:"distinct_title pl10"},t.title)))});return 0===t.length&&this.state.loaded&&(a=r.default.createElement("span",{className:"color_error"},"无去重列表 ")),r.default.createElement(f,s({},this.props.formItemLayout,{label:"消息去重    "}),r.default.createElement(h,this.props.getFieldProps("distinct",{initialValue:this.props.distinct,onChange:this.changeRadio}),r.default.createElement(n.Radio,{name:"distinct",value:0},"无"),r.default.createElement(n.Radio,{name:"distinct",value:1},"去重")),1===this.props.distinct?r.default.createElement("div",{className:"user_type user_type_distinct"},a,r.default.createElement("span",{className:"color_error",style:{display:this.state.displayDistinct||this.props.displayDistinct}},"请选择去重任务")):null)}});e.exports=g},911:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},l=a(600),r=i(l),n=a(783),o=a(777),u=i(o),p=a(912),d=i(p),c=n.Radio.Group,m=n.Form.Item;window._noticeExpandContent="";var h=r.default.createClass({displayName:"Distinct",getInitialState:function(){return{listData:[],distinctId:{}}},componentWillMount:function(){var e=u.default.queryString("deal",window.location.href);e&&!this.props.addPush||(window._noticeExpandContent="")},validateNoticeExpandContent:function(e){var t=this.props.form.getFieldProps;return t(e,{initialValue:window._noticeExpandContent,validate:[{rules:[{required:!0,message:"请输入展开文本"},{max:100,message:"展开文本不能超过100个字"},{validator:function(e,t,a){t&&t.length<=100&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}],onBlur:function(e){window._noticeExpandContent=e.target.value}})},render:function(){var e=this.props.formItemLayout,t=this.props.form.getFieldProps;return r.default.createElement("div",null,r.default.createElement(m,s({},e,{label:"展开方式    "}),r.default.createElement(c,t("noticeExpandType",{initialValue:this.props.form.getFieldValue("noticeExpandType"),onChange:this.props.changeRadio}),r.default.createElement(n.Radio,{name:"noticeExpandType",value:0},"标准"),0===this.props.noticeBarType||2===this.props.noticeBarType?r.default.createElement(n.Radio,{name:"noticeExpandType",value:1},"文本"):null,r.default.createElement(n.Radio,{name:"noticeExpandType",value:2},"大图"),!this.props.flymeAuth||0!==this.props.noticeBarType&&2!==this.props.noticeBarType?null:r.default.createElement(n.Radio,{name:"noticeExpandType",value:3},"ACT文件")),r.default.createElement(d.default,{type:"noticeExpandType",form:this.props.form,bigImageDisplay:this.props.bigImageDisplay,url:"noticeExpandImgUrl",value:2}),r.default.createElement(d.default,{type:"noticeExpandType",form:this.props.form,vedioDisplay:this.props.vedioDisplay,url:"vedioUrl",value:3})),1!==this.props.form.getFieldValue("noticeExpandType")||0!==this.props.form.getFieldValue("noticeBarType")&&2!==this.props.form.getFieldValue("noticeBarType")?null:r.default.createElement(m,s({},e,{label:" "}),r.default.createElement(n.Input,s({placeholder:"请输入展开文本",style:{width:400}},this.validateNoticeExpandContent("noticeExpandContent"),{type:"textarea"}))))}});e.exports=h},912:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},r=a(600),n=i(r),o=a(783),u=a(776),p=i(u),d=a(777),c=i(d),m=o.Radio.Group,h=o.Form.Item,f={labelCol:{span:4},wrapperCol:{span:20}},g=n.default.createClass({displayName:"Distinct",getInitialState:function(){return{listData:[],distinctId:{}}},uploadParam:function(e){var t=this,a="imgFile",i="noticeBarImgUrl"===e?0:1,l="noticeBarImgUrl"===e?"smallImage":"bigImage",r="noticeBarImgUrl"===e?100:200,n="图片",u=l+"Display",d=p.default.uploadImg,m=!1,h=".jpg,.jpeg,.png,.bmp";"vedioUrl"===e&&(l="vedio",a=l+"File",u=l+"Display",d=p.default.uploadVedio,r=1024,n="视频",m=!0,h=".act");var f={appId:c.default.queryString("appId",window.location.href)};"vedioUrl"!==e&&(f.imgType=i),d=c.default.makeUrl(d,f);var g={name:a,data:{},accept:h,action:d,showUploadList:m,beforeUpload:function(a){var i={};i[e+"loading"]=!0;var s=a.name,l=s.split(".");if(l=l[l.length-1],a.size>1024*r)return r="vedioUrl"===e?"1M":r+"K",o.message.error(n+"大小不能超过"+r),t.setState({loading:!1}),!1;var u="vedioUrl"===e?l.indexOf("act")>=0:l.indexOf("jpg")>=0||l.indexOf("jpeg")>=0||l.indexOf("png")>=0||l.indexOf("bmp")>=0;return u||(o.message.error("请上传"+h+"后缀格式的文件"),i[e+"loading"]=!1),t.setState(i),u},onChange:function(a){if("removed"===a.file.status)return void(a.fileList.length<1&&(t.props.form.setFieldsValue({vedioUrl:void 0}),window[l+"FilePathJson"]={}));if(a.file.response){var i={};"200"===a.file.response.code?(a.fileList.length>1&&a.fileList.shift(),i[e]="vedioUrl"===e?a.file.response.value:a.file.response.value.imgUrl,o.message.success(a.file.name+" 上传成功。"),t.props.form.setFieldsValue(i),t.setState(s({vedioDisplay:"none",layerDisplay:"none"},u,"none"))):(a.fileList.pop(),o.message.error(a.file.response.message)),i[e+"loading"]=!1,window[l+"FilePathJson"]=i,t.setState(i)}}},y=window[l+"FilePathJson"][e]||this.props.form.getFieldValue(e);if("vedioUrl"===e&&y){var v=y.split("/");v=v[v.length-1],g.defaultFileList=[{name:v,url:"javascript:;",uid:-1,status:"done"}]}return g},closeImg:function(e,t){var a={};a[e]=null,a[t+"layerDisplay"]="none",this.props.form.setFieldsValue(a);var i="noticeBarImgUrl"===e?"smallImage":"bigImage";"vedioUrl"===e&&(i="vedio"),window[i+"FilePathJson"][e]=null,this.setState(a)},imgOver:function(e){var t={};t[e+"layerDisplay"]="",this.setState(t)},componentDidMount:function(){window.vedioFilePathJson={}},eventPre:function(e){e.stopPropagation()},imgOut:function(e){var t={};t[e+"layerDisplay"]="none",this.setState(t)},uploadVedio:function(){var e="vedioUrl",t=this.props.form.getFieldProps;return 3===this.props.form.getFieldValue("noticeExpandType")?n.default.createElement("div",{className:"user_type notice_expand"},n.default.createElement(o.Upload,l({},t("vedioUrl",{initialValue:window.vedioFilePathJson[e]}),{style:{width:200}},this.uploadParam(e)),n.default.createElement(o.Button,{size:"large",className:"btn_normal_show ",type:"ghost"},"ACT文件上传",this.state.loading?n.default.createElement(o.Icon,{type:"loading"}):n.default.createElement("span",null))),n.default.createElement("span",{className:"upload_tips vedio_upload_tips"},"请上传1M以内的ACT文件",n.default.createElement("span",{style:{display:this.state.vedioDisplay||this.props.vedioDisplay},className:"pl10 color_error"},"请上传ACT文件")),n.default.createElement(h,l({},f,{label:"下载条件    "}),n.default.createElement(m,t("onlyWifi",{initialValue:this.props.form.getFieldValue("onlyWifi")?1:0}),n.default.createElement(o.Radio,{name:"noticeBarType",value:1},"仅WIFI"),n.default.createElement(o.Radio,{name:"noticeBarType",value:0},"不限")))):null},render:function(){var e=this.props.url,t=this.props.type,a=this.props.value,i="noticeBarImgUrl"===e?"smallImage":"bigImage";"vedioUrl"===e&&(i="vedio");var s={size:"small",height:70,uploadDom:n.default.createElement("div",{className:"upload_area"},n.default.createElement(o.Upload,this.uploadParam(e),n.default.createElement(o.Button,{type:"primary",size:"large"},"添加图片",this.state[e+"loading"]?n.default.createElement(o.Icon,{type:"loading"}):n.default.createElement("span",null))),n.default.createElement("p",{className:"tips"},"推荐尺寸525*100，100KB以内",n.default.createElement("span",{style:{display:this.props.smallImageDisplay},className:"pl10 color_error"},"请上传图片")))};2===a&&(s.size="big",s.height=182,s.uploadDom=n.default.createElement("div",{className:"upload_area upload_area_big"},n.default.createElement(o.Upload,this.uploadParam(e),n.default.createElement(o.Button,{type:"primary",size:"large"},"添加图片",this.state[e+"loading"]?n.default.createElement(o.Icon,{type:"loading"}):n.default.createElement("span",null)),n.default.createElement("p",{style:{display:this.props.bigImageDisplay},className:"pl10 color_error"},"请上传图片")),n.default.createElement("p",null,"Flyme5推荐尺寸700*400，200KB以内"),n.default.createElement("p",null,"Flyme6推荐尺寸262*95，200KB以内")));var r=this.props.form.getFieldValue(t)===a?n.default.createElement("div",null,n.default.createElement(h,null,n.default.createElement("div",{className:"upload_img"},n.default.createElement("div",{className:""},window[i+"FilePathJson"][e]||this.props.form.getFieldValue(e)?n.default.createElement("div",{className:s.size+"_img"},n.default.createElement("img",{onMouseOver:this.imgOver.bind(this,s.size),width:"300",height:s.height,src:window[i+"FilePathJson"][e]||this.props.form.getFieldValue(e)}),n.default.createElement("div",{onMouseOver:this.eventPre,onMouseOut:this.imgOut.bind(this,s.size),style:{display:this.state[s.size+"layerDisplay"]},className:"close_img"},n.default.createElement(o.Upload,l({className:s.size+"_img_btn"},this.uploadParam(e)),n.default.createElement(o.Button,{onMouseOut:this.eventPre,onMouseOver:this.imgOver.bind(this,s.size),type:"primary",size:"large"},"更换图片",this.state[e+"loading"]?n.default.createElement(o.Icon,{type:"loading"}):n.default.createElement("span",null))),n.default.createElement("div",{className:"close_icon",onMouseOut:this.eventPre,onMouseOver:this.imgOver.bind(this,s.size)},n.default.createElement(o.Icon,{onClick:this.closeImg.bind(this,e,s.size),type:"cross-circle"})))):s.uploadDom)))):null;return"noticeExpandType"===t&&3===a&&(r=this.uploadVedio()),r}});g=o.Form.create()(g),e.exports=g},913:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=a(600),n=i(r),o=a(783),u=a(800),p=i(u),d=a(776),c=i(d),m=a(785),h=i(m),f=a(777),g=i(f),y=a(899),v=i(y),T=a(900),I=i(T),b=a(903),E=i(b),S=a(904),w=i(S),k=a(907),P=i(k),N=a(910),x=i(N),F=a(909),D=i(F),C=a(801),V=i(C),R=o.Form.Item,B=null,U=null,_=V.default.createActions(["message"]),A=V.default.createStore({listenables:[_],jsonData:null}),G={labelCol:{span:4},wrapperCol:{span:20}},q=n.default.createClass({displayName:"AddAppTask",getInitialState:function(){return{offLine:1,cronWeek:[1],distinctId:[],displayDistinct:"none",displayBlackList:"none",noticeBarType:0,noticeExpandType:0,clickType:0,userType:2,scope:0,visible:!1,pushReviewNumber:"...",distinct:0,blackList:[],fixSpeed:0,netType:0,fixDisplay:0,pushTimeType:0,distinctTitle:[]}},delParams:function(e,t){for(var a in t)delete e[a]},clearUserGroup:function(e,t){if(e==t){var a={};a.userGroupName=null,a.userGroupDesc=null,B=null,U=null,this.setState(a),this.props.form.setFieldsValue({userGroupId:null})}},changeRadio:function(e,t){var a={};"userGroupAuth"===t&&(a.permission=e.target.permission),"black"===t&&(a.displayBlackList="");var i=e.target.name,s=e.target.value;a[i]=s,"userGroupId"===i&&(a.userGroupName=e.target.label,a.userGroupDesc=e.target.expression,B=e.target.label,U=e.target.expression),"distinct"==i&&0==s&&(a.distinctTitle=[]),this.setState(a),this.props.form.setFieldsValue(a)},getAppName:function(e){var t="全部应用",a=p.default.allApp;if(a)for(var i=0;i<a.length;i++)a[i].appId==e&&(t=a[i].name);this.setState({appName:t})},componentWillReceiveProps:function(){var e=g.default.queryString("appId",window.location.href);this.state.appId&&e!==this.state.appId&&(this.getAppName(e),this.setState({pushReviewNumber:"...",appId:e}),this.getAppInfo(),this.getBlackList())},changeCheckbox:function(e,t){this.setState({distinctId:e,distinctTitle:t})},changeBlack:function(e){var t={blackList:e},a=e.filter(function(e){return e.choose});a.length?t.displayBlackList="none":t.displayBlackList="",this.setState(t)},handleOk:function(){var e=this,t=window.location.href,a=t.split("#"),i=g.default.queryString("pushType",a[1]),s=g.default.queryString("appId",window.location.href),l={appId:s,json:JSON.stringify(this.state.requestData)},r=this.state.pushReviewNumber;if("0"===r)return void o.message.error("预计推送人数为0，不可以创建推送任务");if(!this.state.submiting){this.setState({submiting:!0});var n=c.default.addNews,u="/data/push/record?appId="+s;"timing"===i&&(n=c.default.cronTaskAddNews,u="/data/push/timing?appId="+s),h.default.post(n,l,function(){o.message.success("提交成功"),window.location.hash=u},function(){e.setState({submiting:!1})})}},selectCronWeek:function(e){this.setState({cronWeek:e})},handleSubmit:function(e,a,i){var s=this,r=this;"deal"===a&&this.setState({jumpUserGroup:!0});var n=window.location.href,u=n.split("#"),p=g.default.queryString("pushType",u[1]);return this.state.permission===!1&&"deal"!==a&&1===this.props.form.getFieldValue("userType")&&this.props.form.getFieldValue("userGroupId")?void o.message.error("用户群标签没权限"):void this.props.form.validateFields(function(e,n){var o=n.userType;if("deal"===a)return n.showAdvanceStatus=r.state.showAdvanceStatus,A.jsonData=n,void(t.jsonData=n);var u=r.state.distinctId;if(n.distinct&&0===u.length)return void r.setState({displayDistinct:""});for(var d in n)d.indexOf("distinctId")>-1&&delete n[d];if(u&&(n.distinctId=u.join(",")),!n.distinct||u){var m=[];for(var f in n)if(f.indexOf("blackId")>-1&&n[f]){var y=f.split("blackId")[1];m.push(y),delete n[f]}if(n.blackId=m.join(","),(5!==n.userType||n.tagIds)&&(1!==o||n.userGroupId&&"null"!==n.userGroupId)){if(n.target=n["target"+o],n.userFilePath=n["userFilePath"+o],delete n["userFilePath"+o],""===n.target&&delete n.target,n.userFilePath&&delete n.target,e)return void console.log("Errors in form!!!");if(n.content=n.content,n.pushTimeInfo={pushTimeType:n.pushTimeType,startTime:n.startTime&&g.default.dateFormat("yyyy-MM-dd hh:mm:ss",n.startTime),offLine:n.offLine,validTime:n.validTime},r.delParams(n,n.pushTimeInfo),n.groupPushScope=n.scope,n.userGroupName=r.state.userGroupName,n.userTypeInfo={userType:n.userType,userGroupId:n.userGroupId,target:n.target,tagIds:n.tagIds,scope:n.scope,userFilePath:n.userFilePath},r.delParams(n,n.userTypeInfo),"timing"===p){var v=n.cronTime;"object"===("undefined"==typeof v?"undefined":l(v))&&(v=g.default.dateFormat("hh:mm:ss",v));var T=s.state.cronWeek;n.cronTimeInfo={time:v,week:T.join(",")},delete n.cronTime,r.delParams(n,n.cronTimeInfo)}if(n.advanceInfo={distinct:n.distinct,distinctId:n.distinctId,fixSpeed:n.fixSpeed,blackId:n.blackId,black:n.black,fixSpeedRate:n.fixSpeedRate},r.delParams(n,n.advanceInfo),n.advanceInfo.black&&""===n.advanceInfo.blackId)return void r.setState({showAdvanceStatus:!0});var I="notice"===r.props.pushType?0:1,b=g.default.queryString("appId",window.location.href);n.appId=b,r.setState({requestData:n,visible:"group"!==a});var E={appId:b,userTypeInfo:n.userTypeInfo},S=c.default.getPushCount;S=g.default.makeUrl(S,{appId:b,pushType:I,json:JSON.stringify(E)
}),r.setState({pushReviewNumber:"..."}),"group"!==a&&h.default.get(S,function(e){r.setState({pushReviewNumber:e.value})},null,{timeout:3e5}),i&&"function"==typeof i&&i(n)}}})},handleCancel:function(){this.setState({visible:!1,submiting:!1})},componentWillMount:function(){var e=this,t=g.default.queryString("appId",window.location.href),a=g.default.queryString("deal",window.location.href),i=g.default.queryString("id",window.location.href),s=g.default.queryString("groupId",window.location.href);(a||s)&&this.setState({userType:1,userGroupId:i}),t&&e.props.form.setFieldsValue({appId:t})},cantNull:function(e){var t=this.props.form.getFieldProps;return t(e,{rules:[{required:!0,message:"不能为空"}]})},validateTitle:function(e){var t=this.props.form.getFieldProps;return t(e,{rules:[{required:!0,message:"请输入标题"},{max:32,message:"标题内容不能超过32个字"},{validator:function(e,t,a){t&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}]})},validateContent:function(e){var t=this.props.form.getFieldProps,a=2e3;return t(e,{validate:[{rules:[{required:!0,message:"请输入消息内容"},{max:a,message:"消息内容不能超过"+a+"个字"},{validator:function(e,t,i){if(t&&t.length<=a){try{JSON.parse(t)}catch(e){i(new Error("请输入JSON格式"))}Number(t)==t&&"number"==typeof Number(t)&&i(new Error("请输入JSON格式"))}t&&t.length<=a&&t.match(/^\s/)&&i(new Error("行首不能输入空格")),i()}}],trigger:["onBlur","onChange"]}]})},selectType:function(e,t){this.setState({appName:t,appId:e}),this.props.form.setFieldsValue({appId:String(e)});var a=window.location.hash,i=g.default.getQueryObj(a);i.appId=e;var s=a.split("?")[0],l=g.default.makeUrl(s,i);window.location.href=window.location.pathname+l},getAppInfo:function(){var e=this,t=g.default.queryString("appId",window.location.href);h.default.get(c.default.getAppInfo+"?appId="+t,function(t){e.props.form.setFieldsValue({noticeImgUrl:t.value.appIconUrl,appName:t.value.appName}),e.setState({flymeAuth:t.value.flymeAuth,appName:t.value.appName,limitRate:t.value.limitRate})})},componentWillUnmount:function(){document.querySelector("#createPush")&&(document.querySelector("#createPush").className="")},setUserTypeGroup:function(e){e=e.items;for(var t=e.length,a=g.default.queryString("id",window.location.href),i=0;i<t;i++)a==e[i].id&&(this.setState({userGroupName:e[i].name}),B=e[i].name,U=e[i].userGroupDesc)},getBlackList:function(){var e=this,t=g.default.queryString("appId",window.location.href),a=g.default.queryString("taskId",window.location.href),i=c.default.pushTaskListBlack,s={appId:t};a&&(s.copyTaskId=a),h.default.post(i,s,function(t){var a=t.value,i={blackList:a};a.length?i.black=1:i.black=0,e.setState(i)})},componentDidMount:function(){var e=this;document.querySelector("#createPush")&&(document.querySelector("#createPush").className="active");var t=g.default.queryString("appId",window.location.href);this.setState({appId:t}),this.getBlackList();var a=g.default.queryString("deal",window.location.href),i=g.default.queryString("id",window.location.href),s=g.default.queryString("groupId",window.location.href);if(a&&A.jsonData&&!this.props.addPush?(this.setState({userType:1,userGroupId:i}),A.jsonData.userType=1,A.jsonData.userGroupId=i,e.setState(A.jsonData),e.props.form.setFieldsValue(A.jsonData)):e.props.form.setFieldsValue(this.state),s){var l={userType:1,userGroupId:s};this.setState(l),e.props.form.setFieldsValue(l)}this.getAppInfo();var r=g.default.queryString("taskId",window.location.href);if(r){var n=c.default.pushTaskCopy;n=g.default.makeUrl(n,{taskId:r,appId:t}),h.default.get(n,function(t){e.fillFormData(t)})}var o=this.props.tableDataIndex;o&&this.fillFormData({value:o})},fillFormData:function(e){var t=g.default.queryString("copyTaskId",window.location.href),a=e.value,i={title:a.title,content:a.content,fixSpeed:a.advanceInfo.fixSpeed?1:0,fixSpeedRate:a.advanceInfo.fixSpeedRate,black:a.advanceInfo.black?1:0,validTime:a.pushTimeInfo&&a.pushTimeInfo.validTime,offLine:a.pushTimeInfo&&a.pushTimeInfo.offLine?1:0,distinct:t?1:a.advanceInfo.distinct?1:0},s=this.props.tableDataIndex;if(s&&a.userTypeInfo){var l=a.userTypeInfo.userType;i.userType=l,i.userGroupId=a.userTypeInfo.userGroupId,i["target"+l]=a.userTypeInfo.target||a.userFileName,i.tagIds=a.userTypeInfo.tagIds,i.scope=a.userTypeInfo.scope,i["userFilePath"+l]=a.userTypeInfo.userFilePath}this.props.form.setFieldsValue(i),this.setState({offLine:a.pushTimeInfo&&a.pushTimeInfo.offLine?1:0}),this.showAdvance()},showAdvance:function(){this.setState({showAdvanceStatus:!this.state.showAdvanceStatus})},onChangePushTime:function(e){var t=this.props.form.getFieldValue("fixEndDisplayTime"),a=this.props.form.getFieldValue("fixStartDisplayTime"),i=e>a?e:a,s=e>t?e:t;this.props.form.setFieldsValue({startTime:e,fixEndDisplayTime:s||e,fixStartDisplayTime:i||e})},render:function(){var e=this.props.form.getFieldProps,t=g.default.queryString("copyTaskId",window.location.href);return n.default.createElement(o.Form,{horizontal:!0,id:"detailTable"},n.default.createElement(o.Row,null,n.default.createElement(o.Col,{span:this.props.groupPush?24:15,className:"col_left"},n.default.createElement(R,s({},G,{label:"标题    "}),n.default.createElement(o.Input,s({style:{width:400},placeholder:"用于后续查找识别"},this.validateTitle("title")))),n.default.createElement(R,s({},G,{label:"消息内容    "}),n.default.createElement(o.Input,s({rows:"9",style:{width:400},placeholder:"请输入透传消息的JSON格式命令代码",type:"textarea"},this.validateContent("content")))),this.props.groupPush?null:n.default.createElement("div",null,n.default.createElement(I.default,{formItemLayout:G,getFieldProps:e,jumpUserGroup:this.state.jumpUserGroup,selectCronWeek:this.selectCronWeek,form:this.props.form,onChangePushTime:this.onChangePushTime,pushTimeType:this.props.form.getFieldValue("pushTimeType"),changeRadio:this.changeRadio}),n.default.createElement(v.default,{form:this.props.form,offLine:this.state.offLine,formItemLayout:G,getFieldProps:e})),this.props.groupType||!this.props.groupPush?n.default.createElement(E.default,{form:this.props.form,formItemLayout:G,getFieldProps:e,scope:this.state.scope,tableDataIndex:this.props.tableDataIndex,groupPush:!!this.props.groupType,clearUserGroup:this.clearUserGroup,setUserTypeGroup:this.setUserTypeGroup,handleSubmit:this.handleSubmit,flymeAuth:this.state.flymeAuth,appId:g.default.queryString("appId",window.location.href),userType:this.props.form.getFieldValue("userType"),userGroupId:this.state.userGroupId,type:this.props.pushType,changeRadio:this.changeRadio}):null,this.props.groupPush?null:n.default.createElement(x.default,{form:this.props.form,formItemLayout:G,appId:g.default.queryString("appId",window.location.href),getFieldProps:e,copyTaskId:t,displayDistinct:this.state.displayDistinct,changeCheckbox:this.changeCheckbox,distinct:this.props.form.getFieldValue("distinct"),pushType:this.props.pushType,changeRadio:this.changeRadio}),n.default.createElement(w.default,{form:this.props.form,formItemLayout:G,showAdvanceStatus:this.state.showAdvanceStatus,showAdvance:this.showAdvance,getFieldProps:e,limitRate:this.state.limitRate,blackList:this.state.blackList,black:this.state.black,tableDataIndex:this.props.tableDataIndex,changeBlack:this.changeBlack,displayBlackList:this.state.displayBlackList,userType:this.state.userType,fixSpeed:this.state.fixSpeed,fixDisplay:this.state.fixDisplay,netType:this.state.netType,noticeImgUrl:this.state.noticeImgUrl,changeRadio:this.changeRadio,type:this.props.pushType}))),n.default.createElement(o.Row,{className:"push_btn"},n.default.createElement(o.Col,{span:"14"},this.props.groupPush?null:n.default.createElement(R,{label:""},n.default.createElement(o.Button,{type:"primary",onClick:this.handleSubmit,size:"large"},"推送")))),this.props.groupPush?n.default.createElement(o.Row,null,n.default.createElement(o.Col,null,n.default.createElement(D.default,{submiting:this.props.submiting,handleOk:this.props.handleOk,type:this.props.pushType,groupPush:this.props.groupPush,form:this.props.form,setTableData:this.props.setTableData,handleSubmit:this.handleSubmit,addPushData:this.props.addPushData,requestData:this.state.requestData,handleCancel:this.props.handleCancel,visible:this.props.visible,pushReviewNumber:this.state.pushReviewNumber,popoverVisible:this.state.popoverVisible}))):null,n.default.createElement(P.default,{form:this.props.form,requestData:this.state.requestData,visible:this.state.visible,cronWeek:this.state.cronWeek,appName:this.state.appName,userGroupName:B||this.state.userGroupName,userGroupDesc:U||this.state.userGroupDesc,handleOk:this.handleOk,type:this.props.pushType,blackList:this.state.blackList,submiting:this.state.submiting,distinctTitle:this.state.distinctTitle,handleCancel:this.handleCancel,pushReviewNumber:this.state.pushReviewNumber}))}});q=o.Form.create()(q),e.exports=q},914:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}function s(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var l=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var i in a)Object.prototype.hasOwnProperty.call(a,i)&&(e[i]=a[i])}return e},r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n=a(600),o=i(n),u=a(783),p=a(800),d=i(p),c=a(776),m=i(c),h=a(785),f=i(h),g=a(777),y=i(g),v=a(899),T=i(v),I=a(900),b=i(I),E=a(903),S=i(E),w=a(915),k=i(w),P=a(801),N=i(P),x=u.Radio.Group,F=u.Form.Item,D=null;window.vedioFilePathJson={};var C={},V=N.default.createActions(["notice"]),R=N.default.createStore({listenables:[V],jsonData:null}),B={labelCol:{span:3},wrapperCol:{span:21}},U=o.default.createClass({displayName:"AddAppTask",getInitialState:function(){return{tableData:[],dataSource:[],pushType:0,groupType:0,offLine:1,onlyWifi:1,distinctId:[],clickTypeParamsApp:[1],clickTypeParamsAppPage:[1],displayDistinct:"none",smallImageDisplay:"none",vedioDisplay:"none",bigImageDisplay:"none",noticeBarType:0,noticeExpandType:0,clickType:0,scope:0,userType:2,distinct:0,fixSpeed:0,msgCache:0,netType:0,fixDisplay:0,suspend:1,startTimeStatus:"success",endTimeStatus:"success",pushTimeStatus:"success",popoverVisible:!1,clearNoticeBar:1,smalllayerDisplay:"none",biglayerDisplay:"none",visible:!1,userTypeStatus:!0,clearTableVisible:!1,addPushVisible:!1,pushReviewNumber:"...",toggleStatus:!1,showAdvanceStatus:!1,pushTimeType:0,distinctTitle:[]}},setTableData:function(e){var t=this.state.tableDataIndex,a=this.state.tableDataNum,i={},s=this.props.form.getFieldValue("userType"),l={userTypeInfo:s},r=this.props.form,n=r.getFieldValue("pushType"),o=r.getFieldValue("groupType");0===n?(i.noticeBarInfo=e.noticeBarInfo,i.noticeExpandInfo=e.noticeExpandInfo,i.advanceInfo=e.advanceInfo,i.clickTypeInfo=e.clickTypeInfo,l.title=e.noticeBarInfo.title,l.content=e.noticeBarInfo.content):(i.title=e.title,i.advanceInfo=e.advanceInfo,i.clickTypeInfo=e.clickTypeInfo,i.content=e.content,l.title=e.title,l.content=e.content),1===o&&(i.userTypeInfo=e.userTypeInfo,i.userFileName=e["target"+e.userTypeInfo.userType],l.userTypeInfo=e.userTypeInfo.userType,l.userFileName=e["target"+e.userTypeInfo.userType],l.userGroupName=e.userGroupName,l.tagIdsName=e.tagIdsName,l.groupPushScope=e.groupPushScope);var u={addPushVisible:!1,userTypeInfo:s},p=!0,d=this.state.tableData,c=this.state.dataSource;if(t){p=!1;var m=t.userTypeInfo,h=i.userTypeInfo;for(var f in m)m[f]!==h[f]&&(p=!0);d[a]=i,c[a]=l,o&&p&&(u.pushReviewNumber="..."),i.groupPushAmount=t.groupPushAmount}else i.groupPushAmount="...",l.groupPushAmount="...",d.push(i),c.push(l),u.pushReviewNumber="...";u.tableData=d,u.dataSource=c,this.setState(u),C.tableData=d,C.dataSource=c,o&&p&&this.getUserNumber(o,t?a:a||d.length-1)},delParams:function(e,t){for(var a in t)t.hasOwnProperty(a)&&delete e[a]},showAdvance:function(){this.setState({showAdvanceStatus:!this.state.showAdvanceStatus})},setUserNumber:function(e,t,a){var i=this,s=this.state.groupType,l=i.state.dataSource,r=i.state.tableData,n={searching:!1,totalReviewNumber:e};if(s);else{var o=r.length,u=e;u=u.split(",");var p=u.join("");if(t){if(1===o)return;p-=t,u=p/(o-1)}else u=p/o;for(var d=[],c=0,m=0;m<o&&m!==a;m++){var h=Math.floor(u);d.push(h),m<o-1&&(c+=h)}for(var f=0;f<o&&f!==a;f++){var g=f===o-1?p-c:d.length?d[f]:0;g=String(g),r[f].groupPushAmount=g,l[f].groupPushAmount=g,n["pushReviewNumber"+f]=g}}n.tableData=r,n.dataSource=l,C.tableData=r,C.dataSource=l,i.setState(n)},getUserNumberByGroupType:function(e){var t=this,a=this.state.dataSource,i=this.state.tableData,l={callback:function(){var e=t.state.clickGetUserNumberStatus;e||(t.setState({clickGetUserNumberStatus:!0}),t.setState({searching:!0}))},userNuberCallback:function(l){var r,n=l.value;n=n.split(","),n=n.join(""),i[e].groupPushAmount=n,a[e].groupPushAmount=l.value,t.setState((r={searching:!1},s(r,"pushReviewNumber"+e,n),s(r,"initPushReviewNumber"+e,n),s(r,"tableData",i),s(r,"dataSource",a),r)),C.tableData=i,C.dataSource=a,t.remodify()},key:e};t.handleSubmit(null,"getUserNumber",l)},remodify:function(){var e=this.checkNotSave();e&&this.setState({clickGetUserNumberStatus:!1})},getUserNumber:function(e,t){var a=this,i=this.checkNotSave("getPush");if(i&&!this.state.searching){if(this.props.form.getFieldValue("groupType"))return void this.getUserNumberByGroupType(t);var s={callback:function(){var e=a.state.clickGetUserNumberStatus;e||(a.state.groupType||a.setState({clickGetUserNumberStatus:!0}),a.setState({searching:!0}))},userNuberCallback:function(e){a.setUserNumber(e.value)}};this.handleSubmit(null,"getUserNumber",s)}},addPush:function(){var e=this;if(this.state.permission===!1&&1===this.props.form.getFieldValue("userType")&&this.props.form.getFieldValue("userGroupId"))return void u.message.error("用户群标签没权限");var t=this.state.tableData;return 20===t.length?void u.message.error("最大分组数量为20条"):void this.handleSubmit(null,"deal",function(t){e.setState({addPush:!0,tableDataIndex:null,addPushData:t,tableDataNum:0,addPushVisible:!0})})},getContent:function(e,t,a){var i=this.delPush.bind(this,e,t,a);return"visiblePush"===e&&(i=this.createGroupPush.bind(this,e)),o.default.createElement("div",null,o.default.createElement(u.Button,{type:"primary",className:"color_bg mr10",onClick:this.togglePopover.bind(this,e)},"取消"),o.default.createElement(u.Button,{onClick:i},"确定"))},clearUserGroup:function(e,t){if(e==t){var a={};a.userGroupName=null,a.userGroupDesc=null,a.pushReviewNumber="...",D=null,this.setState(a),this.props.form.setFieldsValue({userGroupId:null})}},togglePopover:function(e){this.setState(s({},e,!this.state[e]))},createGroupPush:function(e){var t=this;if(!this.state.pushStatus){var a=this.checkNotSave("getPush");if(a){this.setState({pushStatus:!0});for(var i=y.default.queryString("appId",window.location.href),l=m.default.addTaskGroup,r=this.state.tableData,n=this.state.totalReviewNumber,o=0,p=0;p<r.length;p++)o+=Number(r[p].groupPushAmount);if(!this.state.groupType&&n){var d=n.split(",");if(d=d.join(""),d=Number(d),o>d)return u.message.error("目标用户量相加不能超过"+n),void this.setState(s({pushStatus:!1},e,!1))}this.handleSubmit(null,"createPush",function(a){t.props.form.getFieldValue("pushType")?a.newsTasks=r:a.noticeTasks=r;var n={appId:a.appId,groupJson:JSON.stringify(a)};f.default.post(l,n,function(){u.message.success("提交成功"),window.location.hash="/data/push/group/push?appId="+i},function(){t.setState(s({pushStatus:!1},e,!1))})})}}},handleSubmit:function(e,a,i){var s,l=this;if(i&&"function"==typeof i&&(s=i),i&&"object"===("undefined"==typeof i?"undefined":r(i))){s=i.callback;var n=i.userNuberCallback,o=i.key}this.props.form.validateFields(function(e,i){var r=i.userType;if(!(+new Date(i.fixStartDisplayTime)>+new Date(i.fixEndDisplayTime))){"deal"===a&&(i.noticeBarImgUrl||(i.noticeBarImgUrl=l.state.noticeBarImgUrl),i.noticeExpandImgUrl||(i.noticeExpandImgUrl=l.state.noticeExpandImgUrl),i.showAdvanceStatus=l.state.showAdvanceStatus,R.jsonData=i,t.jsonData=i);var u=l.state.distinctId;if(i.distinct&&0===u.length)return void l.setState({displayDistinct:""});for(var p in i)p.indexOf("distinctId")>-1&&delete i[p];if(u&&(i.distinctId=u.join(",")),(5!==r||i.tagIds)&&(1!==r||i.userGroupId&&"null"!==i.userGroupId)){if(i.target=i["target"+r],delete i["target"+r],i.userFilePath=i["userFilePath"+r],delete i["userFilePath"+r],""===i.target&&delete i.target,i.userFilePath&&delete i.target,e)return console.log(e),void console.log("Errors in form!!!");i.pushTimeInfo={pushTimeType:i.pushTimeType,startTime:i.startTime&&y.default.dateFormat("yyyy-MM-dd hh:mm:ss",i.startTime),offLine:i.offLine,validTime:i.validTime},l.delParams(i,i.pushTimeInfo),delete i.tagIdsName,0===i.groupType&&(i.userTypeInfo={userType:r,userGroupId:i.userGroupId,target:i.target,tagIds:i.tagIds,scope:i.scope,userFilePath:i.userFilePath},l.delParams(i,i.userTypeInfo));var d=l.props.form.getFieldValue("pushType"),c=y.default.queryString("appId",window.location.href);i.appId=c,l.setState({visible:!0});var h=l.state.tableData;h[o]&&h[o].userTypeInfo&&(i.userTypeInfo=h[o].userTypeInfo);var g={appId:c,userTypeInfo:i.userTypeInfo},v=m.default.getPushCount;v=y.default.makeUrl(v,{appId:c,pushType:d,json:JSON.stringify(g)}),s&&"function"==typeof s&&s(i),"getUserNumber"===a&&f.default.get(v,function(e){l.setState({pushReviewNumber:e.value}),n&&n(e,i)},null,{timeout:3e5})}}})},validateTitle:function(e){var t=this.props.form.getFieldProps;return t(e,{validate:[{rules:[{required:!0,message:"请输入分组标题"},{max:32,message:"标题不能超过32个字"},{validator:function(e,t,a){t&&t.length<=32&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}]})},validateContent:function(e){var t=this.props.form.getFieldProps;return t(e,{validate:[{rules:[{required:!0,message:"请输入内容"},{max:100,message:"内容不能超过100个字"},{validator:function(e,t,a){t&&t.length<=100&&t.match(/^\s/)&&a(new Error("行首不能输入空格")),a()}}],trigger:["onBlur","onChange"]}]})},queryMobileValidImei:function(){var e=this.props.form.getFieldValue("checkImeiPath"),t=this.props.form.getFieldValue("versionNum"),a="?checkImeiPath="+e+"&versionNum="+t;f.default.get(m.default.queryMobileValidImei+a,function(e){var t=e.value;u.message.success("有效IMEI数"+t)})},componentWillMount:function(){var e=this,t=y.default.queryString("appId",window.location.href),a=y.default.queryString("deal",window.location.href);t&&(e.props.form.setFieldsValue({appId:t}),a&&R.jsonData||(C={}))},cantNull:function(e){var t=this.props.form.getFieldProps;return t(e,{rules:[{required:!0,message:"不能为空"}]})},restoreStatus:function(e,t){if("noticeBarType"===e&&1===t&&(1===this.props.form.getFieldValue("noticeExpandType")||3===this.props.form.getFieldValue("noticeExpandType"))){var a={noticeExpandType:0,smalllayerDisplay:"none"};this.setState(a),this.props.form.setFieldsValue(a)}},changeCheckbox:function(e,t){this.setState({distinctId:e,distinctTitle:t})},changeRadio:function(e,t){var a=this,i={};"userGroupAuth"===t&&(i.permission=e.target.permission),this.setState(i);var s=e.target.name;if("upload"===s||"remove"===s||"changeTarget"===s||"tags"===s)return void this.setState({pushReviewNumber:"..."});var l=e.target.value;if(i[s]=l,i.userGroupId=this.props.form.getFieldValue("userGroupId")||this.state.userGroupId,!("noticeBarType"===s&&this.props.form.getFieldValue("noticeBarType")===l||"noticeExpandType"===s&&this.props.form.getFieldValue("noticeExpandType")===l)){if("userGroupId"===s&&(i.userGroupName=e.target.label,i.userGroupDesc=e.target.expression,D=e.target.label),"distinct"==s&&0==l&&(i.distinctTitle=[]),"userType"!==s&&"userGroupId"!==s||this.props.form.getFieldValue(s)===l||(i.totalReviewNumber=!1,i.pushReviewNumber="...",i.clickRefresh=!this.state.clickRefresh),"groupType"===s&&this.props.form.getFieldValue(s)!==l){this.state.tableData.length?(i.clearTableVisible=!0,i.userTypeStatus=this.state.userTypeStatus):(i.userTypeStatus=!this.state.userTypeStatus,i.clearUserFile=!0);var r=l?0:1;return i.clearTableName=s,i.clearTableValue=r,i.currentClickRadio=s,void a.setState(i)}if("pushType"===s&&this.props.form.getFieldValue(s)!==l){this.state.tableData.length&&(i.clearTableVisible=!0);var n=l?0:1;return i.clearTableName=s,i.clearTableValue=n,i.currentClickRadio=s,void a.setState(i)}"scope"===s&&this.props.form.getFieldValue(s)!==l&&(i.pushReviewNumber="..."),this.setState(i),this.props.form.setFieldsValue(i),this.restoreStatus(s,l),this.showButton(s,l)}},clearTabelOk:function(){var e={clearTableVisible:!1};"groupType"===this.state.currentClickRadio&&(e.totalReviewNumber=!1,e.pushReviewNumber="...",e.clearUserFile=!0,e.userTypeStatus=!this.state.userTypeStatus),this.setState(e);for(var t=this.state.dataSource,a={dataSource:[],tableData:[]},i=0;i<t.length;i++)a["pushReviewNumber"+i]="...";this.setState(a),C.dataSource=[],C.tableData=[]},clearTabelCancel:function(){var e={clearTableVisible:!1};this.props.form.setFieldsValue(s({},this.state.clearTableName,this.state.clearTableValue)),"groupType"===this.state.currentClickRadio&&(e.groupType=this.state.groupType?0:1),this.setState(e)},showButton:function(e,t){"noticeExpandType"===e&&2===t&&this.setState({toggleStatus:!0,showBigImg:!0,biglayerDisplay:"none"}),"noticeExpandType"===e&&1===t&&this.setState({toggleStatus:!1,biglayerDisplay:"none"})},uploadBigImg:function(e,t,a){var i={size:"small",height:70,uploadDom:o.default.createElement("div",{className:"upload_area"},o.default.createElement(u.Upload,this.uploadParam(t),o.default.createElement(u.Button,{type:"primary",size:"large"},"添加图片",this.state[t+"loading"]?o.default.createElement(u.Icon,{type:"loading"}):o.default.createElement("span",null))),o.default.createElement("p",{className:"tips"},"推荐尺寸525*100，100KB以内",o.default.createElement("span",{style:{display:this.state.smallImageDisplay},className:"pl10 color_error"},"请上传图片")))};return 2===a&&(i.size="big",i.height=182,i.uploadDom=o.default.createElement("div",{className:"upload_area upload_area_big"},o.default.createElement(u.Upload,this.uploadParam(t),o.default.createElement(u.Button,{type:"primary",size:"large"},"添加图片",this.state[t+"loading"]?o.default.createElement(u.Icon,{type:"loading"}):o.default.createElement("span",null)),o.default.createElement("p",{style:{display:this.state.bigImageDisplay},className:"pl10 color_error"},"请上传图片")),o.default.createElement("p",null,"推荐尺寸700*400，200KB以内"))),this.props.form.getFieldValue(e)===a?o.default.createElement("div",null,o.default.createElement("div",{className:"upload_img"},o.default.createElement("div",{className:""},this.props.form.getFieldValue(t)?o.default.createElement("div",{className:i.size+"_img"},o.default.createElement("img",{onMouseOver:this.imgOver.bind(this,i.size),width:"300",height:i.height,src:this.props.form.getFieldValue(t)}),o.default.createElement("div",{onMouseOver:this.eventPre,onMouseOut:this.imgOut.bind(this,i.size),style:{display:this.state[i.size+"layerDisplay"]},className:"close_img"},o.default.createElement(u.Upload,l({className:i.size+"_img_btn"},this.uploadParam(t)),o.default.createElement(u.Button,{onMouseOut:this.eventPre,onMouseOver:this.imgOver.bind(this,i.size),type:"primary",size:"large"},"更换图片",this.state[t+"loading"]?o.default.createElement(u.Icon,{type:"loading"}):o.default.createElement("span",null))),o.default.createElement("div",{className:"close_icon",onMouseOut:this.eventPre,onMouseOver:this.imgOver.bind(this,i.size)},o.default.createElement(u.Icon,{onClick:this.closeImg.bind(this,t,i.size),type:"cross-circle"})))):i.uploadDom))):null},handleCancel:function(){this.setState({visible:!1,addPushVisible:!1,submiting:!1})},getAppName:function(e){var t="全部应用",a=d.default.allApp;if(a)for(var i=0;i<a.length;i++)a[i].appId==e&&(t=a[i].name);this.setState({appName:t})},componentWillReceiveProps:function(){var e=y.default.queryString("appId",window.location.href);if(this.state.appId&&e!==this.state.appId){this.getAppName(e);var t={appId:e};this.state.groupType||(t.pushReviewNumber="..."),this.setState(t),this.getAppInfo()}},getAppInfo:function(e){var t=this,a=y.default.queryString("appId",window.location.href);f.default.get(m.default.getAppInfo+"?appId="+a,function(a){var i=a.value.appIconUrl;e&&e(i),e||(t.setState({noticeImgUrl:""===i?null:i}),t.props.form.setFieldsValue({noticeImgUrl:""===i?null:i})),t.setState({flymeAuth:a.value.flymeAuth,appName:a.value.appName,limitRate:a.value.limitRatem,msgCacheStatus:a.value.msgCache})})},componentWillUnmount:function(){document.querySelector("#createPush")&&(document.querySelector("#createPush").className="")},setUserTypeGroup:function(e){e=e.items;var t=e.length;D=null;for(var a=y.default.queryString("id",window.location.href),i=0;i<t;i++)a==e[i].id&&this.setState({userGroupName:e[i].name})},componentDidMount:function(){var e=this;document.querySelector("#createPush")&&(document.querySelector("#createPush").className="active");var t=y.default.queryString("appId",window.location.href),a={appId:t};C.tableData&&(a.tableData=C.tableData,a.dataSource=C.dataSource),this.setState(a);var i=y.default.queryString("deal",window.location.href),l=y.default.queryString("id",window.location.href);if(i&&R.jsonData){var r={groupType:R.jsonData.groupType,userType:1,userGroupId:l},n=C&&C.tableData;if(n&&n.length)for(var o=0;o<n.length;o++)"..."===n[o].groupPushAmount&&(r.pushReviewNumber="..."),r["pushReviewNumber"+o]=n[o].groupPushAmount;var u=R.jsonData.pushTimeInfo;1===R.jsonData.groupType&&(r.userTypeStatus=!1,r.addPushVisible=!0,u&&(r.startTime=u.startTime)),this.setState(r),R.jsonData.userType=1,R.jsonData.userGroupId=l,u&&1===u.pushTimeType&&(R.jsonData.startTime=new Date(u.startTime)),u&&(R.jsonData.offLine=u.offLine,R.jsonData.pushTimeType=u.pushTimeType,R.jsonData.validTime=u.validTime),e.setState(R.jsonData),e.props.form.setFieldsValue(R.jsonData)}else C={},window.vedioFilePathJson={},e.props.form.setFieldsValue(this.state);this.getAppInfo(function(a){e.props.form.setFieldsValue({noticeImgUrl:a});var i=y.default.queryString("taskId",window.location.href);if(i){var l=m.default.pushTaskCopy;l=y.default.makeUrl(l,{taskId:i,appId:t}),f.default.get(l,function(t){var a,i=t.value,l=i.clickTypeInfo.parameters,r=i.clickTypeInfo.clickType,n="App";1===r&&(n="AppPage");var o=[],u=(a={noticeBarType:i.noticeBarInfo.noticeBarType,noticeBarImgUrl:i.noticeBarInfo.noticeBarImgUrl,title:i.noticeBarInfo.title,content:i.noticeBarInfo.content,noticeExpandContent:i.noticeExpandInfo.noticeExpandContent,noticeExpandImgUrl:i.noticeExpandInfo.noticeExpandImgUrl,noticeExpandType:i.noticeExpandInfo.noticeExpandType,vedioUrl:i.noticeExpandInfo.actSetting&&i.noticeExpandInfo.actSetting.noticeExpandVedioUrl,onlyWifi:i.noticeExpandInfo.actSetting&&(i.noticeExpandInfo.actSetting.onlyWifi?1:0),activity:i.clickTypeInfo.activity},s(a,"parameters"+n,i.clickTypeInfo.parameters),s(a,"clickType",i.clickTypeInfo.clickType),s(a,"url",i.clickTypeInfo.url),s(a,"customAttribute",i.clickTypeInfo.customAttribute),s(a,"msgCache",i.advanceInfo.msgCache?1:0),s(a,"suspend",i.advanceInfo.suspend?1:0),s(a,"clearNoticeBar",i.advanceInfo.clearNoticeBar?1:0),s(a,"fixSpeed",i.advanceInfo.fixSpeed?1:0),s(a,"fixSpeedRate",i.advanceInfo.fixSpeedRate),s(a,"distinct",i.advanceInfo.distinct?1:0),s(a,"noticeImgUrl",i.advanceInfo.noticeImgUrl),s(a,"vibrate",i.advanceInfo.notificationType.vibrate?1:0),s(a,"lights",i.advanceInfo.notificationType.lights?1:0),s(a,"sound",i.advanceInfo.notificationType.sound?1:0),s(a,"offLine",i.pushTimeInfo.offLine?1:0),s(a,"validTime",i.pushTimeInfo.validTime),a);window.vedioFilePathJson.vedioUrl=i.noticeExpandInfo.actSetting&&i.noticeExpandInfo.actSetting.noticeExpandVedioUrl;for(var p in l)o.push({key:p,value:l[p]});for(var d=0;d<o.length;d++)u["key"+n+(d+1)]=o[d].key,u["value"+n+(d+1)]=o[d].value,window.parametersJson["key"+n+(d+1)]=o[d].key,window.parametersJson["value"+n+(d+1)]=o[d].value;e.props.form.setFieldsValue(u),e.setState({noticeBarType:i.noticeBarInfo.noticeBarType,msgCacheStatus:i.advanceInfo.msgCacheStatus,offLine:i.pushTimeInfo.offLine?1:0}),e.showAdvance()})}})},clickHide:function(e){1===e&&this.setState({noticeExpandContent:!1,toggleStatus:!1}),2===e&&this.setState({noticeExpandImgUrl:!1,showBigImg:!1,toggleStatus:!1})},clickShow:function(e){if(1===e){var t=this.props.form.getFieldValue("noticeExpandContent");if(!t)return void u.message.error("请输入展开文本");this.setState({noticeExpandContent:!0,toggleStatus:!0})}if(2===e){var a=this.props.form.getFieldValue("noticeExpandImgUrl");this.setState({noticeExpandImgUrl:a,showBigImg:!0,toggleStatus:!0})}},changeIcon:function(e){this.setState({noticeImgUrl:null}),this.props.form.setFieldsValue({noticeImgUrl:e})},onChangePushTime:function(e){var t=this.props.form.getFieldValue("fixEndDisplayTime"),a=this.props.form.getFieldValue("fixStartDisplayTime"),i=e>a?e:a,s=e>t?e:t;this.props.form.setFieldsValue({fixEndDisplayTime:s||e,fixStartDisplayTime:i||e})},checkNotSave:function(){for(var e=!0,t=this.state.tableData,a=t.length,i=[],s=0;s<a;s++)i.push("pushReviewNumber"+s+"Status");for(var l=0;l<i.length;l++)this.state[i[l]]&&(u.message.error("你有未保存的选项"),e=!1);return e},modify:function(e){var t={},a=this.checkNotSave();a&&(t[e.target.className]=!0,t.clickGetUserNumberStatus=!0,this.setState(t))},save:function(e,t){var a=this.state.totalReviewNumber;a=String(a).split(","),a=a.join("");var i=this.state.tableData;e=String(e[0]);var s=e.split("pushReviewNumber");s=Number(s[1]),t.stopPropagation();var l=this,r={},n=l.state[e];if(i[s].groupPushAmount=n,r[e]=n,r[e+"Status"]=!1,this.state.groupType){var o=this.state["initPushReviewNumber"+s];if(Number(n)>Number(o))return void u.message.error("目标用户数量最大为："+o)}else if(Number(n)>Number(a))return void u.message.error("目标用户数量最大为："+a);r.clickGetUserNumberStatus=!1,l.setState(r)},keyup:function(e){var t={},a=e.target.value;a=a?a:"0",t[e.target.name]=a,this.setState(t)},delPush:function(e,t,a){var i=this.state.tableData,s=this.state.dataSource;i.splice(a,1),s.splice(a,1);for(var l={},r=0;r<i.length;r++)l["pushReviewNumber"+r]=i[r].groupPushAmount,l["initPushReviewNumber"+r]=i[r].groupPushAmount;l[e]=!this.state[e],l.tableData=i,l.dataSource=s,this.state.groupType||(l.pushReviewNumber="..."),this.setState(l),C.tableData=i,C.dataSource=s},modifyPush:function(e,t){var a=this,i=this.state.tableData;this.handleSubmit(null,null,function(e){a.setState({tableDataIndex:i[t],tableDataNum:t,addPushData:e,addPushVisible:!0})})},getTooltipContainer:function(){return document.getElementById("groupTable")},getInfo:function(){return o.default.createElement("span",null,o.default.createElement(u.Tooltip,{getTooltipContainer:this.getTooltipContainer,title:"目标用户量获取后可点击修改"},o.default.createElement("i",{className:"fs14 color999 fw_n cursor_p anticon anticon-info-circle-o"})),"目标用户量")},render:function(){var e=this,t=this.props.form.getFieldProps,a=o.default.createElement("div",{style:{display:e.state.clickGetUserNumberStatus?"":"none",position:"absolute",left:0,top:0,width:"100%",height:"100%",background:"#ccc",opacity:.5,zIndex:999}}),i=[{title:"标题/备注",key:"1",dataIndex:"title",render:function(e){return e.length>9?o.default.createElement(u.Tooltip,{title:e},o.default.createElement("span",{className:"ellipsis display_ib",style:{width:200}},e)):e},width:200},{title:"内容",key:"2",dataIndex:"content",render:function(e){return e.length>9?o.default.createElement(u.Tooltip,{title:e},o.default.createElement("span",{className:"ellipsis display_ib",style:{width:200}},e)):e},width:200},{title:"目标用户",key:"3",dataIndex:"userTypeInfo",render:function(t,a){var i="",s="",l="";switch(e.state.groupType?(i=a.userFileName,i=i&&(i.indexOf(".")>-1?i:null),s=a.userGroupName,l=(a.groupPushScope?"交集：":"并集：")+a.tagIdsName):(t=e.props.form.getFieldValue("userType")||e.state.userType,i=e.props.form.getFieldValue("target"+t),i=i&&(i.indexOf(".")>-1?i:null),s=D||e.state.userGroupName,l=(e.state.scope?"交集：":"并集：")+(e.props.form.getFieldValue("tagIdsName")||"")),t){case 1:t="用户群"+(s?"("+s+")":"");break;case 2:t="PushId"+(i?"("+i+")":"");break;case 6:t="IMEI"+(i?"("+i+")":"");
break;case 3:t="Flyme账户"+(i?"("+i+")":"");break;case 4:t="别名"+(i?"("+i+")":"");break;case 5:t="标签("+l+")"}return t.length>9?o.default.createElement(u.Tooltip,{title:t},o.default.createElement("span",{className:"ellipsis display_ib",style:{width:180}},t)):t},width:180},{title:this.getInfo(),key:"4",dataIndex:"groupPushAmount",render:function(t,a,i){var s=["pushReviewNumber"+i],l=["pushReviewNumber"+i+"Status"],r=e.state["pushReviewNumber"+i];if(r&&"..."!==r&&r.indexOf(",")<0){r=String(r),r=r.split("");for(var n=r.length,p=n-1;p>=0;p--)n-1-p&&(n-1-p)%3===0&&n-1!==p&&(r[p]+=",")}"..."===a.groupPushAmount&&(r=!1);var d=o.default.createElement(F,{style:{marginBottom:0},label:""},e.state[l]?o.default.createElement("span",null,o.default.createElement(u.Input,{min:"1",type:"number",className:"Modify",defaultValue:e.state[s],name:s,onChange:e.keyup,style:{width:100}}),o.default.createElement(u.Button,{onClick:e.save.bind(e,s),size:"large",className:"btn_normal_show ml10 w_60 ",type:"ghost"},o.default.createElement("span",{className:"Modify"},"保存"))):o.default.createElement("span",null,r?o.default.createElement("span",{className:l,onClick:e.modify},r):"..."));return d},width:150},{title:"操作",key:"5",render:function(t,i,s){var l="visibleDel"+s;return o.default.createElement("div",{style:{position:"relative"}},a,o.default.createElement("i",{onClick:e.modifyPush.bind(e,i,s),className:"i_edit"}),o.default.createElement(u.Popover,{placement:"bottom",visible:e.state[l],content:e.getContent(l,i,s),title:"确定删除?",onVisibleChange:e.togglePopover.bind(e,l),trigger:"click"},o.default.createElement("i",{className:"i_del"})))},width:90}],s=C.dataSource||this.state.dataSource;return o.default.createElement(u.Form,{horizontal:!0},o.default.createElement(u.Row,null,o.default.createElement(u.Col,{span:"24",className:"col_left"},o.default.createElement(F,l({},B,{label:"标题    "}),o.default.createElement(u.Input,l({placeholder:"请输入分组标题",style:{width:400}},this.validateTitle("groupName")))),o.default.createElement("div",{style:{position:"relative"}},a,o.default.createElement(F,l({},B,{label:"推送消息类型    "}),o.default.createElement(x,t("pushType",{initialValue:this.props.form.getFieldValue("pushType"),onChange:this.changeRadio}),o.default.createElement(u.Radio,{name:"pushType",value:0},"通知"),o.default.createElement(u.Radio,{name:"pushType",value:1},"透传消息"))),o.default.createElement(F,l({},B,{label:"目标用户类型    "}),o.default.createElement(x,t("groupType",{initialValue:this.props.form.getFieldValue("groupType"),onChange:this.changeRadio}),o.default.createElement(u.Radio,{name:"groupType",value:0},"相同用户群"),o.default.createElement(u.Radio,{name:"groupType",value:1},"不同用户群"))),this.state.userTypeStatus?o.default.createElement(S.default,{form:this.props.form,formItemLayout:B,getFieldProps:t,scope:this.state.scope,clearUserGroup:this.clearUserGroup,userType:this.props.form.getFieldValue("userType")||2,handleSubmit:this.handleSubmit,groupPush:!0,clearUserFile:this.state.clearUserFile,userGroupId:this.state.userGroupId,type:this.props.pushType,setUserTypeGroup:this.setUserTypeGroup,flymeAuth:this.state.flymeAuth,appId:y.default.queryString("appId",window.location.href),changeRadio:this.changeRadio}):null,o.default.createElement(b.default,{formItemLayout:B,getFieldProps:t,onChangePushTime:this.onChangePushTime,pushTimeStatus:this.state.endTimeStatus,pushTimeType:this.props.form.getFieldValue("pushTimeType"),changeRadio:this.changeRadio}),o.default.createElement(T.default,{form:this.props.form,offLine:this.state.offLine,formItemLayout:B,getFieldProps:t}),o.default.createElement(F,l({},B,{label:" "}),o.default.createElement(u.Button,{style:{marginBottom:10},onClick:this.addPush,type:"primary",size:"large"},"添加推送内容"))),s&&s.length?o.default.createElement("div",{id:"groupTable"},o.default.createElement(u.Table,{style:{marginBottom:20},pagination:!1,columns:i,dataSource:s})):null,s&&s.length&&!this.state.groupType?o.default.createElement(F,l({},B,{label:" "}),o.default.createElement(u.Button,{disabled:!!this.state.clickGetUserNumberStatus,type:"primary",onClick:this.getUserNumber,size:"large"},"获取目标用户"),this.state.clickGetUserNumberStatus?o.default.createElement(u.Button,{type:"primary",style:{marginLeft:20},onClick:this.remodify,size:"large"},"重新编辑"):null,this.state.searching?o.default.createElement("span",{style:{paddingLeft:20}},"正在查询用户数，请等待..."):o.default.createElement("span",null)):null,s&&s.length?o.default.createElement(F,l({},B,{label:" "}),o.default.createElement(u.Popover,{placement:"top",visible:e.state.visiblePush,content:e.getContent("visiblePush"),title:"确定推送?",onVisibleChange:this.togglePopover.bind(this,"visiblePush"),trigger:"click"},"..."!==this.state.pushReviewNumber?o.default.createElement("span",{style:{position:"relative"}},o.default.createElement(u.Button,{type:"primary",size:"large"},"推送"),this.state.pushStatus?o.default.createElement("div",{style:{position:"absolute",left:130,top:-5,width:120}},"推送中..."):o.default.createElement("span",null)):this.state.groupType?o.default.createElement("span",null,"正在查询用户数，请等待..."):o.default.createElement("span",null))):null)),o.default.createElement(k.default,{handleCancel:this.handleCancel,form:this.props.form,totalReviewNumber:this.state.totalReviewNumber,addPushData:this.state.addPushData,tableDataIndex:this.state.tableDataIndex,addPush:this.state.addPush,setTableData:this.setTableData,smallImageDisplay:this.state.smallImageDisplay,flymeAuth:this.state.flymeAuth,pushType:this.props.form.getFieldValue("pushType")?"message":"notice",groupType:this.props.form.getFieldValue("groupType"),visible:this.state.addPushVisible}),o.default.createElement(u.Modal,{width:700,onCancel:this.clearTabelCancel,onOk:this.clearTabelOk,title:"系统提示",visible:this.state.clearTableVisible},o.default.createElement("div",{style:{margin:"20px 0 20px 30px"}},"切换","pushType"===this.state.clearTableName?"推送消息类型":"目标用户类型","将会清除本任务所有已编辑内容，请确定是否切换？")))}});U=u.Form.create()(U),e.exports=U},915:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=a(600),l=i(s),r=a(783),n=a(898),o=i(n),u=a(913),p=i(u);window.vedioFilePathJson={};var d=l.default.createClass({displayName:"AddPushModal",getInitialState:function(){return{popoverVisible:!1}},componentDidMount:function(){document.querySelector("#prepush")&&(document.querySelector("#prepush").classList="prepush_position")},render:function(){var e=this.props.pushType,t="notice"===e?"推送通知":"透传消息";return this.props.visible?l.default.createElement(r.Modal,{footer:null,width:"notice"===e?1240:800,onCancel:this.props.handleCancel,title:t,visible:this.props.visible},"notice"===e?l.default.createElement(o.default,{setTableData:this.props.setTableData,addPushData:this.props.addPushData,tableDataIndex:this.props.tableDataIndex,pushType:e,addPush:this.props.addPush,totalReviewNumber:this.props.totalReviewNumber,visible:this.props.visible,groupPush:!0,groupType:this.props.groupType}):l.default.createElement(p.default,{setTableData:this.props.setTableData,addPushData:this.props.addPushData,tableDataIndex:this.props.tableDataIndex,pushType:e,addPush:this.props.addPush,totalReviewNumber:this.props.totalReviewNumber,visible:this.props.visible,groupPush:!0,groupType:this.props.groupType})):null}});d=r.Form.create()(d),e.exports=d},916:function(e,t,a){"use strict";function i(e){return e&&e.__esModule?e:{default:e}}var s=a(600),l=i(s),r=a(898),n=i(r),o=a(913),u=i(o),p=a(777),d=i(p),c=a(783),m=c.Tabs.TabPane,h=l.default.createClass({displayName:"App",getInitialState:function(){return{}},onChange:function(e){var t=window.location.hash,a=d.default.getQueryObj(t);a.timingPushType=e;var i=d.default.makeUrl("#/create/push/",a);window.location.hash=i},render:function(){var e=window.location.hash,t=d.default.getQueryObj(e),a=t.timingPushType||"1";return l.default.createElement("div",null,l.default.createElement(c.Tabs,{onChange:this.onChange,defaultActiveKey:a},l.default.createElement(m,{tab:"定时通知",key:"1"},l.default.createElement(n.default,{pushType:"notice"})),l.default.createElement(m,{tab:"定时透传消息",key:"2"},l.default.createElement(u.default,{pushType:"message"})," ")))}});e.exports=h}});