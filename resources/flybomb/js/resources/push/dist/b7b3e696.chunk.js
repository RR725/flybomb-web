webpackJsonp([7],{918:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=a(600),r=l(n),s=a(919),i=l(s),u=a(776),d=l(u),o=a(777),c=l(o),p=a(785),m=l(p),f=r.default.createClass({displayName:"App",getInitialState:function(){return{current:1,appId:c.default.queryString("appId",window.location.href),tableData:{loading:!0,data:[],pagination:null}}},componentWillReceiveProps:function(){var e=c.default.queryString("appId",window.location.href);this.setState({appId:e})},tableData:function(e){var t=this;this.setState({tableData:{loading:!0,data:[]},current:e.index});var a=d.default.pushTaskSearch,l=c.default.queryString("appId",window.location.href);l&&"0"!==l?e.appId=l:delete e.appId,a=c.default.makeUrl(a,e),m.default.get(a,function(a){var l=a.value.result;l.map(function(e,t){l[t].key=t}),t.setState({tableData:{data:l,loading:!1,pagination:{total:a.value.amount,current:e.index,pageSize:10,showSizeChanger:!1,onChange:function(a){e.index=a,t.setState({current:a,searchData:e}),t.tableData(e)}}}})},function(){t.setState({tableData:{loading:!1}})})},componentWillUnmount:function(){document.querySelector("#dataStat")&&(document.querySelector("#dataStat").className="")},componentDidMount:function(){document.querySelector("#dataStat")&&(document.querySelector("#dataStat").className="active")},render:function(){return r.default.createElement("div",null,r.default.createElement(i.default,{searchData:this.state.searchData,refresh:this.state.refresh,tableData:this.state.tableData,current:this.state.current,appId:this.state.appId,onSearch:this.tableData}))}});e.exports=f},919:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},r=a(600),s=l(r),i=a(783),u=a(776),d=l(u),o=a(785),c=l(o),p=a(777),m=l(p),f=a(920),h=l(f),y=a(921),g=l(y),v=i.Form.Item,T=i.Select.Option,E={labelCol:{span:8},wrapperCol:{span:16}},S=s.default.createClass({displayName:"AddAppTask",getInitialState:function(){return{buttonGroupType:"ghost",initData:{},sourceValue:"",sourceType:[{id:"",desc:"全部"}],values:[],data:null,noticeBarType:"0",noticeExpandType:"0",pushTimeType:0,errors:{},defaultAppid:"应用"}},handleSubmit:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,a){if(e)return void console.log("Errors in form!!!");var l=a.startTime,n=a.endTime;if(!(+new Date(l)>+new Date(n))){a.index=1,a.startTime="string"==typeof a.startTime?a.startTime:m.default.dateFormat("yyyy-MM-dd hh:mm:ss",a.startTime),a.endTime="string"==typeof a.endTime?a.endTime:m.default.dateFormat("yyyy-MM-dd hh:mm:ss",a.endTime);var r={};for(var s in a)""!==a[s]&&(r[s]=a[s]);var i=t.state.sourceValue;i&&(r.sourceType=i),t.setState({searchData:a}),t.props.onSearch(r)}})},componentDidMount:function(){var e=new Date,t=m.default.queryString("appId",window.location.href),a={appId:t,index:1,startTime:m.default.dateFormat("yyyy-MM-dd",e)+" 00:00:00",endTime:m.default.dateFormat("yyyy-MM-dd hh:mm:ss",e)};this.setState({appId:t,searchData:a}),this.props.onSearch(a),this.getSourceType()},componentWillReceiveProps:function(){var e=m.default.queryString("appId",window.location.href);this.state.appId&&e!==this.state.appId&&this.getSourceType("changeApp"),this.setState({appId:e})},getSourceType:function(e){var t=this,a=m.default.queryString("appId",window.location.href),l=d.default.getSourceType;l=m.default.makeUrl(l,{appId:a}),c.default.get(l,function(a){var l=t.state.sourceType;"changeApp"===e&&(l=[{id:"",desc:"全部"}]),l=l.concat(a.value);var n={sourceType:l};t.state.sourceType.length!==l.length&&"3"===t.state.sourceValue&&(n.sourceValue=""),t.setState(n)})},cantNull:function(e,t){var a=this.props.form.getFieldProps;return a(e,{initialValue:t})},changeSourceType:function(e){var t={sourceValue:e};this.setState(t)},render:function(){var e=this.state.sourceType,t=e.map(function(e,t){return s.default.createElement(T,{key:t,value:String(e.id)},e.desc)}),a=this.state.searchData||this.props.searchData;return s.default.createElement("div",null,s.default.createElement(i.Form,{horizontal:!0},s.default.createElement(i.Row,null,s.default.createElement(i.Col,{span:"24"},s.default.createElement(g.default,{type:"second",form:this.props.form}))),s.default.createElement(i.Row,null,s.default.createElement(i.Col,{span:"6"},s.default.createElement(v,n({},E,{label:"任务来源    "}),s.default.createElement(i.Select,{value:this.state.sourceValue,onChange:this.changeSourceType,size:"large"},t))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(v,n({},E,{label:"推送类型    "}),s.default.createElement(i.Select,n({},this.cantNull("pushType",""),{size:"large"}),s.default.createElement(T,{value:""},"全部"),s.default.createElement(T,{value:"0"},"通知"),s.default.createElement(T,{value:"1"},"透传消息")))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(v,n({},E,{label:"状态    "}),s.default.createElement(i.Select,n({},this.cantNull("pushStatus",""),{size:"large"}),s.default.createElement(T,{value:""},"全部"),s.default.createElement(T,{value:"0"},"待推送"),s.default.createElement(T,{value:"10"},"待确认"),s.default.createElement(T,{value:"1"},"推送中"),s.default.createElement(T,{value:"20"},"就绪"),s.default.createElement(T,{value:"3"},"已完成"),s.default.createElement(T,{value:"4"},"取消"),s.default.createElement(T,{value:"5"},"推送失败"))))),s.default.createElement(i.Row,null,s.default.createElement(i.Col,{span:"6"},s.default.createElement(v,n({},E,{label:"任务ID    "}),s.default.createElement(i.Input,n({placeholder:"输入任务ID"},this.cantNull("taskId",""))))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(v,n({},E,{label:"标题名称    "}),s.default.createElement(i.Input,n({placeholder:"输入标题关键字"},this.cantNull("title",""))))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(v,n({},E,{label:""}),s.default.createElement(i.Button,{className:"ml10",type:"primary",onClick:this.handleSubmit,size:"large"},"查询"))))),s.default.createElement(h.default,{searchData:a,current:this.props.current,onSearch:this.props.onSearch,refresh:this.props.refresh,tableData:this.props.tableData}))}});S=i.Form.create()(S),e.exports=S},920:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=a(600),s=l(r),i=a(783),u=a(776),d=l(u),o=a(777),c=l(o),p=a(785),m=l(p),f=s.default.createClass({displayName:"App",getInitialState:function(){var e=this;return{columns:[{title:"推送时间",key:"0",className:"ta_c",dataIndex:"pushTime"},{title:"应用名称",key:"1",dataIndex:"appName",className:"td_appname",render:function(e,t){return s.default.createElement("div",null,s.default.createElement("img",{src:t.appIconUrl||"/resources/push/images/default_icon.png",width:"24",height:"24"}),e)}},{title:"任务ID",key:"2",className:"ta_c",dataIndex:"taskId"},{title:"类型",key:"3",className:"ta_c",dataIndex:"pushType"},{title:"任务来源",key:"4",className:"ta_c",dataIndex:"sourceType"},{title:"标题/备注",key:"5",className:"td_appname w_240",dataIndex:"title"},{title:"推送人群",key:"6",className:"ta_c",dataIndex:"userType"},{title:"状态",key:"7",className:"ta_c",dataIndex:"status"},{title:"操作",className:"ta_l",key:"8",render:function(t,a,l){var n=c.default.queryString("appId",window.location.href),r="#/data/push/detail?appId="+a.appId+"&taskId="+a.taskId;"0"===n&&(n=window.ListApp[0].appId);var u="#/create/push?appId="+a.appId+"&pushType="+("通知"===a.pushType?"notice":"message")+"&taskId="+a.taskId;return s.default.createElement("div",{className:"btn_wrap"},s.default.createElement(i.Tooltip,{title:"推送详情"},s.default.createElement("a",{target:"_blank",href:window.location.pathname+r},s.default.createElement("i",{className:"i_detail"}))),"个性化推送"===a.sourceType?null:s.default.createElement(i.Tooltip,{title:"任务复制"},s.default.createElement("a",{href:window.location.pathname+u},s.default.createElement("i",{className:"i_copy"}))),s.default.createElement(i.Popover,{placement:"bottom",visible:e.state["visible"+l],content:e.getContent("visible"+l,a,l),title:"确定取消推送?",onVisibleChange:e.togglePopover.bind(e,"visible"+l),trigger:"click"},s.default.createElement("span",null,"待推送"===a.status||"待确认"===a.status||"就绪"===a.status||"推送中"===a.status?s.default.createElement(i.Tooltip,{title:"取消推送"},s.default.createElement("a",{href:"javascript:;"},s.default.createElement("i",{className:"i_cancel_push"}))):null)))},dataIndex:""}],refresh:!1}},getContent:function(e,t,a){return s.default.createElement("div",null,s.default.createElement(i.Button,{type:"primary",className:"color_bg mr10",onClick:this.togglePopover.bind(this,e)},"取消"),s.default.createElement(i.Button,{onClick:this.cancelPushTask.bind(this,e,t,a)},"确定"))},togglePopover:function(e){this.setState(n({},e,!this.state[e]))},cancelPushTask:function(e,t){var a=this,l=d.default.cancelPushTask;l=c.default.makeUrl(l,{taskId:t.taskId,appId:t.appId}),m.default.get(l,function(){i.message.success("推送任务已取消");var t=a.props.searchData;if(!t){var l=new Date;t={startTime:c.default.dateFormat("yyyy-MM-dd",l)+" 00:00:00",endTime:c.default.dateFormat("yyyy-MM-dd hh:mm:ss",l),index:a.props.current}}for(var r in t)""===t[r]&&delete t[r];a.props.onSearch(t),a.setState(n({},e,!a.state[e]))})},render:function(){var e=this.props.tableData.data;return s.default.createElement(i.Table,{columns:this.state.columns,loading:this.props.tableData.loading,dataSource:e,pagination:this.props.tableData.pagination})}});e.exports=f},921:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},r=a(600),s=l(r),i=a(783),u=a(777),d=l(u),o=a(922),c=l(o),p=i.Form.Item,m=i.Radio.Button,f=i.Radio.Group,h=s.default.createClass({displayName:"PushTime",getInitialState:function(){var e=this.props.router,t=864e5,a=new Date,l="userdata"===e?new Date(+new Date-6*t):a,n=d.default.dateFormat("yyyy-MM-dd",l),r=d.default.dateParse(n+" 00:00:00");return{startTimeStatus:"success",endTimeStatus:"success",startTime:r,endTime:a,display:"none",errorTips:"",pushTimeType:0}},changeRadio:function(e){var t=e.target.value,a=+new Date,l=864e5,n={pushTimeType:t};if(1===t?n.endTime=new Date(a-Number(t)*l):n.endTime=new Date,"number"==typeof t){n.startTime=new Date(a-Number(t)*l);var r=d.default.dateFormat("yyyy-MM-dd",n.startTime);1!==t&&0!==t||(n.startTime=d.default.dateParse(r+" 00:00:00")),1===t&&(n.endTime=d.default.dateParse(r+" 23:59:59")),n.display="none",n.startTimeStatus="success",n.endTimeStatus="success",n.errorTips=""}else n.startTime=new Date;this.setState(n),this.props.form.setFieldsValue(n)},componentDidMount:function(){"userdata"===this.props.router&&this.setState({pushTimeType:6})},onOpen:function(){this.setState({pushTimeType:"other"})},changeStartTime:function(e){var t=this.props.router,a=this.props.required,l={router:t,required:a},n=this.props.form.getFieldValue("endTime"),r=c.default.changeStartTime(e,n,l);this.setState(r)},changeEndTime:function(e){var t=this.props.required,a={required:t},l=this.props.form.getFieldValue("startTime"),n=c.default.changeEndTime(e,l,a);this.setState(n)},render:function(){var e="",t=this.props.type,a=this.props.router;"second"===t&&(e=" H:mm:ss");var l=this.props.form.getFieldProps;return s.default.createElement(p,{className:"radio_btn",labelCol:{span:2},wrapperCol:{span:22},label:"时间    "},"personal"===a?null:s.default.createElement(f,{onChange:this.changeRadio,value:this.state.pushTimeType,size:"large",style:{marginRight:10}},"userdata"===a?null:s.default.createElement(m,{value:0},"今天"),"userdata"===a?null:s.default.createElement(m,{value:1},"昨天"),"analyze"===a?null:s.default.createElement(m,{value:6},"最近7天"),"analyze"===a?null:s.default.createElement(m,{value:30},"最近30天"),s.default.createElement(m,{value:"other"},"选择日期")),s.default.createElement(p,{validateStatus:this.state.startTimeStatus,className:"display_ib va_t mg0"},s.default.createElement(i.DatePicker,n({},l("startTime",{initialValue:this.state.startTime,onChange:this.changeStartTime}),{toggleOpen:this.onOpen,showTime:!0,format:"yyyy-MM-dd"+e}))),"analyze"===a?null:s.default.createElement("span",{className:"pl10 pr10"},"至"),"analyze"===a?null:s.default.createElement(p,{validateStatus:this.state.endTimeStatus,className:"display_ib va_t mg0"},s.default.createElement(i.DatePicker,n({},l("endTime",{initialValue:this.state.endTime,onChange:this.changeEndTime}),{toggleOpen:this.onOpen,showTime:!0,format:"yyyy-MM-dd"+e}))),s.default.createElement("span",{style:{display:this.state.display},className:"color_error pl10"},this.state.errorTips))}});e.exports=h}});