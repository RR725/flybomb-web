webpackJsonp([27],{921:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},r=a(600),s=l(r),i=a(783),o=a(777),u=l(o),d=a(922),c=l(d),m=i.Form.Item,p=i.Radio.Button,f=i.Radio.Group,h=s.default.createClass({displayName:"PushTime",getInitialState:function(){var e=this.props.router,t=864e5,a=new Date,l="userdata"===e?new Date(+new Date-6*t):a,n=u.default.dateFormat("yyyy-MM-dd",l),r=u.default.dateParse(n+" 00:00:00");return{startTimeStatus:"success",endTimeStatus:"success",startTime:r,endTime:a,display:"none",errorTips:"",pushTimeType:0}},changeRadio:function(e){var t=e.target.value,a=+new Date,l=864e5,n={pushTimeType:t};if(1===t?n.endTime=new Date(a-Number(t)*l):n.endTime=new Date,"number"==typeof t){n.startTime=new Date(a-Number(t)*l);var r=u.default.dateFormat("yyyy-MM-dd",n.startTime);1!==t&&0!==t||(n.startTime=u.default.dateParse(r+" 00:00:00")),1===t&&(n.endTime=u.default.dateParse(r+" 23:59:59")),n.display="none",n.startTimeStatus="success",n.endTimeStatus="success",n.errorTips=""}else n.startTime=new Date;this.setState(n),this.props.form.setFieldsValue(n)},componentDidMount:function(){"userdata"===this.props.router&&this.setState({pushTimeType:6})},onOpen:function(){this.setState({pushTimeType:"other"})},changeStartTime:function(e){var t=this.props.router,a=this.props.required,l={router:t,required:a},n=this.props.form.getFieldValue("endTime"),r=c.default.changeStartTime(e,n,l);this.setState(r)},changeEndTime:function(e){var t=this.props.required,a={required:t},l=this.props.form.getFieldValue("startTime"),n=c.default.changeEndTime(e,l,a);this.setState(n)},render:function(){var e="",t=this.props.type,a=this.props.router;"second"===t&&(e=" H:mm:ss");var l=this.props.form.getFieldProps;return s.default.createElement(m,{className:"radio_btn",labelCol:{span:2},wrapperCol:{span:22},label:"时间    "},"personal"===a?null:s.default.createElement(f,{onChange:this.changeRadio,value:this.state.pushTimeType,size:"large",style:{marginRight:10}},"userdata"===a?null:s.default.createElement(p,{value:0},"今天"),"userdata"===a?null:s.default.createElement(p,{value:1},"昨天"),"analyze"===a?null:s.default.createElement(p,{value:6},"最近7天"),"analyze"===a?null:s.default.createElement(p,{value:30},"最近30天"),s.default.createElement(p,{value:"other"},"选择日期")),s.default.createElement(m,{validateStatus:this.state.startTimeStatus,className:"display_ib va_t mg0"},s.default.createElement(i.DatePicker,n({},l("startTime",{initialValue:this.state.startTime,onChange:this.changeStartTime}),{toggleOpen:this.onOpen,showTime:!0,format:"yyyy-MM-dd"+e}))),"analyze"===a?null:s.default.createElement("span",{className:"pl10 pr10"},"至"),"analyze"===a?null:s.default.createElement(m,{validateStatus:this.state.endTimeStatus,className:"display_ib va_t mg0"},s.default.createElement(i.DatePicker,n({},l("endTime",{initialValue:this.state.endTime,onChange:this.changeEndTime}),{toggleOpen:this.onOpen,showTime:!0,format:"yyyy-MM-dd"+e}))),s.default.createElement("span",{style:{display:this.state.display},className:"color_error pl10"},this.state.errorTips))}});e.exports=h},1549:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=a(600),r=l(n),s=a(1550),i=l(s),o=a(776),u=l(o),d=a(777),c=l(d),m=a(785),p=l(m),f=r.default.createClass({displayName:"App",getInitialState:function(){return{current:1,tableData:{loading:!0,data:[],pagination:null}}},setTableDataDisable:function(e){var t=this.state.tableData.data;t.map(function(t,a){var l=t.disable;a===e&&(t.disable=!l)}),this.setState({tableData:{data:t}})},tableData:function(e){var t=this,a=c.default.queryString("appId",window.location.href);this.setState({tableData:{loading:!0}});var l=u.default.materialList;l=c.default.makeUrl(l,e),p.default.get(l,function(l){var n=l.value.result;n.map(function(e,t){n[t].key=t}),t.setState({tableData:{data:n,loading:!1,pagination:{total:l.value.amount,current:t.state.current,pageSize:10,showSizeChanger:!1,onChange:function(l){var n={appId:a,index:l};e.blackName&&(n.blackName=e.blackName),t.setState({current:l}),t.tableData(n)}}}})},function(){t.setState({tableData:{loading:!1}})})},componentWillUnmount:function(){document.querySelector("#personalPush")&&(document.querySelector("#personalPush").className="")},componentDidMount:function(){document.querySelector("#personalPush")&&(document.querySelector("#personalPush").className="active");var e=c.default.queryString("appId",window.location.href);this.setState({appId:e})},render:function(){return r.default.createElement("div",null,r.default.createElement(i.default,{setTableDataDisable:this.setTableDataDisable,current:this.state.current,refresh:this.state.refresh,tableData:this.state.tableData,getTableData:this.tableData}))}});e.exports=f},1550:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},r=a(600),s=l(r),i=a(783),o=a(1551),u=l(o),d=a(777),c=l(d),m=a(1552),p=l(m),f=a(921),h=l(f),g=i.Form.Item,v={labelCol:{span:6},wrapperCol:{span:18}},y=s.default.createClass({displayName:"BlackToolbar",getInitialState:function(){return{data:null,value:"",searchStatus:!1}},componentDidMount:function(){this.onSearch()},onSearch:function(){var e=c.default.queryString("appId",window.location.href),t=this.props.form.getFieldValue("startTime"),a=this.props.form.getFieldValue("endTime"),l=this.props.form.getFieldValue("title"),n={appId:e,index:1};t&&(n.startTime=c.default.dateFormat("yyyy-MM-dd",t)),a&&(n.endTime=c.default.dateFormat("yyyy-MM-dd",a)),l&&(n.title=l),t&&a&&t>a||this.props.getTableData(n)},render:function(){var e=this.props.form.getFieldProps;return s.default.createElement("div",null,s.default.createElement(p.default,{tableData:this.props.tableData,getTableData:this.onSearch}),s.default.createElement(i.Form,null,s.default.createElement("div",{className:"sub_toolbar config_toolbar"},s.default.createElement(i.Row,null,s.default.createElement(i.Col,{span:"4"},s.default.createElement("div",{className:"title"},s.default.createElement("span",{className:"border"}),"资源列表")))),s.default.createElement(i.Row,{className:"mt10"},s.default.createElement(i.Col,{span:"24"},s.default.createElement(h.default,{required:1,router:"personal",form:this.props.form}))),s.default.createElement(i.Row,{className:"mt10"},s.default.createElement(i.Col,{span:"8"},s.default.createElement(g,n({},v,{label:"备注    "}),s.default.createElement(i.Input,n({placeholder:"备注"},e("title"))))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(i.Button,{className:"ml10",type:"primary",onClick:this.onSearch,size:"large"},"查询"))),s.default.createElement(u.default,{current:this.props.current,tagName:this.state.tagName,getTableData:this.props.getTableData,refresh:this.props.refresh,tableData:this.props.tableData})))}});y=i.Form.create()(y),e.exports=y},1551:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=a(600),r=l(n),s=a(783),i=a(776),o=l(i),u=a(777),d=l(u),c=a(785),m=l(c),p=r.default.createClass({displayName:"ResourceLibTable",getInitialState:function(){return{uploadTime:"",title:"",total:""}},componentDidMount:function(){},getTable:function(e){var t=d.default.queryString("appId",window.location.href),a={index:e.index||1,materialId:e.id,appId:t},l=this;m.default.post(o.default.materialListDetail,a,function(t){l.setState({detailData:t.value.result,pagination:{total:t.value.amount,current:a.index,pageSize:10,showSizeChanger:!1,onChange:function(t){var a={id:e.id,index:t};l.setState({current:t}),l.getTable(a)}}})})},getDetail:function(e){this.setState({visible:!0,detailData:[],uploadTime:e.uploadTime,title:e.title,total:e.total}),this.getTable(e)},handleCancel:function(){this.setState({visible:!1})},detailColumns:function(){return[{title:"序号",key:"0",dataIndex:"id",className:"ta_l"},{title:"上传时间",className:"ta_l",key:"1",dataIndex:"uploadTime"},{title:"内容ID",className:"ta_l",key:"2",dataIndex:"contentId"},{title:"通知栏标题",className:"ta_l td_appname",key:"3",dataIndex:"title"},{title:"通知栏内容",className:"ta_l td_appname",key:"4",dataIndex:"content"}]},render:function(){var e=this,t=[{title:"序号",key:"0",dataIndex:"id",className:"ta_l"},{title:"上传时间",className:"ta_l",key:"1",dataIndex:"uploadTime"},{title:"备注",className:"ta_l td_appname",key:"2",dataIndex:"title"},{title:"内容数",className:"ta_r",key:"3",dataIndex:"total"},{title:"状态",className:"ta_r",key:"4",dataIndex:"statusDesc"},{title:"操作",className:"ta_c",key:"5",render:function(t,a){return r.default.createElement("div",null,r.default.createElement("a",{href:"javascript:;",onClick:function(){e.getDetail(a)}},"查看"))},dataIndex:""}];return r.default.createElement("div",null,r.default.createElement(s.Table,{className:"home_table",columns:t,loading:this.props.tableData.loading,dataSource:this.props.tableData.data,pagination:this.props.tableData.pagination}),r.default.createElement(s.Modal,{width:1e3,onCancel:this.handleCancel,onOk:this.handleCancel,okText:"确定",cancelText:"取消",title:"资源详情",visible:this.state.visible},r.default.createElement("div",{className:"fs14"},r.default.createElement("div",{className:"lh25"},r.default.createElement(s.Row,null,r.default.createElement(s.Col,{className:"ta_r pr10",span:"3"},"备注"),r.default.createElement(s.Col,{span:"21"},this.state.title)),r.default.createElement(s.Row,null,r.default.createElement(s.Col,{className:"ta_r pr10",span:"3"},"上传时间"),r.default.createElement(s.Col,{span:"21"},this.state.uploadTime)),r.default.createElement(s.Row,null,r.default.createElement(s.Col,{className:"ta_r pr10",span:"3"},"内容数"),r.default.createElement(s.Col,{span:"21"},this.state.total))),r.default.createElement(s.Table,{pagination:this.state.pagination,columns:this.detailColumns(),dataSource:this.state.detailData}))))}});e.exports=p},1552:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},r=a(600),s=l(r),i=a(783),o=a(777),u=l(o),d=a(785),c=l(d),m=a(776),p=l(m),f=i.Form.Item,h={labelCol:{span:6},wrapperCol:{span:18}},g=s.default.createClass({displayName:"AddMaterial",getInitialState:function(){return{data:null,value:""}},add:function(){var e=u.default.queryString("appId",window.location.href),t=this;this.props.form.validateFields(function(a,l){if(a)return void console.log("Errors in form!!!");var n={title:l.title.trim(),appId:e,filePath:l.filePath};c.default.post(p.default.materialAdd,n,function(){i.message.success("新建成功");var a={appId:e,index:1};t.props.getTableData(a)})})},render:function(){var e=this,t=p.default.materialUpload,a=this.props.form.getFieldProps,l=u.default.queryString("appId",window.location.href);t=u.default.makeUrl(t,{appId:l});var r=10,o={name:"materialFile",data:{},accept:".xlsx,.xls",action:t,beforeUpload:function(t){e.setState({loading:!0});var a=t.type;if(t.size>1048576*r)return i.message.error("文件大小不能超过"+r+"M"),e.setState({loading:!1}),!1;var l=t.name,n=l.split("."),s=n.length,o=n[s-1],u="xlsx"===o||"xls"===o||"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"===a||"application/vnd.ms-excel"===a;return u||(i.message.error("请上传Excel文件"),e.setState({loading:!1})),u},headers:{authorization:"authorization-text"},onChange:function(t){if("removed"===t.file.status)return e.setState({loading:!1}),void(t.fileList.length<1&&e.props.form.setFieldsValue({filePath:void 0}));if("error"===t.file.status&&e.setState({loading:!1}),"done"===t.file.status)if(e.setState({loading:!1}),200==t.file.response.code){var a=t.file.response.value;t.fileList.length>1&&t.fileList.shift(),i.message.success(t.file.name+" 上传成功。"),e.props.form.setFieldsValue({filePath:a}),e.setState({blackNum:a.blackNum,appName:a.appName})}else t.fileList.pop(),i.message.error(t.file.response.message)}};return s.default.createElement(i.Form,{className:"add_black"},s.default.createElement("div",{className:"sub_toolbar config_toolbar"},s.default.createElement(i.Row,null,s.default.createElement(i.Col,{span:"14"},s.default.createElement("div",{className:"title"},s.default.createElement("span",{className:"border"}),"上传资源")))),s.default.createElement(i.Row,{className:"mt10"},s.default.createElement(i.Col,{span:"8"},s.default.createElement(f,n({},h,{label:"备注"}),s.default.createElement(i.Input,n({},a("title",{validate:[{rules:[{required:!0,message:"请填写备注"},{max:150,message:"备注不能超过150个字"}],trigger:["onBlur","onChange"]}]}),{placeholder:"备注"}))),s.default.createElement(f,n({className:"mt10"},h,{label:" "}),s.default.createElement(i.Upload,n({},a("filePath",{validate:[{rules:[{required:!0,message:"请上传文件"}],trigger:["onBlur","onChange"]}]}),{style:{width:200}},o),s.default.createElement(i.Button,{disabled:!!this.state.loading,size:"large",className:"btn_normal_show ",type:"ghost"},"Excel文档批量导入",this.state.loading?s.default.createElement(i.Icon,{type:"loading"}):s.default.createElement("span",null))),s.default.createElement("span",{className:"upload_tips"},s.default.createElement("a",{download:!0,href:p.default.materialDownload+"?appId="+l},"下载模板"))),s.default.createElement(f,n({className:"mt10"},h,{label:" "}),s.default.createElement(i.Button,{size:"large",onClick:this.add,type:"primary"},"新增")))))}});g=i.Form.create()(g),e.exports=g}});