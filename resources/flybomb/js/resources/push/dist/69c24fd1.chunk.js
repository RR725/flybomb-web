webpackJsonp([11],{921:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},r=a(600),s=l(r),i=a(783),u=a(777),d=l(u),o=a(922),c=l(o),p=i.Form.Item,m=i.Radio.Button,f=i.Radio.Group,h=s.default.createClass({displayName:"PushTime",getInitialState:function(){var e=this.props.router,t=864e5,a=new Date,l="userdata"===e?new Date(+new Date-6*t):a,n=d.default.dateFormat("yyyy-MM-dd",l),r=d.default.dateParse(n+" 00:00:00");return{startTimeStatus:"success",endTimeStatus:"success",startTime:r,endTime:a,display:"none",errorTips:"",pushTimeType:0}},changeRadio:function(e){var t=e.target.value,a=+new Date,l=864e5,n={pushTimeType:t};if(1===t?n.endTime=new Date(a-Number(t)*l):n.endTime=new Date,"number"==typeof t){n.startTime=new Date(a-Number(t)*l);var r=d.default.dateFormat("yyyy-MM-dd",n.startTime);1!==t&&0!==t||(n.startTime=d.default.dateParse(r+" 00:00:00")),1===t&&(n.endTime=d.default.dateParse(r+" 23:59:59")),n.display="none",n.startTimeStatus="success",n.endTimeStatus="success",n.errorTips=""}else n.startTime=new Date;this.setState(n),this.props.form.setFieldsValue(n)},componentDidMount:function(){"userdata"===this.props.router&&this.setState({pushTimeType:6})},onOpen:function(){this.setState({pushTimeType:"other"})},changeStartTime:function(e){var t=this.props.router,a=this.props.required,l={router:t,required:a},n=this.props.form.getFieldValue("endTime"),r=c.default.changeStartTime(e,n,l);this.setState(r)},changeEndTime:function(e){var t=this.props.required,a={required:t},l=this.props.form.getFieldValue("startTime"),n=c.default.changeEndTime(e,l,a);this.setState(n)},render:function(){var e="",t=this.props.type,a=this.props.router;"second"===t&&(e=" H:mm:ss");var l=this.props.form.getFieldProps;return s.default.createElement(p,{className:"radio_btn",labelCol:{span:2},wrapperCol:{span:22},label:"时间    "},"personal"===a?null:s.default.createElement(f,{onChange:this.changeRadio,value:this.state.pushTimeType,size:"large",style:{marginRight:10}},"userdata"===a?null:s.default.createElement(m,{value:0},"今天"),"userdata"===a?null:s.default.createElement(m,{value:1},"昨天"),"analyze"===a?null:s.default.createElement(m,{value:6},"最近7天"),"analyze"===a?null:s.default.createElement(m,{value:30},"最近30天"),s.default.createElement(m,{value:"other"},"选择日期")),s.default.createElement(p,{validateStatus:this.state.startTimeStatus,className:"display_ib va_t mg0"},s.default.createElement(i.DatePicker,n({},l("startTime",{initialValue:this.state.startTime,onChange:this.changeStartTime}),{toggleOpen:this.onOpen,showTime:!0,format:"yyyy-MM-dd"+e}))),"analyze"===a?null:s.default.createElement("span",{className:"pl10 pr10"},"至"),"analyze"===a?null:s.default.createElement(p,{validateStatus:this.state.endTimeStatus,className:"display_ib va_t mg0"},s.default.createElement(i.DatePicker,n({},l("endTime",{initialValue:this.state.endTime,onChange:this.changeEndTime}),{toggleOpen:this.onOpen,showTime:!0,format:"yyyy-MM-dd"+e}))),s.default.createElement("span",{style:{display:this.state.display},className:"color_error pl10"},this.state.errorTips))}});e.exports=h},1331:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=a(600),r=l(n),s=a(1332),i=l(s),u=a(776),d=l(u),o=a(777),c=l(o),p=a(785),m=l(p),f=r.default.createClass({displayName:"App",getInitialState:function(){return{current:1,appId:c.default.queryString("appId",window.location.href),tableData:{loading:!0,data:[],pagination:null}}},componentWillReceiveProps:function(){var e=c.default.queryString("appId",window.location.href);this.setState({appId:e})},tableData:function(e){var t=this;this.setState({tableData:{loading:!0,data:[]},current:e.index});var a=d.default.taskGroupList,l=c.default.queryString("appId",window.location.href);l&&"0"!==l?e.appId=l:delete e.appId,a=c.default.makeUrl(a,e),m.default.get(a,function(a){var l=a.value.result;l.map(function(e,t){l[t].key=t}),t.setState({tableData:{data:l,loading:!1,pagination:{total:a.value.amount,current:e.index,pageSize:10,showSizeChanger:!1,onChange:function(a){e.index=a,t.setState({current:a,searchData:e}),t.tableData(e)}}}})},function(){t.setState({tableData:{loading:!1}})})},componentWillUnmount:function(){document.querySelector("#dataStat")&&(document.querySelector("#dataStat").className="")},componentDidMount:function(){document.querySelector("#dataStat")&&(document.querySelector("#dataStat").className="active")},render:function(){return r.default.createElement("div",null,r.default.createElement(i.default,{searchData:this.state.searchData,refresh:this.state.refresh,tableData:this.state.tableData,current:this.state.current,appId:this.state.appId,onSearch:this.tableData}))}});e.exports=f},1332:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var l in a)Object.prototype.hasOwnProperty.call(a,l)&&(e[l]=a[l])}return e},r=a(600),s=l(r),i=a(783),u=a(777),d=l(u),o=a(1333),c=l(o),p=a(921),m=l(p),f=i.Form.Item,h=i.Select.Option,y={labelCol:{span:8},wrapperCol:{span:16}},g=s.default.createClass({displayName:"AddAppTask",getInitialState:function(){return{buttonGroupType:"ghost",initData:{},values:[],data:null,noticeBarType:"0",noticeExpandType:"0",pushTimeType:0,errors:{},defaultAppid:"应用"}},handleSubmit:function(e){var t=this;e.preventDefault(),this.props.form.validateFields(function(e,a){if(e)return void console.log("Errors in form!!!");var l=a.startTime,n=a.endTime;if(!(+new Date(l)>+new Date(n))){a.index=1,a.startTime="string"==typeof a.startTime?a.startTime:d.default.dateFormat("yyyy-MM-dd hh:mm:ss",a.startTime),a.endTime="string"==typeof a.endTime?a.endTime:d.default.dateFormat("yyyy-MM-dd hh:mm:ss",a.endTime);var r={};for(var s in a)""!==a[s]&&(r[s]=a[s]);t.setState({searchData:a}),t.props.onSearch(r)}})},componentDidMount:function(){var e=new Date,t=d.default.queryString("appId",window.location.href),a={appId:t,index:1,startTime:d.default.dateFormat("yyyy-MM-dd",e)+" 00:00:00",endTime:d.default.dateFormat("yyyy-MM-dd hh:mm:ss",e)};this.setState({searchData:a}),this.props.onSearch(a)},cantNull:function(e,t){var a=this.props.form.getFieldProps;return a(e,{initialValue:t})},render:function(){var e=this.state.searchData||this.props.searchData;return s.default.createElement("div",null,s.default.createElement(i.Form,{horizontal:!0},s.default.createElement(i.Row,null,s.default.createElement(i.Col,{span:"24"},s.default.createElement(m.default,{type:"second",form:this.props.form}))),s.default.createElement(i.Row,null,s.default.createElement(i.Col,{span:"6"},s.default.createElement(f,n({},y,{label:"推送类型    "}),s.default.createElement(i.Select,n({},this.cantNull("pushType",""),{size:"large"}),s.default.createElement(h,{value:""},"全部"),s.default.createElement(h,{value:"0"},"通知"),s.default.createElement(h,{value:"1"},"透传消息")))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(f,n({},y,{label:"目标类型    "}),s.default.createElement(i.Select,n({},this.cantNull("groupType",""),{size:"large"}),s.default.createElement(h,{value:""},"全部"),s.default.createElement(h,{value:"0"},"相同用户群"),s.default.createElement(h,{value:"1"},"不同用户群")))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(f,n({},y,{label:"状态    "}),s.default.createElement(i.Select,n({},this.cantNull("pushStatus",""),{size:"large"}),s.default.createElement(h,{value:""},"全部"),s.default.createElement(h,{value:"0"},"待推送"),s.default.createElement(h,{value:"1"},"推送中"),s.default.createElement(h,{value:"2"},"已完成"),s.default.createElement(h,{value:"4"},"取消"))))),s.default.createElement(i.Row,null,s.default.createElement(i.Col,{span:"6"},s.default.createElement(f,n({},y,{label:"分组ID    "}),s.default.createElement(i.Input,n({placeholder:"输入分组ID"},this.cantNull("taskGroupId",""))))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(f,n({},y,{label:"标题名称    "}),s.default.createElement(i.Input,n({placeholder:"输入分组标题关键字"},this.cantNull("groupName",""))))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(f,n({},y,{label:""}),s.default.createElement(i.Button,{className:"ml10",type:"primary",onClick:this.handleSubmit,size:"large"},"查询"))))),s.default.createElement(c.default,{searchData:e,current:this.props.current,onSearch:this.props.onSearch,refresh:this.props.refresh,tableData:this.props.tableData}))}});g=i.Form.create()(g),e.exports=g},1333:function(e,t,a){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}function n(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var r=a(600),s=l(r),i=a(783),u=a(776),d=l(u),o=a(777),c=l(o),p=a(785),m=l(p),f=s.default.createClass({displayName:"App",getInitialState:function(){var e=this;return{columns:[{title:"推送时间",key:"0",className:"ta_c",dataIndex:"startTime"},{title:"应用名称",key:"1",dataIndex:"appName",className:"td_appname",render:function(e,t){return s.default.createElement("div",null,s.default.createElement("img",{src:t.appIconUrl||c.default.cdn+"/resources/push/images/default_icon.png",width:"24",height:"24"}),e)}},{title:"分组ID",key:"2",className:"ta_c",dataIndex:"groupId"},{title:"类型",key:"3",className:"ta_c",dataIndex:"pushType"},{title:"分组标题",key:"4",className:"td_appname w_240",dataIndex:"groupName"},{title:"目标类型",key:"5",className:"ta_c",dataIndex:"groupType"},{title:"状态",key:"6",className:"ta_c",dataIndex:"pushStatus"},{title:"操作",className:"ta_l",key:"7",render:function(t,a,l){var n=a.appId,r="#/data/push/detail/group?appId="+n+"&groupId="+a.groupId;return"0"===n&&(n=window.ListApp[0].appId),s.default.createElement("div",{className:"btn_wrap"},s.default.createElement(i.Tooltip,{title:"推送详情"},s.default.createElement("a",{target:"_blank",href:window.location.pathname+r},s.default.createElement("i",{className:"i_detail"}))),s.default.createElement(i.Popover,{placement:"bottom",visible:e.state["visible"+l],content:e.getContent("visible"+l,a,l),title:"确定取消推送?",onVisibleChange:e.togglePopover.bind(e,"visible"+l),trigger:"click"},s.default.createElement("span",null,"待推送"===a.pushStatus||"推送中"===a.pushStatus?s.default.createElement(i.Tooltip,{title:"取消推送"},s.default.createElement("a",{href:"javascript:;"},s.default.createElement("i",{className:"i_cancel_push"}))):null)))},dataIndex:""}],refresh:!1}},getContent:function(e,t,a){return s.default.createElement("div",null,s.default.createElement(i.Button,{type:"primary",className:"color_bg mr10",onClick:this.togglePopover.bind(this,e)},"取消"),s.default.createElement(i.Button,{onClick:this.cancelPushTask.bind(this,e,t,a)},"确定"))},togglePopover:function(e){this.setState(n({},e,!this.state[e]))},cancelPushTask:function(e,t){var a=this,l=d.default.CancelTaskGroup;l=c.default.makeUrl(l,{groupId:t.groupId,appId:t.appId}),m.default.get(l,function(){i.message.success("推送任务已取消");var t=a.props.searchData;if(!t){var l=new Date;t={startTime:c.default.dateFormat("yyyy-MM-dd",l)+" 00:00:00",endTime:c.default.dateFormat("yyyy-MM-dd hh:mm:ss",l),index:a.props.current}}for(var r in t)""===t[r]&&delete t[r];a.props.onSearch(t),a.setState(n({},e,!a.state[e]))})},render:function(){var e=this.props.tableData.data;return s.default.createElement(i.Table,{columns:this.state.columns,loading:this.props.tableData.loading,dataSource:e,pagination:this.props.tableData.pagination})}});e.exports=f}});