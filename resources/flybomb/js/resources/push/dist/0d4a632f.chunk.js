webpackJsonp([23],{1377:function(e,a,t){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var r=t(600),n=l(r),s=t(1378),i=l(s),o=t(1380),c=l(o),d=t(776),u=l(d),f=t(777),p=l(f),m=t(785),b=l(m),h=n.default.createClass({displayName:"App",getInitialState:function(){return{current:1,tableData:{loading:!0,data:[],pagination:null}}},setTableDataDisable:function(e){var a=this.state.tableData.data;a.map(function(a,t){var l=a.disable;t===e&&(a.disable=!l)}),this.setState({tableData:{data:a}})},tableData:function(e){var a=this,t=p.default.queryString("appId",window.location.href);this.setState({tableData:{loading:!0}});var l=u.default.blackList;l=p.default.makeUrl(l,e),b.default.get(l,function(l){var r=l.value.result;r.map(function(e,a){r[a].key=a}),a.setState({tableData:{data:r,loading:!1,pagination:{total:l.value.amount,current:a.state.current,pageSize:10,showSizeChanger:!1,onChange:function(l){var r={appId:t,index:l};e.blackName&&(r.blackName=e.blackName),a.setState({current:l}),a.tableData(r)}}}})})},componentWillUnmount:function(){document.querySelector("#configManage")&&(document.querySelector("#configManage").className="")},componentDidMount:function(){document.querySelector("#configManage")&&(document.querySelector("#configManage").className="active");var e=p.default.queryString("appId",window.location.href);this.setState({appId:e})},render:function(){return n.default.createElement("div",null,n.default.createElement(c.default,{tableData:this.state.tableData,getTableData:this.tableData}),n.default.createElement(i.default,{setTableDataDisable:this.setTableDataDisable,current:this.state.current,refresh:this.state.refresh,tableData:this.state.tableData,getTableData:this.tableData}))}});e.exports=h},1378:function(e,a,t){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var r=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},n=t(600),s=l(n),i=t(783),o=t(1379),c=l(o),d=t(777),u=l(d),f=i.Form.Item,p={labelCol:{span:6},wrapperCol:{span:18}},m=s.default.createClass({displayName:"BlackToolbar",getInitialState:function(){return{data:null,value:"",searchStatus:!1}},onSearch:function(){var e=u.default.queryString("appId",window.location.href),a=this.props.form.getFieldValue("blackNameSearch"),t={appId:e,index:1};a&&(t.blackName=a),this.props.getTableData(t)},render:function(){var e=this.props.form.getFieldProps;return s.default.createElement(i.Form,null,s.default.createElement("div",{className:"sub_toolbar config_toolbar"},s.default.createElement(i.Row,null,s.default.createElement(i.Col,{span:"4"},s.default.createElement("div",{className:"title"},s.default.createElement("span",{className:"border"}),"黑名单列表")))),s.default.createElement(i.Row,{className:"mt10"},s.default.createElement(i.Col,{span:"8"},s.default.createElement(f,r({},p,{label:"黑名单名称"}),s.default.createElement(i.Input,e("blackNameSearch")))),s.default.createElement(i.Col,{span:"6"},s.default.createElement(i.Button,{className:"ml10",type:"primary",onClick:this.onSearch,size:"large"},"查询"))),s.default.createElement(c.default,{setTableDataDisable:this.props.setTableDataDisable,blackName:this.props.form.getFieldValue("blackNameSearch"),current:this.props.current,tagName:this.state.tagName,getTableData:this.props.getTableData,refresh:this.props.refresh,tableData:this.props.tableData}))}});m=i.Form.create()(m),e.exports=m},1379:function(e,a,t){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}function r(e,a,t){return a in e?Object.defineProperty(e,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[a]=t,e}var n=t(600),s=l(n),i=t(783),o=t(776),c=l(o),d=t(777),u=l(d),f=t(785),p=l(f),m=s.default.createClass({displayName:"App",getInitialState:function(){return{refresh:!1,status:0}},createFile:function(e){var a=this,t=u.default.queryString("appId",window.location.href),l={appId:t,tagId:e};p.default.post(c.default.createTagUserFile,l,function(){var t;a.setState((t={},r(t,"status"+e,1),r(t,"refresh",!1),t))})},componentDidMount:function(){var e=u.default.queryString("appId",window.location.href),a={appId:e,index:this.props.current};this.props.getTableData(a)},handleVisibleChange:function(e){this.setState(r({},"visible"+e,!this.state["visible"+e]))},refresh:function(e){var a,t=u.default.queryString("appId",window.location.href),l={appId:t,index:this.props.current},n=this.props.tagName;n&&(l.tagName=n),this.setState((a={},r(a,"status"+e,null),r(a,"refresh",!0),a)),this.props.getTableData(l)},getContent:function(e){var a=this;return s.default.createElement("div",null,s.default.createElement(i.Button,{type:"primary",className:"color_bg mr10",onClick:function(){return a.togglePopover(e)}},"取消"),s.default.createElement(i.Button,{onClick:function(){return a.delOk(e)}},"确定"))},delOk:function(e){var a=c.default.blackDelete,t=u.default.queryString("appId",window.location.href),l=this;p.default.post(a,{blackId:e.id,appId:t},function(){i.message.success("黑名单删除成功"),l.togglePopover(e),l.refreshTable()})},refreshTable:function(){var e=this.props.blackName,a=u.default.queryString("appId",window.location.href),t={index:this.props.current,appId:a};e&&(t.blackName=e),this.props.getTableData(t)},disabled:function(e,a){var t=u.default.queryString("appId",window.location.href),l=c.default.blackDisable,r=this,n={appId:t,disable:!e.disable,blackId:e.id};p.default.post(l,n,function(){var t=e.disable?"启用成功":"禁用成功";i.message.success(t),r.props.setTableDataDisable(a)})},togglePopover:function(e){var a=e.id;this.setState(r({},"visibleDel"+a,!this.state["visibleDel"+a]))},render:function(){var e=u.default.queryString("appId",window.location.href),a=this,t=[{title:"应用名称",key:"0",dataIndex:"appName",className:"ta_l",render:function(e,a){var t=a.disable?"colord9":"";return s.default.createElement("span",{className:t},e)}},{title:"包名",className:"ta_l",key:"1",dataIndex:"packageName",render:function(e,a){var t=a.disable?"colord9":"";return s.default.createElement("span",{className:t},e)}},{title:"黑名单名称",className:"ta_l",key:"2",dataIndex:"blackName",render:function(e,a){var t=a.disable?"colord9":"";return s.default.createElement("span",{className:t},e)}},{title:"数量",className:"ta_r",key:"3",dataIndex:"blackNum",render:function(e,a){var t=a.disable?"colord9":"";return s.default.createElement("span",{className:t},e)}},{title:"操作",className:"ta_c",key:"4",render:function(t,l,r){var n="/garcia/webjsp/push/black/download?appId="+e+"&blackId="+l.id;return s.default.createElement("div",null,s.default.createElement("a",{href:n},"下载"),l.disable?s.default.createElement("a",{className:"pl10",href:"javascript:;",onClick:function(){return a.disabled(l,r)}},"启用"):s.default.createElement("a",{className:"pl10",href:"javascript:;",onClick:function(){return a.disabled(l,r)}},"禁用"),s.default.createElement(i.Popover,{placement:"bottom",visible:a.state["visibleDel"+l.id],content:a.getContent(l),title:"确定删除黑名单?",onVisibleChange:function(){return a.togglePopover(l)},trigger:"click"},s.default.createElement("a",{className:"pl10",href:"javascript:;"},"删除")))},dataIndex:""}];return s.default.createElement(i.Table,{className:"home_table",columns:t,loading:this.props.tableData.loading,dataSource:this.props.tableData.data,pagination:this.props.tableData.pagination})}});e.exports=m},1380:function(e,a,t){"use strict";function l(e){return e&&e.__esModule?e:{default:e}}var r=Object.assign||function(e){for(var a=1;a<arguments.length;a++){var t=arguments[a];for(var l in t)Object.prototype.hasOwnProperty.call(t,l)&&(e[l]=t[l])}return e},n=t(600),s=l(n),i=t(783),o=t(777),c=l(o),d=t(785),u=l(d),f=t(776),p=l(f),m=i.Form.Item,b={labelCol:{span:6},wrapperCol:{span:18}},h=s.default.createClass({displayName:"AddBlack",getInitialState:function(){return{data:null,value:"",searchStatus:!1}},handleCancel:function(){this.setState({visible:!1})},handleOk:function(){var e=this,a=c.default.queryString("appId",window.location.href);this.props.form.validateFields(function(t,l){if(t)return console.log(t),void console.log("Errors in form!!!");var r=p.default.blackAdd;r=c.default.makeUrl(r,{blackName:l.blackName,blackFilePath:l.blackFilePath,appId:a||0}),u.default.get(r,function(){i.message.success("保存成功"),e.handleCancel();var t={appId:a,index:1};e.props.getTableData(t)})})},render:function(){var e=this,a=p.default.blackUpload,t=this.props.form.getFieldProps,l=c.default.queryString("appId",window.location.href);a=c.default.makeUrl(a,{appId:l});var n=10,o={name:"blackFile",data:{},accept:".txt",action:a,beforeUpload:function(a){e.setState({loading:!0});var t=a.type;if(a.size>1048576*n)return i.message.error("文件大小不能超过"+n+"M"),e.setState({loading:!1}),!1;if(e.props.tableData.data.length>4)return i.message.error("每个业务限定设置5条黑名单"),e.setState({loading:!1}),!1;var l="text/plain"===t;return l||(i.message.error("请上传txt格式的文件"),e.setState({loading:!1})),l},headers:{authorization:"authorization-text"},onChange:function(a){if("removed"===a.file.status)return e.setState({loading:!1}),void(a.fileList.length<1&&e.props.form.setFieldsValue({blackFilePath:void 0}));if("error"===a.file.status&&e.setState({loading:!1}),"done"===a.file.status)if(e.setState({loading:!1}),200==a.file.response.code){var t=a.file.response.value;a.fileList.length>1&&a.fileList.shift(),i.message.success(a.file.name+" 上传成功。"),e.props.form.setFieldsValue({blackFilePath:t.blackFilePath}),e.setState({visible:!0,blackNum:t.blackNum,appName:t.appName})}else a.fileList.pop(),i.message.error(a.file.response.message),e.setState({visible:!1})}};return s.default.createElement(i.Form,{className:"add_black"},s.default.createElement("div",{className:"sub_toolbar config_toolbar"},s.default.createElement(i.Row,null,s.default.createElement(i.Col,{span:"14"},s.default.createElement("div",{className:"title"},s.default.createElement("span",{className:"border"}),"新建黑名单",s.default.createElement("span",{className:"fs12 pl10 color999"},"每个业务限定设置5条黑名单"))))),s.default.createElement(i.Row,{className:"mt10"},s.default.createElement(i.Col,{span:"8"},s.default.createElement(m,r({},b,{label:" "}),s.default.createElement(i.Upload,r({},t("blackFilePath"),{style:{width:200}},o),s.default.createElement(i.Button,{disabled:!!this.state.loading,size:"large",className:"btn_normal_show ",type:"ghost"},"TXT文档批量导入",this.state.loading?s.default.createElement(i.Icon,{type:"loading"}):s.default.createElement("span",null))),s.default.createElement("span",{className:"upload_tips"},"最多不超过10M，UTF-8无BOM格式编码文件，内容以回车键进行分割")))),this.state.visible&&s.default.createElement(i.Modal,{width:1e3,onCancel:this.handleCancel,onOk:this.handleOk,okText:"保存",cancelText:"取消",title:"添加黑名单",visible:!0},s.default.createElement(m,r({},b,{label:"黑名单名称"}),s.default.createElement(i.Input,r({style:{width:200}},t("blackName",{validate:[{rules:[{required:!0,message:"请输入黑名单名称"},{max:30,message:"黑名单不能超过30个字"}],trigger:["onBlur","onChange"]}]})))),s.default.createElement(m,r({},b,{label:"应用名称"}),s.default.createElement("div",{style:{padding:"3px 0"}},this.state.appName)),s.default.createElement(m,r({},b,{label:"设备数"}),s.default.createElement("div",{style:{padding:"3px 0"}},this.state.blackNum))))}});h=i.Form.create()(h),e.exports=h}});